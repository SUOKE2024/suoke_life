# 索克生活认证服务 - 代码质量分析报告
============================================================

## 📊 总体统计
- 总文件数: 153
- 总代码行数: 40,314
- 发现问题总数: 3351
- 有问题的文件数: 115

## 🔍 问题类型分布
- type: 932 个问题
- complexity: 104 个问题
- security: 2145 个问题
- import: 170 个问题

## ⚠️ 严重程度分布
- 🔴 error: 932 个问题
- 🟡 warning: 2250 个问题
- 🔵 info: 169 个问题

## 📋 详细问题列表

### 📄 api/rest/auth.py
- 🟡 第1行: [file_length] 文件过长 (814 行)，建议拆分
- 🔵 第1行: [unused_import] 可能未使用的导入: List
- 🔵 第1行: [unused_import] 可能未使用的导入: Union
- 🔵 第3行: [unused_import] 可能未使用的导入: Response
- 🟡 第4行: [security_check] 密码相关代码需要特别注意
- 🔵 第4行: [unused_import] 可能未使用的导入: OAuth2PasswordRequestForm
- 🔵 第7行: [unused_import] 可能未使用的导入: datetime
- 🔵 第7行: [unused_import] 可能未使用的导入: timedelta
- 🟡 第22行: [security_check] 密码相关代码需要特别注意
- 🟡 第22行: [security_check] 令牌相关代码需要特别注意
- 🟡 第30行: [security_check] 密码相关代码需要特别注意
- 🟡 第31行: [security_check] 密码相关代码需要特别注意
- 🔴 第35行: [mypy] error
- 🟡 第37行: [security_check] 密码相关代码需要特别注意
- 🔴 第43行: [mypy] error
- 🟡 第54行: [security_check] 密码相关代码需要特别注意
- 🟡 第59行: [security_check] 密码相关代码需要特别注意
- 🔴 第60行: [mypy] error
- 🟡 第60行: [security_check] 密码相关代码需要特别注意
- 🟡 第66行: [security_check] 令牌相关代码需要特别注意
- 🟡 第68行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第74行: [security_check] 密码相关代码需要特别注意
- 🟡 第79行: [security_check] 密码相关代码需要特别注意
- 🔴 第82行: [mypy] error
- 🟡 第92行: [security_check] 密码相关代码需要特别注意
- 🔴 第95行: [mypy] error
- 🔴 第106行: [mypy] error
- 🟡 第117行: [security_check] 令牌相关代码需要特别注意
- 🟡 第128行: [security_check] 密钥相关代码需要特别注意
- 🟡 第133行: [security_check] 密钥相关代码需要特别注意
- 🟡 第136行: [security_check] 密钥相关代码需要特别注意
- 🔴 第138行: [mypy] error
- 🟡 第148行: [security_check] 令牌相关代码需要特别注意
- 🟡 第149行: [security_check] 令牌相关代码需要特别注意
- 🟡 第150行: [security_check] 密码相关代码需要特别注意
- 🟡 第173行: [security_check] 密码相关代码需要特别注意
- 🟡 第200行: [function_length] 函数 async login 过长 (51 行)
- 🟡 第212行: [security_check] 密码相关代码需要特别注意
- 🟡 第233行: [security_check] 令牌相关代码需要特别注意
- 🟡 第234行: [security_check] 令牌相关代码需要特别注意
- 🟡 第235行: [security_check] 令牌相关代码需要特别注意
- 🟡 第238行: [security_check] 令牌相关代码需要特别注意
- 🟡 第262行: [security_check] 令牌相关代码需要特别注意
- 🟡 第263行: [security_check] 令牌相关代码需要特别注意
- 🟡 第271行: [security_check] 令牌相关代码需要特别注意
- 🟡 第288行: [security_check] 令牌相关代码需要特别注意
- 🟡 第299行: [security_check] 令牌相关代码需要特别注意
- 🟡 第300行: [security_check] 令牌相关代码需要特别注意
- 🟡 第308行: [security_check] 令牌相关代码需要特别注意
- 🟡 第309行: [security_check] 令牌相关代码需要特别注意
- 🟡 第310行: [security_check] 令牌相关代码需要特别注意
- 🟡 第323行: [security_check] 令牌相关代码需要特别注意
- 🟡 第334行: [security_check] 令牌相关代码需要特别注意
- 🟡 第335行: [security_check] 令牌相关代码需要特别注意
- 🟡 第358行: [security_check] 密码相关代码需要特别注意
- 🟡 第369行: [security_check] 密码相关代码需要特别注意
- 🟡 第371行: [security_check] 密码相关代码需要特别注意
- 🟡 第381行: [security_check] 密码相关代码需要特别注意
- 🟡 第428行: [security_check] 令牌相关代码需要特别注意
- 🟡 第429行: [security_check] 令牌相关代码需要特别注意
- 🟡 第435行: [security_check] 令牌相关代码需要特别注意
- 🟡 第448行: [security_check] 密钥相关代码需要特别注意
- 🟡 第475行: [security_check] 令牌相关代码需要特别注意
- 🟡 第483行: [security_check] 令牌相关代码需要特别注意
- 🟡 第484行: [security_check] 令牌相关代码需要特别注意
- 🟡 第485行: [security_check] 令牌相关代码需要特别注意
- 🟡 第498行: [function_length] 函数 async get_user_roles 过长 (53 行)
- 🟡 第509行: [security_check] 令牌相关代码需要特别注意
- 🟡 第510行: [security_check] 令牌相关代码需要特别注意
- 🟡 第516行: [security_check] 令牌相关代码需要特别注意
- 🟡 第563行: [security_check] 令牌相关代码需要特别注意
- 🟡 第564行: [security_check] 令牌相关代码需要特别注意
- 🟡 第570行: [security_check] 令牌相关代码需要特别注意
- 🟡 第597行: [security_check] 令牌相关代码需要特别注意
- 🟡 第616行: [security_check] 令牌相关代码需要特别注意
- 🟡 第620行: [security_check] 令牌相关代码需要特别注意
- 🟡 第625行: [security_check] 令牌相关代码需要特别注意
- 🔴 第629行: [mypy] error
- 🟡 第630行: [security_check] 令牌相关代码需要特别注意
- 🟡 第631行: [security_check] 密钥相关代码需要特别注意
- 🔴 第638行: [mypy] error
- 🟡 第652行: [security_check] 令牌相关代码需要特别注意
- 🟡 第653行: [security_check] 令牌相关代码需要特别注意
- 🟡 第654行: [security_check] 密钥相关代码需要特别注意
- 🟡 第661行: [security_check] 令牌相关代码需要特别注意
- 🟡 第662行: [security_check] 令牌相关代码需要特别注意
- 🟡 第687行: [security_check] 密码相关代码需要特别注意
- 🔴 第693行: [mypy] error
- 🟡 第693行: [security_check] 密码相关代码需要特别注意
- 🔴 第709行: [mypy] error
- 🟡 第752行: [security_check] 密钥相关代码需要特别注意
- 🟡 第753行: [security_check] 密钥相关代码需要特别注意
- 🟡 第771行: [security_check] 令牌相关代码需要特别注意
- 🟡 第773行: [security_check] 令牌相关代码需要特别注意
- 🟡 第781行: [security_check] 令牌相关代码需要特别注意
- 🟡 第782行: [security_check] 令牌相关代码需要特别注意

### 📄 app/server/main.py
- 🔴 第42行: [mypy] error
- 🔴 第51行: [mypy] error
- 🔴 第109行: [mypy] error
- 🔴 第109行: [mypy] error
- 🔴 第144行: [mypy] error
- 🔴 第163行: [mypy] error
- 🔴 第179行: [mypy] error

### 📄 internal/api/docs.py
- 🟡 第1行: [file_length] 文件过长 (613 行)，建议拆分
- 🔵 第6行: [unused_import] 可能未使用的导入: List
- 🟡 第31行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第190行: [security_check] 令牌相关代码需要特别注意
- 🟡 第191行: [security_check] 令牌相关代码需要特别注意
- 🟡 第245行: [security_check] 令牌相关代码需要特别注意
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第267行: [security_check] 令牌相关代码需要特别注意
- 🟡 第410行: [security_check] 密钥相关代码需要特别注意
- 🟡 第504行: [function_length] 函数 customize_openapi 过长 (58 行)
- 🔴 第510行: [mypy] error
- 🔴 第511行: [mypy] error
- 🔴 第512行: [mypy] error
- 🔴 第514行: [mypy] error
- 🟡 第566行: [security_check] 密码相关代码需要特别注意
- 🟡 第571行: [security_check] 密码相关代码需要特别注意
- 🟡 第588行: [security_check] 密码相关代码需要特别注意
- 🟡 第589行: [security_check] 密码相关代码需要特别注意
- 🟡 第590行: [security_check] 密码相关代码需要特别注意
- 🟡 第603行: [security_check] 令牌相关代码需要特别注意
- 🟡 第604行: [security_check] 令牌相关代码需要特别注意
- 🟡 第609行: [security_check] 密码相关代码需要特别注意

### 📄 internal/api/monitoring.py
- 🟡 第1行: [file_length] 文件过长 (593 行)，建议拆分
- 🔵 第6行: [unused_import] 可能未使用的导入: Depends
- 🟡 第27行: [function_length] 函数 async health_check 过长 (62 行)
- 🟡 第254行: [function_length] 函数 async performance_summary 过长 (61 行)
- 🔴 第305行: [mypy] error
- 🔴 第442行: [mypy] error
- 🟡 第461行: [function_length] 函数 async get_comprehensive_status 过长 (83 行)

### 📄 internal/async_tasks/task_manager.py
- 🟡 第1行: [file_length] 文件过长 (570 行)，建议拆分
- 🔵 第10行: [unused_import] 可能未使用的导入: Union
- 🔴 第96行: [mypy] error
- 🔴 第108行: [mypy] error
- 🔴 第132行: [mypy] error
- 🔴 第159行: [mypy] error
- 🟡 第159行: [function_length] 函数 async _execute_task 过长 (79 行)
- 🔴 第268行: [mypy] error
- 🔴 第282行: [mypy] error
- 🔴 第306行: [mypy] error
- 🔴 第375行: [mypy] error
- 🔴 第401行: [mypy] error
- 🔴 第468行: [mypy] error
- 🔴 第490行: [mypy] error
- 🔴 第509行: [mypy] error
- 🟡 第523行: [security_check] 令牌相关代码需要特别注意
- 🔴 第527行: [mypy] error

### 📄 internal/cache/__init__.py
- 🔵 第5行: [unused_import] 可能未使用的导入: (

### 📄 internal/cache/cache_manager.py
- 🔵 第10行: [unused_import] 可能未使用的导入: Union
- 🔵 第10行: [unused_import] 可能未使用的导入: Callable
- 🔴 第137行: [mypy] error
- 🔴 第152行: [mypy] error
- 🔴 第186行: [mypy] error
- 🔴 第246行: [mypy] error
- 🟡 第321行: [security_check] 使用pickle.loads可能存在反序列化风险
- 🔴 第325行: [mypy] error
- 🔴 第329行: [mypy] error
- 🔴 第354行: [mypy] error
- 🔴 第357行: [mypy] error
- 🔴 第358行: [mypy] error
- 🔴 第361行: [mypy] error
- 🔴 第363行: [mypy] error

### 📄 internal/cache/redis_cache.py
- 🟡 第1行: [file_length] 文件过长 (510 行)，建议拆分
- 🔵 第10行: [unused_import] 可能未使用的导入: Union
- 🔵 第11行: [unused_import] 可能未使用的导入: datetime
- 🔵 第11行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第13行: [unused_import] 可能未使用的导入: asynccontextmanager
- 🔴 第43行: [mypy] error
- 🟡 第58行: [security_check] 密码相关代码需要特别注意
- 🟡 第71行: [security_check] 密码相关代码需要特别注意
- 🟡 第100行: [security_check] 密码相关代码需要特别注意
- 🔴 第137行: [mypy] error
- 🟡 第157行: [security_check] 使用pickle.loads可能存在反序列化风险
- 🔴 第189行: [mypy] error
- 🔴 第191行: [mypy] error
- 🔴 第209行: [mypy] error
- 🔴 第213行: [mypy] error
- 🔴 第226行: [mypy] error
- 🔴 第228行: [mypy] error
- 🔴 第241行: [mypy] error
- 🔴 第243行: [mypy] error
- 🔴 第256行: [mypy] error
- 🔴 第258行: [mypy] error
- 🔴 第271行: [mypy] error
- 🔴 第273行: [mypy] error
- 🔴 第277行: [mypy] error
- 🔴 第290行: [mypy] error
- 🔴 第311行: [mypy] error
- 🔴 第332行: [mypy] error
- 🔴 第375行: [mypy] error
- 🔴 第384行: [mypy] error
- 🔴 第409行: [mypy] error
- 🔴 第413行: [mypy] error
- 🔴 第480行: [mypy] error
- 🔴 第486行: [mypy] error
- 🔴 第487行: [mypy] error

### 📄 internal/config/settings.py
- 🔵 第8行: [unused_import] 可能未使用的导入: Any
- 🔵 第9行: [unused_import] 可能未使用的导入: Path
- 🔵 第12行: [unused_import] 可能未使用的导入: SettingsConfigDict
- 🟡 第29行: [security_check] 密码相关代码需要特别注意
- 🟡 第53行: [security_check] 密码相关代码需要特别注意
- 🟡 第77行: [security_check] 密码相关代码需要特别注意
- 🟡 第87行: [security_check] 令牌相关代码需要特别注意
- 🟡 第98行: [security_check] 密钥相关代码需要特别注意
- 🟡 第100行: [security_check] 令牌相关代码需要特别注意
- 🟡 第101行: [security_check] 令牌相关代码需要特别注意
- 🟡 第108行: [security_check] 密码相关代码需要特别注意
- 🟡 第109行: [security_check] 密码相关代码需要特别注意
- 🟡 第110行: [security_check] 密码相关代码需要特别注意
- 🟡 第111行: [security_check] 密码相关代码需要特别注意
- 🟡 第112行: [security_check] 密码相关代码需要特别注意
- 🟡 第119行: [security_check] 密码相关代码需要特别注意
- 🔴 第190行: [mypy] error
- 🔴 第198行: [mypy] error

### 📄 internal/database/connection_manager.py
- 🔵 第12行: [unused_import] 可能未使用的导入: timedelta
- 🔴 第32行: [mypy] error
- 🔴 第52行: [mypy] error
- 🔴 第118行: [mypy] error
- 🔴 第131行: [mypy] error
- 🔴 第141行: [mypy] error
- 🟡 第281行: [security_check] 密码相关代码需要特别注意
- 🔴 第370行: [mypy] error
- 🔴 第457行: [mypy] error

### 📄 internal/database/query_optimizer.py
- 🟡 第1行: [file_length] 文件过长 (540 行)，建议拆分
- 🔵 第9行: [unused_import] 可能未使用的导入: Tuple
- 🔵 第9行: [unused_import] 可能未使用的导入: Union
- 🔵 第11行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第12行: [unused_import] 可能未使用的导入: defaultdict
- 🔴 第49行: [mypy] error
- 🟡 第49行: [function_length] 函数 __init__ 过长 (102 行)
- 🔴 第151行: [mypy] error
- 🔴 第197行: [mypy] error
- 🔴 第197行: [mypy] error
- 🟡 第197行: [function_length] 函数 async analyze_query_performance 过长 (58 行)
- 🟡 第255行: [function_length] 函数 async create_recommended_indexes 过长 (61 行)
- 🟡 第316行: [function_length] 函数 async get_table_statistics 过长 (52 行)
- 🟡 第392行: [function_length] 函数 async optimize_table_maintenance 过长 (53 行)
- 🔴 第394行: [mypy] error

### 📄 internal/db/__init__.py
- 🔵 第5行: [unused_import] 可能未使用的导入: Optional
- 🔴 第32行: [mypy] error
- 🔴 第39行: [mypy] error
- 🟡 第44行: [security_check] 密码相关代码需要特别注意
- 🔴 第57行: [mypy] error
- 🟡 第87行: [security_check] 密码相关代码需要特别注意
- 🔴 第91行: [mypy] error
- 🔴 第93行: [mypy] error
- 🔴 第116行: [mypy] error
- 🔴 第122行: [mypy] error

### 📄 internal/db/connection_pool.py
- 🔵 第16行: [unused_import] 可能未使用的导入: NullPool
- 🔵 第20行: [unused_import] 可能未使用的导入: timedelta
- 🔴 第30行: [mypy] error
- 🔴 第45行: [mypy] error
- 🟡 第45行: [function_length] 函数 async initialize 过长 (63 行)
- 🟡 第89行: [security_check] 密码相关代码需要特别注意
- 🔴 第108行: [mypy] error
- 🔴 第112行: [mypy] error
- 🔴 第121行: [mypy] error
- 🔴 第127行: [mypy] error
- 🔴 第133行: [mypy] error
- 🔴 第175行: [mypy] error
- 🔴 第176行: [mypy] error
- 🔴 第177行: [mypy] error
- 🔴 第178行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第222行: [mypy] error
- 🔴 第247行: [mypy] error

### 📄 internal/db/models.py
- 🟡 第33行: [security_check] 密码相关代码需要特别注意
- 🟡 第69行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 密钥相关代码需要特别注意
- 🟡 第80行: [security_check] 密钥相关代码需要特别注意
- 🟡 第238行: [security_check] 令牌相关代码需要特别注意
- 🟡 第240行: [security_check] 令牌相关代码需要特别注意
- 🟡 第252行: [security_check] 令牌相关代码需要特别注意
- 🟡 第261行: [security_check] 令牌相关代码需要特别注意
- 🟡 第264行: [security_check] 令牌相关代码需要特别注意
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第286行: [security_check] 令牌相关代码需要特别注意
- 🟡 第287行: [security_check] 令牌相关代码需要特别注意
- 🟡 第304行: [security_check] 密钥相关代码需要特别注意
- 🟡 第306行: [security_check] 密钥相关代码需要特别注意
- 🟡 第319行: [security_check] 密钥相关代码需要特别注意
- 🟡 第327行: [security_check] 密钥相关代码需要特别注意
- 🟡 第330行: [security_check] 密钥相关代码需要特别注意
- 🟡 第333行: [security_check] 密钥相关代码需要特别注意
- 🟡 第406行: [security_check] 密码相关代码需要特别注意
- 🟡 第407行: [security_check] 密码相关代码需要特别注意
- 🟡 第423行: [security_check] 令牌相关代码需要特别注意
- 🟡 第424行: [security_check] 密钥相关代码需要特别注意

### 📄 internal/db/session.py
- 🔵 第9行: [unused_import] 可能未使用的导入: Depends
- 🔴 第54行: [mypy] error

### 📄 internal/delivery/grpc/service.py
- 🟡 第1行: [file_length] 文件过长 (732 行)，建议拆分
- 🔵 第10行: [unused_import] 可能未使用的导入: Dict
- 🔵 第10行: [unused_import] 可能未使用的导入: Any
- 🔵 第10行: [unused_import] 可能未使用的导入: Optional
- 🔵 第14行: [unused_import] 可能未使用的导入: AsyncSession
- 🔴 第16行: [mypy] error
- 🔴 第16行: [mypy] error
- 🟡 第20行: [security_check] 令牌相关代码需要特别注意
- 🔴 第23行: [mypy] error
- 🔴 第23行: [mypy] error
- 🟡 第24行: [security_check] 令牌相关代码需要特别注意
- 🟡 第25行: [security_check] 密码相关代码需要特别注意
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意
- 🟡 第26行: [security_check] 密码相关代码需要特别注意
- 🟡 第26行: [security_check] 令牌相关代码需要特别注意
- 🔴 第35行: [mypy] error
- 🟡 第35行: [function_length] 函数 async Register 过长 (68 行)
- 🟡 第60行: [security_check] 密码相关代码需要特别注意
- 🟡 第71行: [security_check] 密码相关代码需要特别注意
- 🔴 第103行: [mypy] error
- 🟡 第103行: [function_length] 函数 async Login 过长 (215 行)
- 🟡 第109行: [security_check] 密码相关代码需要特别注意
- 🟡 第140行: [security_check] 密码相关代码需要特别注意
- 🟡 第156行: [security_check] 令牌相关代码需要特别注意
- 🟡 第160行: [security_check] 令牌相关代码需要特别注意
- 🟡 第165行: [security_check] 令牌相关代码需要特别注意
- 🟡 第171行: [security_check] 令牌相关代码需要特别注意
- 🟡 第175行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第177行: [security_check] 令牌相关代码需要特别注意
- 🟡 第178行: [security_check] 令牌相关代码需要特别注意
- 🔵 第186行: [unused_import] 可能未使用的导入: SMSService
- 🟡 第212行: [security_check] 令牌相关代码需要特别注意
- 🟡 第215行: [security_check] 令牌相关代码需要特别注意
- 🟡 第216行: [security_check] 令牌相关代码需要特别注意
- 🟡 第217行: [security_check] 令牌相关代码需要特别注意
- 🟡 第218行: [security_check] 令牌相关代码需要特别注意
- 🔵 第225行: [unused_import] 可能未使用的导入: EmailService
- 🟡 第251行: [security_check] 令牌相关代码需要特别注意
- 🟡 第254行: [security_check] 令牌相关代码需要特别注意
- 🟡 第255行: [security_check] 令牌相关代码需要特别注意
- 🟡 第256行: [security_check] 令牌相关代码需要特别注意
- 🟡 第257行: [security_check] 令牌相关代码需要特别注意
- 🟡 第267行: [security_check] 令牌相关代码需要特别注意
- 🟡 第274行: [security_check] 令牌相关代码需要特别注意
- 🟡 第278行: [security_check] 令牌相关代码需要特别注意
- 🟡 第281行: [security_check] 令牌相关代码需要特别注意
- 🟡 第286行: [security_check] 令牌相关代码需要特别注意
- 🟡 第287行: [security_check] 令牌相关代码需要特别注意
- 🟡 第288行: [security_check] 令牌相关代码需要特别注意
- 🟡 第289行: [security_check] 令牌相关代码需要特别注意
- 🔴 第318行: [mypy] error
- 🟡 第325行: [security_check] 令牌相关代码需要特别注意
- 🟡 第326行: [security_check] 令牌相关代码需要特别注意
- 🟡 第327行: [security_check] 令牌相关代码需要特别注意
- 🟡 第332行: [security_check] 令牌相关代码需要特别注意
- 🔴 第358行: [mypy] error
- 🟡 第358行: [security_check] 令牌相关代码需要特别注意
- 🟡 第364行: [security_check] 令牌相关代码需要特别注意
- 🟡 第367行: [security_check] 令牌相关代码需要特别注意
- 🟡 第368行: [security_check] 令牌相关代码需要特别注意
- 🟡 第369行: [security_check] 令牌相关代码需要特别注意
- 🟡 第370行: [security_check] 令牌相关代码需要特别注意
- 🟡 第371行: [security_check] 令牌相关代码需要特别注意
- 🟡 第380行: [security_check] 令牌相关代码需要特别注意
- 🟡 第386行: [security_check] 令牌相关代码需要特别注意
- 🟡 第389行: [security_check] 令牌相关代码需要特别注意
- 🔴 第394行: [mypy] error
- 🟡 第394行: [security_check] 令牌相关代码需要特别注意
- 🟡 第400行: [security_check] 令牌相关代码需要特别注意
- 🟡 第403行: [security_check] 令牌相关代码需要特别注意
- 🟡 第405行: [security_check] 令牌相关代码需要特别注意
- 🟡 第406行: [security_check] 令牌相关代码需要特别注意
- 🟡 第407行: [security_check] 令牌相关代码需要特别注意
- 🟡 第415行: [security_check] 令牌相关代码需要特别注意
- 🟡 第421行: [security_check] 令牌相关代码需要特别注意
- 🟡 第424行: [security_check] 令牌相关代码需要特别注意
- 🔴 第429行: [mypy] error
- 🟡 第429行: [function_length] 函数 async CheckPermission 过长 (55 行)
- 🔴 第484行: [mypy] error
- 🟡 第484行: [function_length] 函数 async GetUserRoles 过长 (51 行)
- 🔴 第535行: [mypy] error
- 🟡 第535行: [function_length] 函数 async EnableMFA 过长 (58 行)
- 🟡 第565行: [security_check] 密钥相关代码需要特别注意
- 🔴 第593行: [mypy] error
- 🟡 第593行: [function_length] 函数 async VerifyMFA 过长 (75 行)
- 🟡 第612行: [security_check] 令牌相关代码需要特别注意
- 🟡 第615行: [security_check] 令牌相关代码需要特别注意
- 🟡 第618行: [security_check] 令牌相关代码需要特别注意
- 🟡 第619行: [security_check] 令牌相关代码需要特别注意
- 🟡 第622行: [security_check] 令牌相关代码需要特别注意
- 🟡 第623行: [security_check] 令牌相关代码需要特别注意
- 🟡 第626行: [security_check] 令牌相关代码需要特别注意
- 🟡 第631行: [security_check] 令牌相关代码需要特别注意
- 🟡 第632行: [security_check] 令牌相关代码需要特别注意
- 🟡 第633行: [security_check] 令牌相关代码需要特别注意
- 🟡 第634行: [security_check] 令牌相关代码需要特别注意
- 🟡 第637行: [security_check] 令牌相关代码需要特别注意
- 🔴 第668行: [mypy] error
- 🟡 第668行: [security_check] 密码相关代码需要特别注意
- 🟡 第707行: [security_check] 密码相关代码需要特别注意
- 🟡 第708行: [security_check] 密码相关代码需要特别注意
- 🟡 第711行: [security_check] 密码相关代码需要特别注意
- 🟡 第720行: [security_check] 密码相关代码需要特别注意
- 🟡 第726行: [security_check] 密码相关代码需要特别注意
- 🟡 第729行: [security_check] 密码相关代码需要特别注意

### 📄 internal/delivery/rest/admin_handler.py
- 🔵 第7行: [unused_import] 可能未使用的导入: List
- 🔴 第30行: [mypy] error
- 🔴 第55行: [mypy] error
- 🔴 第106行: [mypy] error
- 🔴 第136行: [mypy] error
- 🔴 第137行: [mypy] error
- 🔴 第160行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第210行: [mypy] error

### 📄 internal/delivery/rest/auth_handler.py
- 🟡 第1行: [file_length] 文件过长 (724 行)，建议拆分
- 🟡 第12行: [security_check] 密码相关代码需要特别注意
- 🔵 第14行: [unused_import] 可能未使用的导入: UserUpdate
- 🟡 第16行: [security_check] 密码相关代码需要特别注意
- 🟡 第16行: [security_check] 令牌相关代码需要特别注意
- 🟡 第17行: [security_check] 令牌相关代码需要特别注意
- 🔴 第20行: [mypy] error
- 🟡 第45行: [security_check] 密码相关代码需要特别注意
- 🟡 第46行: [security_check] 令牌相关代码需要特别注意
- 🟡 第55行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 密码相关代码需要特别注意
- 🔴 第78行: [mypy] error
- 🟡 第90行: [security_check] 令牌相关代码需要特别注意
- 🔴 第93行: [mypy] error
- 🟡 第98行: [security_check] 令牌相关代码需要特别注意
- 🔴 第104行: [mypy] error
- 🟡 第141行: [security_check] 密码相关代码需要特别注意
- 🔴 第147行: [mypy] error
- 🔴 第150行: [mypy] error
- 🔴 第159行: [mypy] error
- 🔴 第169行: [mypy] error
- 🟡 第178行: [security_check] 令牌相关代码需要特别注意
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🟡 第191行: [security_check] 令牌相关代码需要特别注意
- 🟡 第203行: [security_check] 令牌相关代码需要特别注意
- 🟡 第204行: [security_check] 令牌相关代码需要特别注意
- 🔴 第209行: [mypy] error
- 🟡 第210行: [security_check] 令牌相关代码需要特别注意
- 🟡 第213行: [security_check] 令牌相关代码需要特别注意
- 🔴 第217行: [mypy] error
- 🟡 第218行: [security_check] 令牌相关代码需要特别注意
- 🟡 第219行: [security_check] 令牌相关代码需要特别注意
- 🔴 第228行: [mypy] error
- 🟡 第229行: [security_check] 令牌相关代码需要特别注意
- 🟡 第241行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [security_check] 令牌相关代码需要特别注意
- 🔴 第258行: [mypy] error
- 🟡 第258行: [security_check] 令牌相关代码需要特别注意
- 🔴 第261行: [mypy] error
- 🔴 第270行: [mypy] error
- 🟡 第279行: [security_check] 令牌相关代码需要特别注意
- 🟡 第281行: [security_check] 令牌相关代码需要特别注意
- 🟡 第296行: [security_check] 令牌相关代码需要特别注意
- 🟡 第320行: [security_check] 密码相关代码需要特别注意
- 🟡 第342行: [security_check] 密码相关代码需要特别注意
- 🔴 第345行: [mypy] error
- 🟡 第346行: [security_check] 密码相关代码需要特别注意
- 🟡 第364行: [security_check] 密码相关代码需要特别注意
- 🟡 第367行: [security_check] 密码相关代码需要特别注意
- 🟡 第386行: [security_check] 密码相关代码需要特别注意
- 🟡 第387行: [security_check] 令牌相关代码需要特别注意
- 🟡 第388行: [security_check] 密码相关代码需要特别注意
- 🔴 第393行: [mypy] error
- 🟡 第394行: [security_check] 密码相关代码需要特别注意
- 🔴 第401行: [mypy] error
- 🟡 第402行: [security_check] 密码相关代码需要特别注意
- 🔴 第411行: [mypy] error
- 🟡 第412行: [security_check] 密码相关代码需要特别注意
- 🔴 第442行: [mypy] error
- 🔴 第486行: [mypy] error
- 🔴 第491行: [mypy] error
- 🔴 第503行: [mypy] error
- 🔴 第517行: [mypy] error
- 🔴 第527行: [mypy] error
- 🔴 第556行: [mypy] error
- 🟡 第628行: [security_check] 令牌相关代码需要特别注意
- 🔴 第629行: [mypy] error
- 🟡 第629行: [security_check] 令牌相关代码需要特别注意
- 🟡 第631行: [security_check] 密码相关代码需要特别注意
- 🔴 第639行: [mypy] error
- 🟡 第648行: [security_check] 令牌相关代码需要特别注意
- 🔴 第649行: [mypy] error
- 🟡 第649行: [security_check] 令牌相关代码需要特别注意
- 🟡 第655行: [security_check] 令牌相关代码需要特别注意
- 🔴 第659行: [mypy] error
- 🔴 第669行: [mypy] error
- 🟡 第669行: [security_check] 令牌相关代码需要特别注意
- 🟡 第670行: [security_check] 令牌相关代码需要特别注意
- 🟡 第674行: [security_check] 令牌相关代码需要特别注意
- 🟡 第677行: [security_check] 密码相关代码需要特别注意
- 🔴 第678行: [mypy] error
- 🟡 第678行: [security_check] 密码相关代码需要特别注意
- 🟡 第684行: [security_check] 密码相关代码需要特别注意
- 🟡 第687行: [security_check] 密码相关代码需要特别注意
- 🔴 第688行: [mypy] error
- 🟡 第688行: [security_check] 密码相关代码需要特别注意
- 🟡 第690行: [security_check] 密码相关代码需要特别注意
- 🟡 第694行: [security_check] 密码相关代码需要特别注意
- 🔴 第698行: [mypy] error
- 🔴 第708行: [mypy] error
- 🔴 第719行: [mypy] error

### 📄 internal/delivery/rest/biometric_handler.py
- 🔴 第11行: [mypy] error
- 🔴 第79行: [mypy] error
- 🔴 第86行: [mypy] error
- 🔴 第102行: [mypy] error
- 🔴 第114行: [mypy] error
- 🔴 第131行: [mypy] error
- 🔴 第140行: [mypy] error
- 🔴 第153行: [mypy] error
- 🔴 第164行: [mypy] error
- 🔴 第181行: [mypy] error
- 🔴 第187行: [mypy] error
- 🔴 第197行: [mypy] error
- 🔴 第208行: [mypy] error
- 🔴 第230行: [mypy] error
- 🔴 第257行: [mypy] error
- 🔴 第262行: [mypy] error

### 📄 internal/delivery/rest/blockchain_handler.py
- 🔴 第13行: [mypy] error
- 🟡 第49行: [security_check] 令牌相关代码需要特别注意
- 🔴 第70行: [mypy] error
- 🔴 第80行: [mypy] error
- 🔴 第96行: [mypy] error
- 🔴 第132行: [mypy] error
- 🔴 第144行: [mypy] error
- 🔴 第173行: [mypy] error
- 🔴 第183行: [mypy] error
- 🔴 第203行: [mypy] error
- 🔴 第223行: [mypy] error

### 📄 internal/delivery/rest/docs.py
- 🔵 第8行: [unused_import] 可能未使用的导入: List
- 🔵 第8行: [unused_import] 可能未使用的导入: Optional
- 🟡 第103行: [security_check] 密码相关代码需要特别注意
- 🟡 第106行: [security_check] 密码相关代码需要特别注意
- 🟡 第107行: [security_check] 令牌相关代码需要特别注意
- 🔴 第131行: [mypy] error
- 🔴 第135行: [mypy] error
- 🔴 第145行: [mypy] error
- 🔴 第146行: [mypy] error
- 🔴 第150行: [mypy] error
- 🟡 第184行: [security_check] 令牌相关代码需要特别注意
- 🟡 第192行: [security_check] 令牌相关代码需要特别注意
- 🔴 第199行: [mypy] error
- 🔴 第200行: [mypy] error
- 🔴 第201行: [mypy] error
- 🔴 第207行: [mypy] error
- 🔴 第208行: [mypy] error
- 🔴 第209行: [mypy] error
- 🔴 第211行: [mypy] error

### 📄 internal/delivery/rest/health.py
- 🔴 第10行: [mypy] error
- 🔴 第37行: [mypy] error
- 🔴 第76行: [mypy] error
- 🔴 第168行: [mypy] error
- 🔴 第185行: [mypy] error

### 📄 internal/delivery/rest/health_handler.py
- 🔵 第7行: [unused_import] 可能未使用的导入: Dict
- 🔵 第7行: [unused_import] 可能未使用的导入: Any
- 🔴 第19行: [mypy] error
- 🔴 第29行: [mypy] error
- 🔴 第35行: [mypy] error
- 🔴 第67行: [mypy] error
- 🔴 第87行: [mypy] error
- 🔴 第106行: [mypy] error
- 🔴 第122行: [mypy] error

### 📄 internal/delivery/rest/middleware.py
- 🔵 第15行: [unused_import] 可能未使用的导入: Dict
- 🔴 第71行: [mypy] error
- 🟡 第85行: [security_check] 密码相关代码需要特别注意
- 🔴 第109行: [mypy] error
- 🔴 第135行: [mypy] error
- 🔴 第142行: [mypy] error

### 📄 internal/delivery/rest/oauth_controller.py
- 🔴 第16行: [mypy] error
- 🔴 第95行: [mypy] error
- 🟡 第121行: [security_check] 令牌相关代码需要特别注意
- 🟡 第131行: [security_check] 令牌相关代码需要特别注意
- 🔴 第132行: [mypy] error
- 🟡 第139行: [security_check] 令牌相关代码需要特别注意
- 🟡 第140行: [security_check] 令牌相关代码需要特别注意
- 🟡 第141行: [security_check] 令牌相关代码需要特别注意
- 🟡 第142行: [security_check] 令牌相关代码需要特别注意
- 🔴 第165行: [mypy] error
- 🔴 第182行: [mypy] error
- 🔴 第203行: [mypy] error

### 📄 internal/delivery/rest/routes.py
- 🟡 第11行: [security_check] 密码相关代码需要特别注意
- 🟡 第14行: [security_check] 密码相关代码需要特别注意
- 🟡 第15行: [security_check] 令牌相关代码需要特别注意
- 🟡 第24行: [security_check] 密码相关代码需要特别注意
- 🟡 第24行: [security_check] 令牌相关代码需要特别注意
- 🟡 第27行: [security_check] 令牌相关代码需要特别注意
- 🔴 第28行: [mypy] error
- 🟡 第28行: [security_check] 密码相关代码需要特别注意
- 🟡 第28行: [security_check] 令牌相关代码需要特别注意
- 🟡 第30行: [security_check] 密码相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🔴 第41行: [mypy] error
- 🔴 第44行: [mypy] error
- 🟡 第53行: [security_check] 令牌相关代码需要特别注意
- 🔴 第54行: [mypy] error
- 🟡 第54行: [security_check] 令牌相关代码需要特别注意
- 🔴 第57行: [mypy] error
- 🟡 第57行: [security_check] 令牌相关代码需要特别注意
- 🟡 第58行: [security_check] 令牌相关代码需要特别注意
- 🔴 第68行: [mypy] error
- 🔴 第75行: [mypy] error
- 🟡 第75行: [security_check] 令牌相关代码需要特别注意
- 🔴 第78行: [mypy] error
- 🟡 第78行: [security_check] 令牌相关代码需要特别注意
- 🟡 第89行: [security_check] 密码相关代码需要特别注意
- 🔴 第90行: [mypy] error
- 🟡 第90行: [security_check] 密码相关代码需要特别注意
- 🔴 第93行: [mypy] error
- 🟡 第93行: [security_check] 密码相关代码需要特别注意
- 🟡 第102行: [security_check] 密码相关代码需要特别注意
- 🔴 第103行: [mypy] error
- 🟡 第103行: [security_check] 密码相关代码需要特别注意
- 🔴 第106行: [mypy] error
- 🟡 第106行: [security_check] 密码相关代码需要特别注意
- 🟡 第106行: [security_check] 令牌相关代码需要特别注意
- 🔴 第117行: [mypy] error
- 🔴 第120行: [mypy] error
- 🔴 第130行: [mypy] error
- 🔴 第133行: [mypy] error
- 🔴 第149行: [mypy] error
- 🔴 第152行: [mypy] error
- 🔴 第163行: [mypy] error
- 🔴 第169行: [mypy] error
- 🔴 第175行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第204行: [mypy] error
- 🔴 第223行: [mypy] error
- 🔴 第236行: [mypy] error
- 🔴 第246行: [mypy] error
- 🔴 第260行: [mypy] error
- 🔴 第270行: [mypy] error
- 🔴 第296行: [mypy] error
- 🔴 第309行: [mypy] error
- 🔴 第322行: [mypy] error
- 🔴 第345行: [mypy] error
- 🔴 第367行: [mypy] error

### 📄 internal/delivery/rest/social_auth_handler.py
- 🔴 第13行: [mypy] error
- 🔴 第29行: [mypy] error
- 🟡 第50行: [security_check] 令牌相关代码需要特别注意
- 🔴 第59行: [mypy] error
- 🔴 第64行: [mypy] error
- 🔴 第98行: [mypy] error
- 🔴 第140行: [mypy] error
- 🔴 第148行: [mypy] error
- 🔴 第160行: [mypy] error
- 🔴 第172行: [mypy] error
- 🔴 第194行: [mypy] error
- 🔴 第224行: [mypy] error

### 📄 internal/delivery/rest/user_handler.py
- 🟡 第1行: [file_length] 文件过长 (872 行)，建议拆分
- 🔵 第9行: [unused_import] 可能未使用的导入: Any
- 🔴 第17行: [mypy] error
- 🔵 第19行: [unused_import] 可能未使用的导入: RoleRepository
- 🔵 第19行: [unused_import] 可能未使用的导入: PermissionRepository
- 🔵 第20行: [unused_import] 可能未使用的导入: UserRepository
- 🔴 第100行: [mypy] error
- 🔴 第107行: [mypy] error
- 🔴 第116行: [mypy] error
- 🔴 第126行: [mypy] error
- 🔴 第176行: [mypy] error
- 🔴 第221行: [mypy] error
- 🔴 第270行: [mypy] error
- 🔴 第273行: [mypy] error
- 🔴 第282行: [mypy] error
- 🔴 第294行: [mypy] error
- 🔴 第337行: [mypy] error
- 🔴 第338行: [mypy] error
- 🔴 第344行: [mypy] error
- 🔴 第353行: [mypy] error
- 🔴 第365行: [mypy] error
- 🔴 第412行: [mypy] error
- 🔴 第412行: [mypy] error
- 🔴 第415行: [mypy] error
- 🔴 第426行: [mypy] error
- 🔴 第459行: [mypy] error
- 🔴 第504行: [mypy] error
- 🔴 第559行: [mypy] error
- 🔴 第567行: [mypy] error
- 🔴 第584行: [mypy] error
- 🔴 第626行: [mypy] error
- 🔴 第634行: [mypy] error
- 🔴 第651行: [mypy] error
- 🔴 第687行: [mypy] error
- 🔴 第689行: [mypy] error
- 🔴 第708行: [mypy] error
- 🔴 第708行: [mypy] error
- 🔴 第744行: [mypy] error
- 🔴 第753行: [mypy] error
- 🔴 第764行: [mypy] error
- 🔴 第780行: [mypy] error
- 🔴 第790行: [mypy] error
- 🔴 第801行: [mypy] error
- 🔴 第813行: [mypy] error
- 🔴 第824行: [mypy] error
- 🔴 第833行: [mypy] error
- 🔴 第842行: [mypy] error
- 🔴 第854行: [mypy] error
- 🔴 第866行: [mypy] error

### 📄 internal/dependencies.py
- 🔵 第8行: [unused_import] 可能未使用的导入: Dict
- 🔵 第8行: [unused_import] 可能未使用的导入: Any
- 🔵 第12行: [unused_import] 可能未使用的导入: get_jwt_key_manager
- 🟡 第13行: [security_check] 密码相关代码需要特别注意
- 🔴 第21行: [mypy] error
- 🟡 第24行: [security_check] 密码相关代码需要特别注意
- 🟡 第36行: [security_check] 密码相关代码需要特别注意
- 🟡 第38行: [security_check] 密码相关代码需要特别注意
- 🟡 第39行: [security_check] 密码相关代码需要特别注意
- 🟡 第40行: [security_check] 密码相关代码需要特别注意
- 🔴 第43行: [mypy] error
- 🔴 第50行: [mypy] error
- 🔴 第71行: [mypy] error
- 🔴 第78行: [mypy] error
- 🔴 第85行: [mypy] error
- 🔴 第92行: [mypy] error
- 🔴 第99行: [mypy] error
- 🔴 第106行: [mypy] error
- 🔴 第114行: [mypy] error
- 🔴 第119行: [mypy] error
- 🔴 第124行: [mypy] error
- 🔴 第129行: [mypy] error
- 🔴 第134行: [mypy] error
- 🔴 第139行: [mypy] error

### 📄 internal/discovery/service_registry.py
- 🟡 第1行: [file_length] 文件过长 (550 行)，建议拆分
- 🔵 第11行: [unused_import] 可能未使用的导入: Callable
- 🔵 第13行: [unused_import] 可能未使用的导入: timedelta
- 🔴 第98行: [mypy] error
- 🔴 第110行: [mypy] error
- 🔴 第125行: [mypy] error
- 🔴 第301行: [mypy] error
- 🔴 第312行: [mypy] error
- 🔴 第369行: [mypy] error
- 🔴 第389行: [mypy] error
- 🔴 第501行: [mypy] error
- 🔴 第548行: [mypy] error

### 📄 internal/exceptions.py
- 🟡 第38行: [security_check] 令牌相关代码需要特别注意
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第47行: [security_check] 令牌相关代码需要特别注意
- 🟡 第50行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 令牌相关代码需要特别注意
- 🟡 第57行: [security_check] 令牌相关代码需要特别注意
- 🟡 第61行: [security_check] 令牌相关代码需要特别注意
- 🟡 第90行: [security_check] 密码相关代码需要特别注意
- 🟡 第95行: [security_check] 密码相关代码需要特别注意
- 🟡 第99行: [security_check] 密码相关代码需要特别注意
- 🟡 第102行: [security_check] 密码相关代码需要特别注意
- 🟡 第106行: [security_check] 密码相关代码需要特别注意

### 📄 internal/exceptions/__init__.py
- 🟡 第33行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第41行: [security_check] 令牌相关代码需要特别注意
- 🟡 第60行: [security_check] 令牌相关代码需要特别注意
- 🟡 第61行: [security_check] 令牌相关代码需要特别注意
- 🟡 第62行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/grpc_client/client_manager.py
- 🔵 第9行: [unused_import] 可能未使用的导入: Callable
- 🔵 第11行: [unused_import] 可能未使用的导入: timedelta
- 🔴 第135行: [mypy] error
- 🔴 第145行: [mypy] error
- 🔴 第270行: [mypy] error
- 🔴 第277行: [mypy] error
- 🔴 第327行: [mypy] error
- 🔴 第333行: [mypy] error
- 🔴 第345行: [mypy] error
- 🔴 第367行: [mypy] error
- 🔴 第386行: [mypy] error
- 🔴 第418行: [mypy] error
- 🔴 第420行: [mypy] error
- 🔴 第454行: [mypy] error

### 📄 internal/ha/failover_manager.py
- 🟡 第1行: [file_length] 文件过长 (725 行)，建议拆分
- 🔵 第19行: [unused_import] 可能未使用的导入: ServiceInstance
- 🔵 第19行: [unused_import] 可能未使用的导入: ServiceStatus
- 🔴 第97行: [mypy] error
- 🔴 第123行: [mypy] error
- 🔴 第167行: [mypy] error
- 🔴 第183行: [mypy] error
- 🔴 第209行: [mypy] error
- 🔴 第235行: [mypy] error
- 🔴 第254行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第292行: [mypy] error
- 🔴 第305行: [mypy] error
- 🔴 第335行: [mypy] error
- 🔴 第375行: [mypy] error
- 🔴 第455行: [mypy] error
- 🔴 第464行: [mypy] error
- 🔴 第465行: [mypy] error
- 🔴 第487行: [mypy] error
- 🔴 第529行: [mypy] error
- 🔴 第532行: [mypy] error
- 🔴 第538行: [mypy] error
- 🔴 第545行: [mypy] error
- 🔴 第546行: [mypy] error
- 🔴 第607行: [mypy] error
- 🔴 第633行: [mypy] error
- 🔴 第650行: [mypy] error

### 📄 internal/middleware/rate_limiter.py
- 🔵 第11行: [unused_import] 可能未使用的导入: datetime
- 🔵 第11行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第12行: [unused_import] 可能未使用的导入: defaultdict
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意
- 🟡 第28行: [security_check] 令牌相关代码需要特别注意
- 🟡 第32行: [security_check] 令牌相关代码需要特别注意
- 🟡 第36行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🔴 第41行: [mypy] error
- 🟡 第47行: [security_check] 令牌相关代码需要特别注意
- 🟡 第48行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 密码相关代码需要特别注意
- 🔴 第131行: [mypy] error
- 🔴 第134行: [mypy] error
- 🔴 第138行: [mypy] error
- 🔴 第150行: [mypy] error
- 🔴 第151行: [mypy] error
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第184行: [security_check] 令牌相关代码需要特别注意
- 🟡 第187行: [security_check] 令牌相关代码需要特别注意
- 🟡 第191行: [security_check] 令牌相关代码需要特别注意
- 🟡 第192行: [security_check] 令牌相关代码需要特别注意
- 🔴 第242行: [mypy] error
- 🔴 第262行: [mypy] error
- 🔴 第267行: [mypy] error
- 🔴 第313行: [mypy] error
- 🔴 第313行: [mypy] error
- 🟡 第358行: [security_check] 密码相关代码需要特别注意
- 🟡 第359行: [security_check] 密码相关代码需要特别注意
- 🔴 第370行: [mypy] error
- 🔴 第372行: [mypy] error
- 🔴 第373行: [mypy] error
- 🔴 第373行: [mypy] error
- 🟡 第399行: [security_check] 密码相关代码需要特别注意

### 📄 internal/model/errors.py
- 🔵 第9行: [unused_import] 可能未使用的导入: Tuple
- 🟡 第21行: [security_check] 密码相关代码需要特别注意
- 🟡 第22行: [security_check] 令牌相关代码需要特别注意
- 🟡 第23行: [security_check] 令牌相关代码需要特别注意
- 🟡 第30行: [security_check] 密码相关代码需要特别注意
- 🟡 第33行: [security_check] 密码相关代码需要特别注意
- 🟡 第128行: [security_check] 令牌相关代码需要特别注意
- 🟡 第131行: [security_check] 令牌相关代码需要特别注意
- 🟡 第134行: [security_check] 令牌相关代码需要特别注意
- 🟡 第137行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 密码相关代码需要特别注意
- 🟡 第162行: [security_check] 密码相关代码需要特别注意
- 🟡 第165行: [security_check] 密码相关代码需要特别注意
- 🟡 第168行: [security_check] 密码相关代码需要特别注意

### 📄 internal/model/i18n.py
- 🟡 第1行: [file_length] 文件过长 (586 行)，建议拆分
- 🟡 第107行: [security_check] 密码相关代码需要特别注意
- 🟡 第135行: [security_check] 令牌相关代码需要特别注意
- 🟡 第136行: [security_check] 令牌相关代码需要特别注意
- 🟡 第140行: [security_check] 令牌相关代码需要特别注意
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第147行: [security_check] 令牌相关代码需要特别注意
- 🟡 第151行: [security_check] 令牌相关代码需要特别注意
- 🟡 第157行: [security_check] 令牌相关代码需要特别注意
- 🟡 第158行: [security_check] 令牌相关代码需要特别注意
- 🟡 第162行: [security_check] 令牌相关代码需要特别注意
- 🟡 第225行: [security_check] 密码相关代码需要特别注意
- 🟡 第226行: [security_check] 密码相关代码需要特别注意
- 🟡 第230行: [security_check] 密码相关代码需要特别注意
- 🟡 第236行: [security_check] 密码相关代码需要特别注意
- 🟡 第237行: [security_check] 密码相关代码需要特别注意
- 🟡 第241行: [security_check] 密码相关代码需要特别注意
- 🟡 第247行: [security_check] 密码相关代码需要特别注意
- 🟡 第248行: [security_check] 密码相关代码需要特别注意
- 🟡 第252行: [security_check] 密码相关代码需要特别注意
- 🟡 第435行: [security_check] 密码相关代码需要特别注意
- 🟡 第436行: [security_check] 密码相关代码需要特别注意
- 🟡 第440行: [security_check] 密码相关代码需要特别注意
- 🟡 第446行: [security_check] 密码相关代码需要特别注意
- 🟡 第447行: [security_check] 密码相关代码需要特别注意
- 🟡 第451行: [security_check] 密码相关代码需要特别注意
- 🟡 第480行: [security_check] 令牌相关代码需要特别注意
- 🟡 第481行: [security_check] 令牌相关代码需要特别注意
- 🟡 第485行: [security_check] 令牌相关代码需要特别注意
- 🔴 第551行: [mypy] error
- 🔴 第572行: [mypy] error

### 📄 internal/model/oauth.py
- 🔵 第9行: [unused_import] 可能未使用的导入: auto
- 🔵 第11行: [unused_import] 可能未使用的导入: validator
- 🟡 第29行: [security_check] 密钥相关代码需要特别注意
- 🟡 第31行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第39行: [security_check] 令牌相关代码需要特别注意
- 🟡 第40行: [security_check] 令牌相关代码需要特别注意
- 🟡 第41行: [security_check] 令牌相关代码需要特别注意
- 🟡 第64行: [security_check] 令牌相关代码需要特别注意
- 🟡 第65行: [security_check] 令牌相关代码需要特别注意
- 🟡 第78行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第87行: [security_check] 令牌相关代码需要特别注意
- 🟡 第88行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/model/refresh_token.py
- 🔴 第8行: [mypy] error
- 🔵 第9行: [unused_import] 可能未使用的导入: Dict
- 🔵 第9行: [unused_import] 可能未使用的导入: Optional
- 🔵 第14行: [unused_import] 可能未使用的导入: Mapped
- 🔴 第19行: [mypy] error
- 🔴 第19行: [mypy] error
- 🟡 第19行: [security_check] 令牌相关代码需要特别注意
- 🟡 第21行: [security_check] 令牌相关代码需要特别注意
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意
- 🟡 第34行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/model/user.py
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🟡 第36行: [security_check] 密码相关代码需要特别注意
- 🟡 第62行: [security_check] 令牌相关代码需要特别注意
- 🟡 第66行: [security_check] 令牌相关代码需要特别注意
- 🟡 第92行: [security_check] 令牌相关代码需要特别注意
- 🟡 第93行: [security_check] 令牌相关代码需要特别注意
- 🟡 第99行: [security_check] 密钥相关代码需要特别注意
- 🟡 第104行: [security_check] 密钥相关代码需要特别注意
- 🟡 第115行: [security_check] 密码相关代码需要特别注意
- 🟡 第122行: [security_check] 密钥相关代码需要特别注意
- 🟡 第156行: [security_check] 密码相关代码需要特别注意

### 📄 internal/monitoring/performance_monitor.py
- 🟡 第1行: [file_length] 文件过长 (604 行)，建议拆分
- 🔵 第10行: [unused_import] 可能未使用的导入: Callable
- 🔴 第64行: [mypy] error
- 🔴 第65行: [mypy] error
- 🔴 第66行: [mypy] error
- 🔴 第69行: [mypy] error
- 🔴 第77行: [mypy] error
- 🔴 第92行: [mypy] error
- 🟡 第92行: [function_length] 函数 _setup_prometheus_metrics 过长 (55 行)
- 🔴 第147行: [mypy] error
- 🔴 第152行: [mypy] error
- 🟡 第152行: [function_length] 函数 async _monitor_system_metrics 过长 (54 行)
- 🔴 第207行: [mypy] error
- 🔴 第242行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第306行: [mypy] error
- 🔴 第356行: [mypy] error
- 🔴 第409行: [mypy] error
- 🔴 第478行: [mypy] error
- 🔴 第485行: [mypy] error
- 🔴 第486行: [mypy] error
- 🔴 第486行: [mypy] error
- 🔴 第505行: [mypy] error
- 🔴 第520行: [mypy] error
- 🔴 第526行: [mypy] error
- 🔴 第540行: [mypy] error
- 🔴 第546行: [mypy] error
- 🔴 第559行: [mypy] error
- 🔴 第565行: [mypy] error
- 🔴 第576行: [mypy] error
- 🔴 第583行: [mypy] error
- 🔴 第584行: [mypy] error

### 📄 internal/observability/__init__.py
- 🔴 第9行: [mypy] error
- 🔴 第9行: [mypy] error
- 🔴 第9行: [mypy] error
- 🟡 第9行: [security_check] 令牌相关代码需要特别注意
- 🔴 第10行: [mypy] error
- 🔴 第10行: [mypy] error
- 🔴 第10行: [mypy] error
- 🟡 第10行: [security_check] 密码相关代码需要特别注意
- 🔴 第11行: [mypy] error
- 🔴 第11行: [mypy] error
- 🔴 第11行: [mypy] error
- 🟡 第11行: [security_check] 密码相关代码需要特别注意
- 🟡 第11行: [security_check] 令牌相关代码需要特别注意
- 🔴 第12行: [mypy] error
- 🔴 第13行: [mypy] error
- 🔴 第13行: [mypy] error
- 🔴 第13行: [mypy] error
- 🟡 第19行: [security_check] 令牌相关代码需要特别注意
- 🟡 第20行: [security_check] 令牌相关代码需要特别注意
- 🟡 第23行: [security_check] 密码相关代码需要特别注意
- 🟡 第24行: [security_check] 密码相关代码需要特别注意
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/observability/health.py
- 🔴 第25行: [mypy] error
- 🔴 第26行: [mypy] error
- 🔴 第32行: [mypy] error
- 🔴 第37行: [mypy] error
- 🔴 第42行: [mypy] error
- 🔴 第52行: [mypy] error
- 🔴 第61行: [mypy] error
- 🔴 第70行: [mypy] error
- 🔴 第97行: [mypy] error

### 📄 internal/observability/metrics.py
- 🔴 第74行: [mypy] error

### 📄 internal/observability/telemetry.py
- 🟡 第53行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 令牌相关代码需要特别注意
- 🔴 第138行: [mypy] error
- 🔴 第250行: [mypy] error

### 📄 internal/observability/tracing.py
- 🔴 第34行: [mypy] error

### 📄 internal/repository/__init__.py
- 🟡 第10行: [security_check] 令牌相关代码需要特别注意
- 🟡 第19行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/repository/audit_repository.py
- 🔴 第9行: [mypy] error
- 🔵 第9行: [unused_import] 可能未使用的导入: UTC
- 🔵 第13行: [unused_import] 可能未使用的导入: AsyncSession
- 🔵 第16行: [unused_import] 可能未使用的导入: DatabaseError
- 🔴 第25行: [mypy] error
- 🔴 第73行: [mypy] error
- 🔴 第113行: [mypy] error
- 🔴 第159行: [mypy] error
- 🔴 第176行: [mypy] error
- 🔴 第190行: [mypy] error
- 🔴 第221行: [mypy] error
- 🔴 第235行: [mypy] error
- 🔴 第253行: [mypy] error
- 🔴 第264行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第279行: [mypy] error
- 🔴 第294行: [mypy] error
- 🔴 第307行: [mypy] error
- 🔴 第307行: [mypy] error
- 🔴 第307行: [mypy] error
- 🔴 第307行: [mypy] error

### 📄 internal/repository/base.py
- 🔵 第7行: [unused_import] 可能未使用的导入: abstractmethod
- 🔵 第10行: [unused_import] 可能未使用的导入: selectinload
- 🔵 第11行: [unused_import] 可能未使用的导入: and_
- 🔴 第25行: [mypy] error
- 🔴 第42行: [mypy] error
- 🔴 第67行: [mypy] error
- 🔴 第84行: [mypy] error
- 🔴 第86行: [mypy] error
- 🔴 第100行: [mypy] error
- 🔴 第112行: [mypy] error
- 🔴 第123行: [mypy] error

### 📄 internal/repository/biometric_repository.py
- 🔵 第7行: [unused_import] 可能未使用的导入: Dict
- 🔵 第7行: [unused_import] 可能未使用的导入: Any
- 🔴 第22行: [mypy] error
- 🔴 第22行: [mypy] error
- 🔴 第45行: [mypy] error
- 🔴 第46行: [mypy] error
- 🔴 第47行: [mypy] error
- 🔴 第58行: [mypy] error
- 🔴 第59行: [mypy] error
- 🔴 第67行: [mypy] error
- 🔴 第80行: [mypy] error
- 🔴 第81行: [mypy] error
- 🔴 第83行: [mypy] error
- 🔴 第98行: [mypy] error
- 🔴 第99行: [mypy] error
- 🔴 第101行: [mypy] error

### 📄 internal/repository/init_db.py
- 🟡 第31行: [security_check] 密码相关代码需要特别注意
- 🟡 第41行: [security_check] 密码相关代码需要特别注意
- 🟡 第79行: [security_check] 密码相关代码需要特别注意
- 🟡 第85行: [security_check] 密钥相关代码需要特别注意
- 🟡 第132行: [security_check] 令牌相关代码需要特别注意
- 🟡 第135行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第175行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/repository/oauth_repository.py
- 🔴 第8行: [mypy] error
- 🔵 第9行: [unused_import] 可能未使用的导入: Any
- 🔵 第9行: [unused_import] 可能未使用的导入: Tuple
- 🔵 第16行: [unused_import] 可能未使用的导入: UserNotFoundError
- 🟡 第33行: [function_length] 函数 async create_connection 过长 (58 行)
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第38行: [security_check] 令牌相关代码需要特别注意
- 🟡 第48行: [security_check] 令牌相关代码需要特别注意
- 🟡 第49行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第91行: [function_length] 函数 async update_connection 过长 (54 行)
- 🟡 第93行: [security_check] 令牌相关代码需要特别注意
- 🟡 第94行: [security_check] 令牌相关代码需要特别注意
- 🟡 第102行: [security_check] 令牌相关代码需要特别注意
- 🟡 第103行: [security_check] 令牌相关代码需要特别注意
- 🟡 第116行: [security_check] 令牌相关代码需要特别注意
- 🟡 第117行: [security_check] 令牌相关代码需要特别注意
- 🟡 第118行: [security_check] 令牌相关代码需要特别注意
- 🟡 第119行: [security_check] 令牌相关代码需要特别注意
- 🔴 第121行: [mypy] error
- 🔴 第123行: [mypy] error
- 🔴 第129行: [mypy] error
- 🔴 第133行: [mypy] error
- 🔴 第159行: [mypy] error
- 🔴 第182行: [mypy] error
- 🔴 第183行: [mypy] error
- 🔴 第207行: [mypy] error
- 🔴 第208行: [mypy] error
- 🔴 第230行: [mypy] error
- 🔴 第252行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第298行: [mypy] error

### 📄 internal/repository/optimized_user_repository.py
- 🔵 第8行: [unused_import] 可能未使用的导入: joinedload
- 🔵 第13行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第16行: [unused_import] 可能未使用的导入: Permission
- 🔵 第16行: [unused_import] 可能未使用的导入: UserRole
- 🔵 第16行: [unused_import] 可能未使用的导入: AuditLog
- 🔵 第17行: [unused_import] 可能未使用的导入: UserCreate
- 🔵 第17行: [unused_import] 可能未使用的导入: UserUpdate
- 🔵 第17行: [unused_import] 可能未使用的导入: UserResponse
- 🔴 第24行: [mypy] error
- 🔴 第24行: [mypy] error
- 🔴 第24行: [mypy] error
- 🔴 第24行: [mypy] error
- 🔴 第32行: [mypy] error
- 🔴 第41行: [mypy] error
- 🔴 第46行: [mypy] error
- 🔴 第52行: [mypy] error
- 🔴 第58行: [mypy] error
- 🔴 第73行: [mypy] error
- 🔴 第100行: [mypy] error
- 🔴 第103行: [mypy] error
- 🔴 第115行: [mypy] error
- 🔴 第150行: [mypy] error
- 🔴 第151行: [mypy] error
- 🔴 第158行: [mypy] error
- 🔴 第168行: [mypy] error
- 🔴 第170行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第200行: [mypy] error
- 🟡 第204行: [function_length] 函数 async get_login_analytics 过长 (51 行)
- 🔴 第209行: [mypy] error
- 🔴 第211行: [mypy] error
- 🔴 第241行: [mypy] error
- 🔴 第251行: [mypy] error
- 🔴 第267行: [mypy] error
- 🔴 第268行: [mypy] error
- 🔴 第269行: [mypy] error
- 🔴 第272行: [mypy] error
- 🔴 第274行: [mypy] error
- 🔴 第283行: [mypy] error
- 🔴 第284行: [mypy] error
- 🔴 第287行: [mypy] error
- 🔴 第296行: [mypy] error
- 🔴 第300行: [mypy] error
- 🟡 第327行: [security_check] 令牌相关代码需要特别注意
- 🟡 第328行: [security_check] 令牌相关代码需要特别注意
- 🟡 第335行: [security_check] 密钥相关代码需要特别注意
- 🔴 第339行: [mypy] error
- 🔴 第360行: [mypy] error
- 🔴 第360行: [mypy] error
- 🔴 第371行: [mypy] error
- 🔴 第377行: [mypy] error
- 🔴 第381行: [mypy] error
- 🔴 第390行: [mypy] error
- 🔴 第394行: [mypy] error

### 📄 internal/repository/role_repository.py
- 🔵 第7行: [unused_import] 可能未使用的导入: Dict
- 🔵 第7行: [unused_import] 可能未使用的导入: Any
- 🔵 第9行: [unused_import] 可能未使用的导入: AsyncSession
- 🔴 第20行: [mypy] error
- 🔴 第58行: [mypy] error
- 🔴 第87行: [mypy] error
- 🔴 第90行: [mypy] error
- 🔴 第179行: [mypy] error
- 🔴 第254行: [mypy] error

### 📄 internal/repository/token_repository.py
- 🟡 第1行: [file_length] 文件过长 (532 行)，建议拆分
- 🔴 第12行: [mypy] error
- 🔵 第12行: [unused_import] 可能未使用的导入: UTC
- 🔵 第12行: [unused_import] 可能未使用的导入: timedelta
- 🟡 第13行: [security_check] 密钥相关代码需要特别注意
- 🔵 第15行: [unused_import] 可能未使用的导入: AsyncSession
- 🟡 第20行: [security_check] 令牌相关代码需要特别注意
- 🟡 第21行: [security_check] 令牌相关代码需要特别注意
- 🟡 第23行: [security_check] 令牌相关代码需要特别注意
- 🟡 第26行: [security_check] 令牌相关代码需要特别注意
- 🔴 第29行: [mypy] error
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第44行: [security_check] 令牌相关代码需要特别注意
- 🟡 第45行: [security_check] 令牌相关代码需要特别注意
- 🟡 第48行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 令牌相关代码需要特别注意
- 🟡 第55行: [security_check] 令牌相关代码需要特别注意
- 🟡 第67行: [security_check] 令牌相关代码需要特别注意
- 🟡 第68行: [security_check] 令牌相关代码需要特别注意
- 🟡 第69行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第74行: [security_check] 令牌相关代码需要特别注意
- 🟡 第77行: [security_check] 令牌相关代码需要特别注意
- 🟡 第81行: [security_check] 令牌相关代码需要特别注意
- 🟡 第82行: [security_check] 令牌相关代码需要特别注意
- 🟡 第83行: [security_check] 令牌相关代码需要特别注意
- 🟡 第88行: [security_check] 令牌相关代码需要特别注意
- 🟡 第91行: [security_check] 令牌相关代码需要特别注意
- 🟡 第96行: [security_check] 令牌相关代码需要特别注意
- 🟡 第97行: [security_check] 令牌相关代码需要特别注意
- 🟡 第103行: [security_check] 令牌相关代码需要特别注意
- 🟡 第108行: [security_check] 令牌相关代码需要特别注意
- 🟡 第109行: [security_check] 令牌相关代码需要特别注意
- 🟡 第110行: [security_check] 令牌相关代码需要特别注意
- 🟡 第111行: [security_check] 令牌相关代码需要特别注意
- 🟡 第112行: [security_check] 令牌相关代码需要特别注意
- 🟡 第113行: [security_check] 令牌相关代码需要特别注意
- 🟡 第115行: [security_check] 令牌相关代码需要特别注意
- 🟡 第118行: [security_check] 令牌相关代码需要特别注意
- 🟡 第120行: [security_check] 令牌相关代码需要特别注意
- 🟡 第123行: [security_check] 令牌相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🔴 第129行: [mypy] error
- 🔴 第129行: [mypy] error
- 🟡 第131行: [security_check] 令牌相关代码需要特别注意
- 🟡 第135行: [security_check] 令牌相关代码需要特别注意
- 🟡 第138行: [function_length] 函数 async revoke_token 过长 (52 行)
- 🟡 第138行: [security_check] 令牌相关代码需要特别注意
- 🟡 第143行: [security_check] 令牌相关代码需要特别注意
- 🟡 第144行: [security_check] 令牌相关代码需要特别注意
- 🟡 第155行: [security_check] 令牌相关代码需要特别注意
- 🟡 第156行: [security_check] 令牌相关代码需要特别注意
- 🟡 第157行: [security_check] 令牌相关代码需要特别注意
- 🟡 第158行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 令牌相关代码需要特别注意
- 🟡 第160行: [security_check] 令牌相关代码需要特别注意
- 🟡 第162行: [security_check] 令牌相关代码需要特别注意
- 🟡 第165行: [security_check] 令牌相关代码需要特别注意
- 🔴 第168行: [mypy] error
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🔴 第177行: [mypy] error
- 🟡 第180行: [security_check] 令牌相关代码需要特别注意
- 🟡 第181行: [security_check] 令牌相关代码需要特别注意
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🟡 第187行: [security_check] 令牌相关代码需要特别注意
- 🟡 第190行: [security_check] 令牌相关代码需要特别注意
- 🟡 第205行: [security_check] 令牌相关代码需要特别注意
- 🟡 第206行: [security_check] 令牌相关代码需要特别注意
- 🔴 第209行: [mypy] error
- 🟡 第209行: [security_check] 令牌相关代码需要特别注意
- 🟡 第210行: [security_check] 令牌相关代码需要特别注意
- 🟡 第211行: [security_check] 令牌相关代码需要特别注意
- 🟡 第214行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 密码相关代码需要特别注意
- 🟡 第253行: [security_check] 密码相关代码需要特别注意
- 🟡 第282行: [security_check] 密码相关代码需要特别注意
- 🟡 第300行: [function_length] 函数 async rate_limit_check 过长 (65 行)
- 🟡 第306行: [security_check] 密码相关代码需要特别注意
- 🔴 第325行: [mypy] error
- 🟡 第365行: [security_check] 令牌相关代码需要特别注意
- 🟡 第368行: [security_check] 令牌相关代码需要特别注意
- 🟡 第371行: [security_check] 令牌相关代码需要特别注意
- 🟡 第373行: [security_check] 令牌相关代码需要特别注意
- 🟡 第375行: [security_check] 令牌相关代码需要特别注意
- 🟡 第380行: [security_check] 令牌相关代码需要特别注意
- 🟡 第382行: [security_check] 令牌相关代码需要特别注意
- 🟡 第386行: [security_check] 令牌相关代码需要特别注意
- 🟡 第390行: [security_check] 令牌相关代码需要特别注意
- 🟡 第394行: [security_check] 令牌相关代码需要特别注意
- 🟡 第397行: [security_check] 令牌相关代码需要特别注意
- 🟡 第403行: [security_check] 令牌相关代码需要特别注意
- 🔴 第404行: [mypy] error
- 🟡 第404行: [security_check] 令牌相关代码需要特别注意
- 🟡 第408行: [security_check] 令牌相关代码需要特别注意
- 🟡 第411行: [security_check] 令牌相关代码需要特别注意
- 🟡 第414行: [security_check] 令牌相关代码需要特别注意
- 🟡 第416行: [security_check] 令牌相关代码需要特别注意
- 🔴 第417行: [mypy] error
- 🟡 第417行: [security_check] 令牌相关代码需要特别注意
- 🟡 第421行: [security_check] 令牌相关代码需要特别注意
- 🟡 第422行: [security_check] 令牌相关代码需要特别注意
- 🟡 第425行: [security_check] 令牌相关代码需要特别注意
- 🟡 第429行: [security_check] 令牌相关代码需要特别注意
- 🔴 第430行: [mypy] error
- 🟡 第430行: [security_check] 令牌相关代码需要特别注意
- 🟡 第438行: [security_check] 令牌相关代码需要特别注意
- 🟡 第442行: [security_check] 令牌相关代码需要特别注意
- 🟡 第444行: [security_check] 令牌相关代码需要特别注意
- 🟡 第445行: [security_check] 令牌相关代码需要特别注意
- 🔴 第446行: [mypy] error
- 🟡 第446行: [security_check] 令牌相关代码需要特别注意
- 🟡 第452行: [security_check] 令牌相关代码需要特别注意
- 🟡 第457行: [security_check] 令牌相关代码需要特别注意
- 🟡 第459行: [security_check] 令牌相关代码需要特别注意
- 🔴 第460行: [mypy] error
- 🟡 第460行: [security_check] 令牌相关代码需要特别注意
- 🟡 第467行: [function_length] 函数 async get_token_stats 过长 (52 行)
- 🟡 第467行: [security_check] 令牌相关代码需要特别注意
- 🟡 第473行: [security_check] 令牌相关代码需要特别注意
- 🟡 第475行: [security_check] 令牌相关代码需要特别注意
- 🟡 第488行: [security_check] 令牌相关代码需要特别注意
- 🔴 第489行: [mypy] error
- 🟡 第489行: [security_check] 令牌相关代码需要特别注意
- 🟡 第499行: [security_check] 令牌相关代码需要特别注意
- 🔴 第507行: [mypy] error
- 🟡 第507行: [security_check] 令牌相关代码需要特别注意
- 🔴 第513行: [mypy] error
- 🔴 第514行: [mypy] error
- 🔴 第515行: [mypy] error
- 🔴 第516行: [mypy] error
- 🟡 第519行: [security_check] 令牌相关代码需要特别注意
- 🟡 第523行: [security_check] 令牌相关代码需要特别注意
- 🟡 第525行: [security_check] 令牌相关代码需要特别注意
- 🟡 第527行: [security_check] 令牌相关代码需要特别注意
- 🔴 第528行: [mypy] error
- 🟡 第528行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/repository/user_repository.py
- 🟡 第1行: [file_length] 文件过长 (1015 行)，建议拆分
- 🔴 第10行: [mypy] error
- 🔵 第15行: [unused_import] 可能未使用的导入: AsyncEngine
- 🟡 第33行: [function_length] 函数 async create_user 过长 (73 行)
- 🟡 第33行: [security_check] 密码相关代码需要特别注意
- 🟡 第42行: [security_check] 密码相关代码需要特别注意
- 🟡 第80行: [security_check] 密码相关代码需要特别注意
- 🟡 第84行: [security_check] 密码相关代码需要特别注意
- 🟡 第124行: [security_check] 密码相关代码需要特别注意
- 🟡 第125行: [security_check] 密钥相关代码需要特别注意
- 🟡 第163行: [security_check] 密码相关代码需要特别注意
- 🟡 第164行: [security_check] 密钥相关代码需要特别注意
- 🟡 第202行: [security_check] 密码相关代码需要特别注意
- 🟡 第203行: [security_check] 密钥相关代码需要特别注意
- 🟡 第241行: [security_check] 密码相关代码需要特别注意
- 🟡 第242行: [security_check] 密钥相关代码需要特别注意
- 🟡 第262行: [security_check] 密码相关代码需要特别注意
- 🟡 第268行: [security_check] 密码相关代码需要特别注意
- 🟡 第282行: [security_check] 密码相关代码需要特别注意
- 🟡 第285行: [security_check] 密码相关代码需要特别注意
- 🟡 第338行: [security_check] 密钥相关代码需要特别注意
- 🟡 第345行: [security_check] 密钥相关代码需要特别注意
- 🟡 第367行: [security_check] 密钥相关代码需要特别注意
- 🟡 第370行: [security_check] 密钥相关代码需要特别注意
- 🟡 第381行: [security_check] 密钥相关代码需要特别注意
- 🟡 第389行: [security_check] 密钥相关代码需要特别注意
- 🟡 第415行: [security_check] 密钥相关代码需要特别注意
- 🟡 第419行: [security_check] 密钥相关代码需要特别注意
- 🟡 第449行: [security_check] 密钥相关代码需要特别注意
- 🟡 第467行: [function_length] 函数 async update_user_profile 过长 (55 行)
- 🟡 第522行: [function_length] 函数 async update_user_email 过长 (52 行)
- 🟡 第574行: [function_length] 函数 async lock_user_account 过长 (53 行)
- 🟡 第669行: [function_length] 函数 async assign_role_to_user 过长 (65 行)
- 🟡 第778行: [function_length] 函数 async get_user_permissions 过长 (55 行)
- 🟡 第833行: [function_length] 函数 async check_user_has_permission 过长 (53 行)
- 🟡 第886行: [function_length] 函数 async get_user_roles 过长 (64 行)

### 📄 internal/repository/user_repository_new.py
- 🔵 第7行: [unused_import] 可能未使用的导入: Dict
- 🔵 第7行: [unused_import] 可能未使用的导入: Any
- 🔵 第9行: [unused_import] 可能未使用的导入: AsyncSession
- 🔴 第21行: [mypy] error
- 🔴 第123行: [mypy] error
- 🔴 第128行: [mypy] error
- 🔴 第155行: [mypy] error

### 📄 internal/resilience/circuit_breaker.py
- 🔵 第13行: [unused_import] 可能未使用的导入: Union
- 🔵 第13行: [unused_import] 可能未使用的导入: cast
- 🔴 第57行: [mypy] error
- 🔴 第58行: [mypy] error
- 🔴 第181行: [mypy] error
- 🔴 第194行: [mypy] error
- 🔴 第203行: [mypy] error
- 🔴 第304行: [mypy] error
- 🔴 第349行: [mypy] error
- 🔴 第350行: [mypy] error

### 📄 internal/resilience/retry.py
- 🔵 第12行: [unused_import] 可能未使用的导入: Union
- 🔵 第12行: [unused_import] 可能未使用的导入: cast
- 🔴 第41行: [mypy] error
- 🔴 第42行: [mypy] error
- 🟡 第138行: [function_length] 函数 async call_async 过长 (72 行)
- 🔴 第218行: [mypy] error
- 🔴 第219行: [mypy] error

### 📄 internal/schemas/__init__.py
- 🔵 第4行: [unused_import] 可能未使用的导入: (
- 🟡 第5行: [security_check] 令牌相关代码需要特别注意
- 🟡 第6行: [security_check] 密码相关代码需要特别注意

### 📄 internal/schemas/auth.py
- 🟡 第10行: [security_check] 令牌相关代码需要特别注意
- 🟡 第14行: [security_check] 令牌相关代码需要特别注意
- 🟡 第15行: [security_check] 令牌相关代码需要特别注意
- 🟡 第16行: [security_check] 令牌相关代码需要特别注意
- 🟡 第26行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 令牌相关代码需要特别注意
- 🟡 第39行: [security_check] 令牌相关代码需要特别注意
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第52行: [security_check] 密码相关代码需要特别注意
- 🟡 第57行: [security_check] 密码相关代码需要特别注意
- 🟡 第61行: [security_check] 令牌相关代码需要特别注意
- 🟡 第62行: [security_check] 密码相关代码需要特别注意
- 🟡 第76行: [security_check] 令牌相关代码需要特别注意
- 🟡 第77行: [security_check] 令牌相关代码需要特别注意
- 🟡 第78行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/security/advanced_security.py
- 🟡 第1行: [file_length] 文件过长 (646 行)，建议拆分
- 🔵 第21行: [unused_import] 可能未使用的导入: Fernet
- 🟡 第23行: [security_check] 密钥相关代码需要特别注意
- 🔴 第86行: [mypy] error
- 🔴 第87行: [mypy] error
- 🟡 第93行: [function_length] 函数 __init__ 过长 (71 行)
- 🟡 第113行: [security_check] 密码相关代码需要特别注意
- 🔴 第164行: [mypy] error
- 🔴 第180行: [mypy] error
- 🔴 第259行: [mypy] error
- 🔴 第502行: [mypy] error
- 🔴 第508行: [mypy] error
- 🔴 第512行: [mypy] error
- 🔴 第516行: [mypy] error
- 🔴 第522行: [mypy] error
- 🔴 第541行: [mypy] error
- 🔴 第551行: [mypy] error
- 🔴 第565行: [mypy] error
- 🔴 第597行: [mypy] error
- 🔴 第600行: [mypy] error
- 🔴 第602行: [mypy] error
- 🔴 第605行: [mypy] error
- 🔴 第607行: [mypy] error
- 🔴 第610行: [mypy] error
- 🔴 第612行: [mypy] error
- 🔴 第615行: [mypy] error
- 🔴 第631行: [mypy] error
- 🔴 第632行: [mypy] error

### 📄 internal/security/jwt.py
- 🔴 第10行: [mypy] error
- 🟡 第25行: [security_check] 密钥相关代码需要特别注意
- 🟡 第27行: [security_check] 令牌相关代码需要特别注意
- 🟡 第28行: [security_check] 令牌相关代码需要特别注意
- 🟡 第34行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第42行: [security_check] 密钥相关代码需要特别注意
- 🟡 第45行: [security_check] 密钥相关代码需要特别注意
- 🟡 第47行: [security_check] 令牌相关代码需要特别注意
- 🟡 第48行: [security_check] 令牌相关代码需要特别注意
- 🟡 第50行: [security_check] 令牌相关代码需要特别注意
- 🟡 第68行: [security_check] 令牌相关代码需要特别注意
- 🟡 第83行: [security_check] 密钥相关代码需要特别注意
- 🟡 第85行: [security_check] 令牌相关代码需要特别注意
- 🟡 第101行: [security_check] 令牌相关代码需要特别注意
- 🟡 第113行: [security_check] 密钥相关代码需要特别注意
- 🟡 第115行: [security_check] 令牌相关代码需要特别注意
- 🟡 第120行: [security_check] 令牌相关代码需要特别注意
- 🟡 第129行: [security_check] 密钥相关代码需要特别注意
- 🟡 第129行: [security_check] 令牌相关代码需要特别注意
- 🔴 第135行: [mypy] error
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第151行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 令牌相关代码需要特别注意
- 🟡 第167行: [security_check] 令牌相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🔴 第183行: [mypy] error
- 🟡 第187行: [security_check] 令牌相关代码需要特别注意
- 🔴 第189行: [mypy] error
- 🟡 第189行: [security_check] 密钥相关代码需要特别注意
- 🟡 第197行: [security_check] 密钥相关代码需要特别注意
- 🟡 第206行: [security_check] 密钥相关代码需要特别注意
- 🔴 第207行: [mypy] error
- 🟡 第207行: [security_check] 密钥相关代码需要特别注意
- 🟡 第208行: [security_check] 密钥相关代码需要特别注意
- 🟡 第212行: [security_check] 令牌相关代码需要特别注意
- 🟡 第214行: [security_check] 密钥相关代码需要特别注意
- 🟡 第225行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 令牌相关代码需要特别注意
- 🔴 第230行: [mypy] error
- 🟡 第230行: [security_check] 密钥相关代码需要特别注意
- 🟡 第238行: [security_check] 密钥相关代码需要特别注意
- 🟡 第247行: [security_check] 密钥相关代码需要特别注意
- 🔴 第248行: [mypy] error
- 🟡 第248行: [security_check] 密钥相关代码需要特别注意
- 🟡 第249行: [security_check] 密钥相关代码需要特别注意
- 🟡 第253行: [security_check] 令牌相关代码需要特别注意
- 🟡 第255行: [security_check] 密钥相关代码需要特别注意
- 🟡 第261行: [security_check] 令牌相关代码需要特别注意
- 🔴 第264行: [mypy] error
- 🟡 第264行: [security_check] 密钥相关代码需要特别注意
- 🟡 第264行: [security_check] 令牌相关代码需要特别注意
- 🟡 第269行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 密钥相关代码需要特别注意
- 🟡 第276行: [security_check] 令牌相关代码需要特别注意
- 🟡 第279行: [security_check] 密钥相关代码需要特别注意
- 🔴 第280行: [mypy] error
- 🟡 第280行: [security_check] 密钥相关代码需要特别注意
- 🟡 第281行: [security_check] 密钥相关代码需要特别注意
- 🟡 第284行: [security_check] 密钥相关代码需要特别注意
- 🟡 第287行: [security_check] 令牌相关代码需要特别注意
- 🟡 第290行: [security_check] 令牌相关代码需要特别注意
- 🟡 第291行: [security_check] 令牌相关代码需要特别注意
- 🟡 第294行: [security_check] 令牌相关代码需要特别注意
- 🔴 第297行: [mypy] error
- 🔴 第298行: [mypy] error
- 🔴 第299行: [mypy] error
- 🟡 第299行: [security_check] 密钥相关代码需要特别注意
- 🔴 第300行: [mypy] error
- 🟡 第300行: [security_check] 令牌相关代码需要特别注意
- 🔴 第301行: [mypy] error
- 🟡 第301行: [security_check] 令牌相关代码需要特别注意
- 🟡 第311行: [security_check] 密钥相关代码需要特别注意
- 🟡 第312行: [security_check] 令牌相关代码需要特别注意
- 🟡 第313行: [security_check] 令牌相关代码需要特别注意
- 🟡 第318行: [security_check] 密钥相关代码需要特别注意
- 🔴 第319行: [mypy] error
- 🟡 第319行: [security_check] 密钥相关代码需要特别注意
- 🟡 第320行: [security_check] 密钥相关代码需要特别注意
- 🟡 第323行: [security_check] 令牌相关代码需要特别注意
- 🟡 第324行: [security_check] 令牌相关代码需要特别注意
- 🟡 第326行: [security_check] 令牌相关代码需要特别注意
- 🟡 第327行: [security_check] 令牌相关代码需要特别注意
- 🟡 第330行: [security_check] 密钥相关代码需要特别注意
- 🟡 第331行: [security_check] 令牌相关代码需要特别注意
- 🟡 第332行: [security_check] 令牌相关代码需要特别注意
- 🔴 第341行: [mypy] error
- 🔴 第344行: [mypy] error
- 🟡 第346行: [security_check] 令牌相关代码需要特别注意
- 🟡 第352行: [security_check] 令牌相关代码需要特别注意
- 🟡 第355行: [security_check] 令牌相关代码需要特别注意
- 🟡 第357行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/security/jwt_manager.py
- 🔴 第21行: [mypy] error
- 🔴 第31行: [mypy] error
- 🔴 第50行: [mypy] error
- 🟡 第60行: [security_check] 密码相关代码需要特别注意
- 🔴 第80行: [mypy] error
- 🟡 第88行: [security_check] 密码相关代码需要特别注意
- 🔴 第106行: [mypy] error
- 🔴 第142行: [mypy] error
- 🔴 第145行: [mypy] error
- 🟡 第145行: [security_check] 密钥相关代码需要特别注意
- 🔴 第150行: [mypy] error
- 🔴 第153行: [mypy] error
- 🟡 第153行: [security_check] 密钥相关代码需要特别注意
- 🔴 第167行: [mypy] error
- 🔴 第172行: [mypy] error
- 🔴 第176行: [mypy] error
- 🔴 第202行: [mypy] error
- 🔴 第213行: [mypy] error
- 🟡 第216行: [security_check] 令牌相关代码需要特别注意
- 🟡 第220行: [security_check] 密钥相关代码需要特别注意
- 🟡 第226行: [security_check] 令牌相关代码需要特别注意
- 🟡 第231行: [security_check] 令牌相关代码需要特别注意
- 🟡 第235行: [security_check] 令牌相关代码需要特别注意
- 🟡 第242行: [security_check] 令牌相关代码需要特别注意
- 🟡 第247行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [security_check] 密钥相关代码需要特别注意
- 🟡 第249行: [security_check] 令牌相关代码需要特别注意
- 🟡 第252行: [security_check] 令牌相关代码需要特别注意
- 🟡 第259行: [security_check] 令牌相关代码需要特别注意
- 🟡 第260行: [security_check] 令牌相关代码需要特别注意
- 🟡 第261行: [security_check] 令牌相关代码需要特别注意
- 🟡 第262行: [security_check] 令牌相关代码需要特别注意
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第274行: [security_check] 令牌相关代码需要特别注意
- 🔴 第279行: [mypy] error
- 🟡 第281行: [security_check] 令牌相关代码需要特别注意
- 🟡 第282行: [security_check] 令牌相关代码需要特别注意
- 🟡 第283行: [security_check] 令牌相关代码需要特别注意
- 🟡 第284行: [security_check] 令牌相关代码需要特别注意
- 🟡 第285行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/security/mfa.py
- 🔵 第13行: [unused_import] 可能未使用的导入: Tuple
- 🔵 第17行: [unused_import] 可能未使用的导入: PilImage
- 🔵 第19行: [unused_import] 可能未使用的导入: InvalidVerificationCodeError
- 🟡 第25行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 密钥相关代码需要特别注意
- 🟡 第41行: [security_check] 密钥相关代码需要特别注意
- 🟡 第49行: [security_check] 密钥相关代码需要特别注意
- 🟡 第72行: [security_check] 密钥相关代码需要特别注意
- 🟡 第77行: [security_check] 密钥相关代码需要特别注意
- 🟡 第84行: [security_check] 密钥相关代码需要特别注意
- 🟡 第124行: [security_check] 密钥相关代码需要特别注意
- 🟡 第127行: [security_check] 密钥相关代码需要特别注意
- 🟡 第131行: [security_check] 密钥相关代码需要特别注意
- 🟡 第136行: [security_check] 密钥相关代码需要特别注意
- 🟡 第140行: [security_check] 密钥相关代码需要特别注意
- 🟡 第146行: [security_check] 密钥相关代码需要特别注意
- 🟡 第152行: [security_check] 密钥相关代码需要特别注意
- 🟡 第165行: [security_check] 密钥相关代码需要特别注意

### 📄 internal/security/password.py
- 🟡 第9行: [security_check] 密钥相关代码需要特别注意
- 🟡 第16行: [security_check] 密码相关代码需要特别注意
- 🟡 第22行: [security_check] 密码相关代码需要特别注意
- 🟡 第27行: [security_check] 密码相关代码需要特别注意
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🔴 第38行: [mypy] error
- 🟡 第38行: [security_check] 密码相关代码需要特别注意
- 🟡 第42行: [security_check] 密码相关代码需要特别注意
- 🟡 第44行: [security_check] 密码相关代码需要特别注意
- 🟡 第47行: [security_check] 密码相关代码需要特别注意
- 🟡 第52行: [security_check] 密码相关代码需要特别注意
- 🟡 第55行: [security_check] 密码相关代码需要特别注意
- 🟡 第60行: [security_check] 密码相关代码需要特别注意
- 🟡 第61行: [security_check] 密码相关代码需要特别注意
- 🔴 第66行: [mypy] error
- 🟡 第66行: [security_check] 密码相关代码需要特别注意
- 🟡 第69行: [security_check] 密码相关代码需要特别注意
- 🟡 第74行: [security_check] 密码相关代码需要特别注意
- 🟡 第91行: [security_check] 密码相关代码需要特别注意
- 🟡 第95行: [security_check] 密码相关代码需要特别注意
- 🟡 第99行: [security_check] 密码相关代码需要特别注意
- 🟡 第103行: [security_check] 密码相关代码需要特别注意
- 🟡 第107行: [security_check] 密码相关代码需要特别注意
- 🟡 第114行: [security_check] 密码相关代码需要特别注意
- 🟡 第119行: [security_check] 密码相关代码需要特别注意
- 🟡 第123行: [security_check] 密码相关代码需要特别注意
- 🟡 第128行: [security_check] 密码相关代码需要特别注意
- 🟡 第130行: [security_check] 密码相关代码需要特别注意
- 🟡 第133行: [security_check] 密码相关代码需要特别注意
- 🟡 第154行: [security_check] 密码相关代码需要特别注意
- 🟡 第155行: [security_check] 密钥相关代码需要特别注意
- 🟡 第156行: [security_check] 密钥相关代码需要特别注意
- 🟡 第157行: [security_check] 密钥相关代码需要特别注意
- 🟡 第158行: [security_check] 密钥相关代码需要特别注意
- 🟡 第163行: [security_check] 密码相关代码需要特别注意
- 🟡 第163行: [security_check] 密钥相关代码需要特别注意
- 🟡 第166行: [security_check] 密码相关代码需要特别注意
- 🟡 第166行: [security_check] 密钥相关代码需要特别注意
- 🟡 第168行: [security_check] 密码相关代码需要特别注意
- 🟡 第171行: [security_check] 密码相关代码需要特别注意
- 🟡 第186行: [security_check] 密码相关代码需要特别注意
- 🟡 第191行: [security_check] 密码相关代码需要特别注意
- 🟡 第198行: [security_check] 密码相关代码需要特别注意
- 🟡 第200行: [security_check] 密码相关代码需要特别注意
- 🟡 第202行: [security_check] 密码相关代码需要特别注意
- 🟡 第207行: [security_check] 密码相关代码需要特别注意
- 🟡 第208行: [security_check] 密码相关代码需要特别注意
- 🟡 第213行: [security_check] 密码相关代码需要特别注意
- 🟡 第215行: [security_check] 密码相关代码需要特别注意
- 🟡 第220行: [security_check] 密码相关代码需要特别注意
- 🟡 第225行: [security_check] 密码相关代码需要特别注意
- 🟡 第227行: [security_check] 密码相关代码需要特别注意
- 🟡 第237行: [security_check] 密码相关代码需要特别注意
- 🟡 第240行: [security_check] 密码相关代码需要特别注意
- 🟡 第241行: [security_check] 密码相关代码需要特别注意
- 🟡 第247行: [security_check] 密码相关代码需要特别注意
- 🟡 第252行: [security_check] 密码相关代码需要特别注意
- 🟡 第257行: [security_check] 密码相关代码需要特别注意
- 🟡 第259行: [security_check] 密码相关代码需要特别注意
- 🟡 第264行: [security_check] 密码相关代码需要特别注意
- 🟡 第265行: [security_check] 密码相关代码需要特别注意
- 🟡 第270行: [security_check] 密码相关代码需要特别注意
- 🟡 第273行: [security_check] 密码相关代码需要特别注意
- 🟡 第278行: [security_check] 密码相关代码需要特别注意
- 🟡 第291行: [security_check] 密码相关代码需要特别注意
- 🟡 第294行: [security_check] 密码相关代码需要特别注意
- 🟡 第304行: [security_check] 密码相关代码需要特别注意

### 📄 internal/service/audit_service.py
- 🔴 第50行: [mypy] error
- 🔴 第54行: [mypy] error
- 🟡 第98行: [security_check] 密码相关代码需要特别注意
- 🔴 第104行: [mypy] error
- 🔴 第123行: [mypy] error
- 🔴 第127行: [mypy] error

### 📄 internal/service/auth_service.py
- 🟡 第1行: [file_length] 文件过长 (590 行)，建议拆分
- 🟡 第9行: [security_check] 密钥相关代码需要特别注意
- 🔵 第12行: [unused_import] 可能未使用的导入: Optional
- 🟡 第16行: [security_check] 密码相关代码需要特别注意
- 🟡 第21行: [security_check] 密码相关代码需要特别注意
- 🔵 第27行: [unused_import] 可能未使用的导入: InputValidator
- 🔴 第28行: [mypy] error
- 🔴 第28行: [mypy] error
- 🔴 第28行: [mypy] error
- 🟡 第30行: [security_check] 令牌相关代码需要特别注意
- 🟡 第31行: [security_check] 令牌相关代码需要特别注意
- 🟡 第32行: [security_check] 令牌相关代码需要特别注意
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🟡 第49行: [security_check] 密码相关代码需要特别注意
- 🟡 第49行: [security_check] 令牌相关代码需要特别注意
- 🟡 第55行: [function_length] 函数 async authenticate_user 过长 (96 行)
- 🟡 第55行: [security_check] 密码相关代码需要特别注意
- 🟡 第61行: [security_check] 密码相关代码需要特别注意
- 🟡 第69行: [security_check] 密码相关代码需要特别注意
- 🟡 第73行: [security_check] 密码相关代码需要特别注意
- 🟡 第75行: [security_check] 密码相关代码需要特别注意
- 🟡 第82行: [security_check] 密码相关代码需要特别注意
- 🔴 第120行: [mypy] error
- 🟡 第120行: [security_check] 密码相关代码需要特别注意
- 🟡 第130行: [security_check] 密码相关代码需要特别注意
- 🟡 第143行: [security_check] 密码相关代码需要特别注意
- 🟡 第151行: [function_length] 函数 async create_tokens 过长 (62 行)
- 🟡 第151行: [security_check] 令牌相关代码需要特别注意
- 🟡 第162行: [security_check] 令牌相关代码需要特别注意
- 🟡 第168行: [security_check] 令牌相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意
- 🟡 第178行: [security_check] 令牌相关代码需要特别注意
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🟡 第183行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 密钥相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第191行: [security_check] 令牌相关代码需要特别注意
- 🟡 第196行: [security_check] 令牌相关代码需要特别注意
- 🟡 第197行: [security_check] 令牌相关代码需要特别注意
- 🟡 第198行: [security_check] 令牌相关代码需要特别注意
- 🟡 第199行: [security_check] 令牌相关代码需要特别注意
- 🟡 第200行: [security_check] 令牌相关代码需要特别注意
- 🟡 第207行: [security_check] 令牌相关代码需要特别注意
- 🟡 第210行: [security_check] 令牌相关代码需要特别注意
- 🟡 第213行: [security_check] 令牌相关代码需要特别注意
- 🟡 第225行: [security_check] 令牌相关代码需要特别注意
- 🟡 第242行: [security_check] 令牌相关代码需要特别注意
- 🟡 第245行: [security_check] 令牌相关代码需要特别注意
- 🟡 第248行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [security_check] 令牌相关代码需要特别注意
- 🟡 第256行: [security_check] 令牌相关代码需要特别注意
- 🟡 第263行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 令牌相关代码需要特别注意
- 🟡 第275行: [security_check] 令牌相关代码需要特别注意
- 🟡 第277行: [security_check] 令牌相关代码需要特别注意
- 🟡 第278行: [security_check] 令牌相关代码需要特别注意
- 🔴 第281行: [mypy] error
- 🟡 第286行: [security_check] 令牌相关代码需要特别注意
- 🟡 第290行: [security_check] 令牌相关代码需要特别注意
- 🟡 第291行: [security_check] 令牌相关代码需要特别注意
- 🟡 第293行: [security_check] 令牌相关代码需要特别注意
- 🟡 第294行: [security_check] 令牌相关代码需要特别注意
- 🟡 第299行: [security_check] 令牌相关代码需要特别注意
- 🔴 第302行: [mypy] error
- 🟡 第302行: [security_check] 令牌相关代码需要特别注意
- 🟡 第308行: [security_check] 令牌相关代码需要特别注意
- 🟡 第314行: [security_check] 令牌相关代码需要特别注意
- 🟡 第315行: [security_check] 令牌相关代码需要特别注意
- 🟡 第325行: [security_check] 令牌相关代码需要特别注意
- 🟡 第330行: [security_check] 令牌相关代码需要特别注意
- 🟡 第337行: [security_check] 令牌相关代码需要特别注意
- 🟡 第344行: [security_check] 令牌相关代码需要特别注意
- 🟡 第349行: [security_check] 令牌相关代码需要特别注意
- 🟡 第351行: [security_check] 令牌相关代码需要特别注意
- 🟡 第352行: [security_check] 令牌相关代码需要特别注意
- 🔴 第355行: [mypy] error
- 🟡 第357行: [security_check] 令牌相关代码需要特别注意
- 🟡 第360行: [security_check] 令牌相关代码需要特别注意
- 🔴 第362行: [mypy] error
- 🟡 第366行: [security_check] 令牌相关代码需要特别注意
- 🟡 第367行: [security_check] 令牌相关代码需要特别注意
- 🟡 第369行: [security_check] 令牌相关代码需要特别注意
- 🟡 第372行: [security_check] 令牌相关代码需要特别注意
- 🟡 第376行: [security_check] 令牌相关代码需要特别注意
- 🟡 第383行: [security_check] 令牌相关代码需要特别注意
- 🟡 第393行: [security_check] 令牌相关代码需要特别注意
- 🟡 第395行: [security_check] 令牌相关代码需要特别注意
- 🔴 第410行: [mypy] error
- 🟡 第410行: [security_check] 密码相关代码需要特别注意
- 🔴 第433行: [mypy] error
- 🟡 第440行: [security_check] 密钥相关代码需要特别注意
- 🟡 第440行: [security_check] 令牌相关代码需要特别注意
- 🔴 第444行: [mypy] error
- 🟡 第444行: [security_check] 密码相关代码需要特别注意
- 🟡 第444行: [security_check] 令牌相关代码需要特别注意
- 🟡 第447行: [security_check] 密码相关代码需要特别注意
- 🟡 第447行: [security_check] 令牌相关代码需要特别注意
- 🟡 第448行: [security_check] 密码相关代码需要特别注意
- 🟡 第452行: [security_check] 令牌相关代码需要特别注意
- 🟡 第463行: [security_check] 密码相关代码需要特别注意
- 🟡 第464行: [security_check] 令牌相关代码需要特别注意
- 🟡 第465行: [security_check] 密码相关代码需要特别注意
- 🟡 第467行: [security_check] 密码相关代码需要特别注意
- 🟡 第473行: [security_check] 令牌相关代码需要特别注意
- 🟡 第474行: [security_check] 密码相关代码需要特别注意
- 🟡 第476行: [security_check] 密码相关代码需要特别注意
- 🔴 第488行: [mypy] error
- 🟡 第488行: [security_check] 令牌相关代码需要特别注意
- 🟡 第493行: [security_check] 令牌相关代码需要特别注意
- 🔴 第497行: [mypy] error
- 🟡 第497行: [security_check] 密码相关代码需要特别注意
- 🟡 第501行: [security_check] 密码相关代码需要特别注意
- 🟡 第502行: [security_check] 密码相关代码需要特别注意
- 🔴 第505行: [mypy] error
- 🟡 第505行: [security_check] 密码相关代码需要特别注意
- 🟡 第505行: [security_check] 令牌相关代码需要特别注意
- 🔴 第517行: [mypy] error
- 🔴 第536行: [mypy] error
- 🔴 第538行: [mypy] error
- 🔴 第540行: [mypy] error
- 🔴 第551行: [mypy] error
- 🔴 第566行: [mypy] error
- 🔴 第572行: [mypy] error

### 📄 internal/service/auth_service_complete.py
- 🟡 第1行: [file_length] 文件过长 (805 行)，建议拆分
- 🟡 第9行: [security_check] 密钥相关代码需要特别注意
- 🟡 第17行: [security_check] 密码相关代码需要特别注意
- 🟡 第24行: [security_check] 令牌相关代码需要特别注意
- 🟡 第26行: [security_check] 密码相关代码需要特别注意
- 🟡 第34行: [security_check] 密码相关代码需要特别注意
- 🟡 第34行: [security_check] 令牌相关代码需要特别注意
- 🔴 第40行: [mypy] error
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第47行: [security_check] 密码相关代码需要特别注意
- 🟡 第51行: [security_check] 令牌相关代码需要特别注意
- 🟡 第55行: [security_check] 密码相关代码需要特别注意
- 🔴 第58行: [mypy] error
- 🟡 第58行: [security_check] 密码相关代码需要特别注意
- 🟡 第64行: [security_check] 密码相关代码需要特别注意
- 🔴 第74行: [mypy] error
- 🟡 第85行: [security_check] 密码相关代码需要特别注意
- 🔴 第90行: [mypy] error
- 🔴 第101行: [mypy] error
- 🔴 第108行: [mypy] error
- 🟡 第108行: [function_length] 函数 async create_tokens 过长 (65 行)
- 🟡 第108行: [security_check] 令牌相关代码需要特别注意
- 🟡 第123行: [security_check] 令牌相关代码需要特别注意
- 🟡 第124行: [security_check] 令牌相关代码需要特别注意
- 🟡 第132行: [security_check] 令牌相关代码需要特别注意
- 🟡 第136行: [security_check] 令牌相关代码需要特别注意
- 🟡 第137行: [security_check] 令牌相关代码需要特别注意
- 🟡 第141行: [security_check] 令牌相关代码需要特别注意
- 🟡 第143行: [security_check] 令牌相关代码需要特别注意
- 🟡 第147行: [security_check] 令牌相关代码需要特别注意
- 🟡 第149行: [security_check] 令牌相关代码需要特别注意
- 🟡 第150行: [security_check] 令牌相关代码需要特别注意
- 🟡 第155行: [security_check] 令牌相关代码需要特别注意
- 🟡 第156行: [security_check] 令牌相关代码需要特别注意
- 🟡 第157行: [security_check] 令牌相关代码需要特别注意
- 🟡 第158行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 令牌相关代码需要特别注意
- 🟡 第173行: [security_check] 令牌相关代码需要特别注意
- 🟡 第192行: [security_check] 密钥相关代码需要特别注意
- 🔴 第195行: [mypy] error
- 🟡 第195行: [function_length] 函数 async refresh_tokens 过长 (57 行)
- 🟡 第195行: [security_check] 令牌相关代码需要特别注意
- 🟡 第200行: [security_check] 令牌相关代码需要特别注意
- 🟡 第214行: [security_check] 令牌相关代码需要特别注意
- 🟡 第215行: [security_check] 密钥相关代码需要特别注意
- 🟡 第220行: [security_check] 令牌相关代码需要特别注意
- 🟡 第223行: [security_check] 令牌相关代码需要特别注意
- 🔴 第227行: [mypy] error
- 🟡 第227行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 令牌相关代码需要特别注意
- 🔴 第232行: [mypy] error
- 🔴 第237行: [mypy] error
- 🟡 第237行: [security_check] 令牌相关代码需要特别注意
- 🔴 第240行: [mypy] error
- 🟡 第240行: [security_check] 令牌相关代码需要特别注意
- 🔴 第252行: [mypy] error
- 🟡 第252行: [security_check] 令牌相关代码需要特别注意
- 🟡 第258行: [security_check] 令牌相关代码需要特别注意
- 🟡 第264行: [security_check] 令牌相关代码需要特别注意
- 🔴 第265行: [mypy] error
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第268行: [security_check] 令牌相关代码需要特别注意
- 🔴 第271行: [mypy] error
- 🟡 第282行: [security_check] 令牌相关代码需要特别注意
- 🟡 第287行: [security_check] 令牌相关代码需要特别注意
- 🟡 第298行: [security_check] 令牌相关代码需要特别注意
- 🟡 第299行: [security_check] 密钥相关代码需要特别注意
- 🟡 第304行: [security_check] 令牌相关代码需要特别注意
- 🟡 第306行: [security_check] 令牌相关代码需要特别注意
- 🔴 第310行: [mypy] error
- 🔴 第314行: [mypy] error
- 🟡 第325行: [security_check] 令牌相关代码需要特别注意
- 🟡 第330行: [security_check] 令牌相关代码需要特别注意
- 🟡 第339行: [security_check] 令牌相关代码需要特别注意
- 🔴 第347行: [mypy] error
- 🟡 第347行: [security_check] 密码相关代码需要特别注意
- 🟡 第366行: [security_check] 密钥相关代码需要特别注意
- 🟡 第366行: [security_check] 令牌相关代码需要特别注意
- 🟡 第372行: [security_check] 密码相关代码需要特别注意
- 🟡 第372行: [security_check] 令牌相关代码需要特别注意
- 🔴 第378行: [mypy] error
- 🟡 第378行: [security_check] 密码相关代码需要特别注意
- 🟡 第381行: [security_check] 令牌相关代码需要特别注意
- 🔴 第385行: [mypy] error
- 🟡 第387行: [security_check] 密码相关代码需要特别注意
- 🔴 第397行: [mypy] error
- 🟡 第397行: [function_length] 函数 async reset_password 过长 (60 行)
- 🟡 第397行: [security_check] 密码相关代码需要特别注意
- 🟡 第397行: [security_check] 令牌相关代码需要特别注意
- 🟡 第402行: [security_check] 令牌相关代码需要特别注意
- 🟡 第403行: [security_check] 密码相关代码需要特别注意
- 🟡 第413行: [security_check] 密码相关代码需要特别注意
- 🟡 第413行: [security_check] 令牌相关代码需要特别注意
- 🔴 第420行: [mypy] error
- 🔴 第425行: [mypy] error
- 🟡 第425行: [security_check] 密码相关代码需要特别注意
- 🟡 第429行: [security_check] 密码相关代码需要特别注意
- 🔴 第430行: [mypy] error
- 🟡 第430行: [security_check] 密码相关代码需要特别注意
- 🟡 第433行: [security_check] 密码相关代码需要特别注意
- 🟡 第433行: [security_check] 令牌相关代码需要特别注意
- 🟡 第436行: [security_check] 令牌相关代码需要特别注意
- 🔴 第439行: [mypy] error
- 🟡 第439行: [security_check] 密码相关代码需要特别注意
- 🔴 第445行: [mypy] error
- 🟡 第447行: [security_check] 密码相关代码需要特别注意
- 🟡 第450行: [security_check] 令牌相关代码需要特别注意
- 🔴 第457行: [mypy] error
- 🟡 第457行: [function_length] 函数 async setup_mfa 过长 (106 行)
- 🟡 第478行: [security_check] 密钥相关代码需要特别注意
- 🟡 第481行: [security_check] 密钥相关代码需要特别注意
- 🟡 第488行: [security_check] 密钥相关代码需要特别注意
- 🟡 第488行: [security_check] 令牌相关代码需要特别注意
- 🔴 第491行: [mypy] error
- 🟡 第494行: [security_check] 密钥相关代码需要特别注意
- 🟡 第501行: [security_check] 密钥相关代码需要特别注意
- 🟡 第512行: [security_check] 密钥相关代码需要特别注意
- 🔴 第523行: [mypy] error
- 🟡 第536行: [security_check] 密钥相关代码需要特别注意
- 🔴 第547行: [mypy] error
- 🔴 第563行: [mypy] error
- 🟡 第563行: [function_length] 函数 async verify_mfa 过长 (62 行)
- 🔴 第583行: [mypy] error
- 🟡 第583行: [security_check] 密钥相关代码需要特别注意
- 🟡 第584行: [security_check] 密钥相关代码需要特别注意
- 🟡 第587行: [security_check] 密钥相关代码需要特别注意
- 🟡 第589行: [security_check] 密钥相关代码需要特别注意
- 🟡 第594行: [security_check] 密钥相关代码需要特别注意
- 🔴 第596行: [mypy] error
- 🟡 第601行: [security_check] 密钥相关代码需要特别注意
- 🟡 第610行: [security_check] 密钥相关代码需要特别注意
- 🔴 第631行: [mypy] error
- 🟡 第636行: [security_check] 密钥相关代码需要特别注意
- 🔴 第639行: [mypy] error
- 🔴 第650行: [mypy] error
- 🔴 第667行: [mypy] error
- 🔴 第670行: [mypy] error
- 🔴 第684行: [mypy] error
- 🔴 第692行: [mypy] error
- 🔴 第707行: [mypy] error
- 🔴 第712行: [mypy] error
- 🔴 第713行: [mypy] error
- 🟡 第713行: [security_check] 令牌相关代码需要特别注意
- 🔴 第714行: [mypy] error
- 🟡 第717行: [security_check] 密码相关代码需要特别注意
- 🟡 第721行: [security_check] 令牌相关代码需要特别注意
- 🟡 第725行: [security_check] 密码相关代码需要特别注意
- 🔴 第742行: [mypy] error
- 🟡 第742行: [security_check] 密码相关代码需要特别注意
- 🟡 第745行: [security_check] 密码相关代码需要特别注意
- 🔴 第748行: [mypy] error
- 🟡 第748行: [security_check] 令牌相关代码需要特别注意
- 🟡 第751行: [security_check] 令牌相关代码需要特别注意
- 🔴 第754行: [mypy] error
- 🟡 第754行: [security_check] 令牌相关代码需要特别注意
- 🟡 第757行: [security_check] 令牌相关代码需要特别注意
- 🔴 第760行: [mypy] error
- 🟡 第760行: [security_check] 令牌相关代码需要特别注意
- 🟡 第763行: [security_check] 令牌相关代码需要特别注意
- 🟡 第766行: [security_check] 令牌相关代码需要特别注意
- 🟡 第769行: [security_check] 令牌相关代码需要特别注意
- 🟡 第772行: [security_check] 令牌相关代码需要特别注意
- 🟡 第775行: [security_check] 令牌相关代码需要特别注意
- 🔴 第778行: [mypy] error
- 🟡 第778行: [security_check] 密码相关代码需要特别注意
- 🟡 第781行: [security_check] 密码相关代码需要特别注意
- 🔴 第784行: [mypy] error
- 🟡 第784行: [security_check] 密码相关代码需要特别注意
- 🟡 第784行: [security_check] 令牌相关代码需要特别注意
- 🟡 第787行: [security_check] 密码相关代码需要特别注意
- 🟡 第787行: [security_check] 令牌相关代码需要特别注意
- 🔴 第796行: [mypy] error

### 📄 internal/service/biometric_auth_service.py
- 🟡 第12行: [security_check] 密钥相关代码需要特别注意
- 🔵 第13行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第17行: [unused_import] 可能未使用的导入: HTTPException
- 🔵 第17行: [unused_import] 可能未使用的导入: status
- 🔴 第37行: [mypy] error
- 🔴 第82行: [mypy] error
- 🔴 第95行: [mypy] error
- 🔴 第124行: [mypy] error
- 🔴 第147行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第207行: [mypy] error
- 🔴 第237行: [mypy] error
- 🔴 第262行: [mypy] error
- 🔴 第330行: [mypy] error
- 🔴 第356行: [mypy] error
- 🔴 第377行: [mypy] error
- 🔴 第382行: [mypy] error
- 🔴 第393行: [mypy] error
- 🟡 第411行: [security_check] 令牌相关代码需要特别注意
- 🟡 第419行: [security_check] 令牌相关代码需要特别注意
- 🔴 第429行: [mypy] error
- 🔴 第430行: [mypy] error
- 🔴 第431行: [mypy] error
- 🔴 第435行: [mypy] error
- 🔴 第439行: [mypy] error
- 🔴 第443行: [mypy] error
- 🔴 第446行: [mypy] error

### 📄 internal/service/blockchain_auth_service.py
- 🟡 第11行: [security_check] 密钥相关代码需要特别注意
- 🔵 第14行: [unused_import] 可能未使用的导入: Optional
- 🔵 第19行: [unused_import] 可能未使用的导入: HTTPException
- 🔴 第37行: [mypy] error
- 🔴 第77行: [mypy] error
- 🟡 第80行: [security_check] 密钥相关代码需要特别注意
- 🟡 第80行: [security_check] 令牌相关代码需要特别注意
- 🟡 第92行: [security_check] 密钥相关代码需要特别注意
- 🟡 第92行: [security_check] 令牌相关代码需要特别注意
- 🔴 第179行: [mypy] error
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🔴 第190行: [mypy] error
- 🟡 第192行: [security_check] 令牌相关代码需要特别注意
- 🔴 第210行: [mypy] error
- 🔴 第265行: [mypy] error
- 🔴 第268行: [mypy] error
- 🔴 第284行: [mypy] error
- 🔴 第284行: [mypy] error
- 🔴 第296行: [mypy] error
- 🟡 第300行: [security_check] 密钥相关代码需要特别注意
- 🟡 第300行: [security_check] 令牌相关代码需要特别注意
- 🔴 第305行: [mypy] error
- 🔴 第351行: [mypy] error
- 🔴 第356行: [mypy] error
- 🔴 第371行: [mypy] error
- 🟡 第379行: [security_check] 密码相关代码需要特别注意
- 🔴 第383行: [mypy] error
- 🔴 第407行: [mypy] error
- 🔴 第408行: [mypy] error
- 🔴 第412行: [mypy] error
- 🔴 第416行: [mypy] error
- 🔴 第419行: [mypy] error

### 📄 internal/service/email_service.py
- 🔵 第14行: [unused_import] 可能未使用的导入: Template
- 🔴 第23行: [mypy] error
- 🟡 第84行: [security_check] 密码相关代码需要特别注意
- 🔴 第94行: [mypy] error
- 🔴 第132行: [mypy] error
- 🟡 第137行: [function_length] 函数 _get_default_template 过长 (57 行)
- 🟡 第154行: [security_check] 密码相关代码需要特别注意
- 🟡 第228行: [security_check] 密码相关代码需要特别注意
- 🟡 第242行: [security_check] 密码相关代码需要特别注意
- 🟡 第355行: [security_check] 密码相关代码需要特别注意
- 🟡 第358行: [security_check] 密码相关代码需要特别注意

### 📄 internal/service/enhanced_auth_service.py
- 🟡 第1行: [file_length] 文件过长 (759 行)，建议拆分
- 🟡 第13行: [security_check] 密钥相关代码需要特别注意
- 🔵 第14行: [unused_import] 可能未使用的导入: Tuple
- 🟡 第31行: [security_check] 密码相关代码需要特别注意
- 🟡 第38行: [security_check] 密码相关代码需要特别注意
- 🟡 第44行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 密码相关代码需要特别注意
- 🟡 第55行: [security_check] 密码相关代码需要特别注意
- 🟡 第62行: [security_check] 令牌相关代码需要特别注意
- 🟡 第64行: [security_check] 密码相关代码需要特别注意
- 🟡 第64行: [security_check] 令牌相关代码需要特别注意
- 🟡 第66行: [security_check] 密码相关代码需要特别注意
- 🟡 第67行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 密钥相关代码需要特别注意
- 🟡 第78行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第80行: [security_check] 令牌相关代码需要特别注意
- 🟡 第82行: [security_check] 令牌相关代码需要特别注意
- 🔴 第103行: [mypy] error
- 🟡 第103行: [function_length] 函数 __init__ 过长 (52 行)
- 🟡 第124行: [security_check] 令牌相关代码需要特别注意
- 🟡 第125行: [security_check] 令牌相关代码需要特别注意
- 🟡 第126行: [security_check] 令牌相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🟡 第135行: [security_check] 密码相关代码需要特别注意
- 🟡 第136行: [security_check] 密码相关代码需要特别注意
- 🟡 第145行: [security_check] 令牌相关代码需要特别注意
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第147行: [security_check] 令牌相关代码需要特别注意
- 🔴 第155行: [mypy] error
- 🔴 第175行: [mypy] error
- 🟡 第179行: [security_check] 令牌相关代码需要特别注意
- 🔴 第194行: [mypy] error
- 🟡 第199行: [security_check] 密钥相关代码需要特别注意
- 🟡 第199行: [security_check] 令牌相关代码需要特别注意
- 🟡 第200行: [security_check] 密钥相关代码需要特别注意
- 🟡 第200行: [security_check] 令牌相关代码需要特别注意
- 🔴 第204行: [mypy] error
- 🟡 第216行: [function_length] 函数 async authenticate 过长 (95 行)
- 🟡 第258行: [security_check] 密码相关代码需要特别注意
- 🟡 第283行: [security_check] 令牌相关代码需要特别注意
- 🟡 第290行: [security_check] 令牌相关代码需要特别注意
- 🟡 第296行: [security_check] 令牌相关代码需要特别注意
- 🟡 第297行: [security_check] 令牌相关代码需要特别注意
- 🟡 第298行: [security_check] 令牌相关代码需要特别注意
- 🟡 第299行: [security_check] 令牌相关代码需要特别注意
- 🟡 第327行: [security_check] 密码相关代码需要特别注意
- 🟡 第328行: [security_check] 密码相关代码需要特别注意
- 🔴 第359行: [mypy] error
- 🔴 第382行: [mypy] error
- 🟡 第408行: [security_check] 密钥相关代码需要特别注意
- 🟡 第408行: [security_check] 令牌相关代码需要特别注意
- 🟡 第416行: [security_check] 令牌相关代码需要特别注意
- 🔴 第428行: [mypy] error
- 🟡 第438行: [security_check] 令牌相关代码需要特别注意
- 🔴 第441行: [mypy] error
- 🟡 第445行: [function_length] 函数 async _generate_tokens 过长 (68 行)
- 🟡 第445行: [security_check] 令牌相关代码需要特别注意
- 🟡 第459行: [security_check] 密钥相关代码需要特别注意
- 🟡 第459行: [security_check] 令牌相关代码需要特别注意
- 🟡 第466行: [security_check] 令牌相关代码需要特别注意
- 🟡 第467行: [security_check] 令牌相关代码需要特别注意
- 🟡 第471行: [security_check] 令牌相关代码需要特别注意
- 🟡 第481行: [security_check] 令牌相关代码需要特别注意
- 🟡 第482行: [security_check] 令牌相关代码需要特别注意
- 🟡 第484行: [security_check] 令牌相关代码需要特别注意
- 🟡 第494行: [security_check] 令牌相关代码需要特别注意
- 🟡 第495行: [security_check] 令牌相关代码需要特别注意
- 🟡 第500行: [security_check] 令牌相关代码需要特别注意
- 🟡 第508行: [security_check] 令牌相关代码需要特别注意
- 🟡 第509行: [security_check] 令牌相关代码需要特别注意
- 🟡 第510行: [security_check] 令牌相关代码需要特别注意
- 🟡 第513行: [security_check] 令牌相关代码需要特别注意
- 🟡 第514行: [security_check] 令牌相关代码需要特别注意
- 🟡 第515行: [function_length] 函数 async refresh_token 过长 (60 行)
- 🟡 第515行: [security_check] 令牌相关代码需要特别注意
- 🟡 第519行: [security_check] 令牌相关代码需要特别注意
- 🟡 第523行: [security_check] 令牌相关代码需要特别注意
- 🟡 第527行: [security_check] 令牌相关代码需要特别注意
- 🟡 第530行: [security_check] 令牌相关代码需要特别注意
- 🟡 第553行: [security_check] 令牌相关代码需要特别注意
- 🟡 第556行: [security_check] 令牌相关代码需要特别注意
- 🟡 第561行: [security_check] 令牌相关代码需要特别注意
- 🟡 第562行: [security_check] 令牌相关代码需要特别注意
- 🟡 第563行: [security_check] 令牌相关代码需要特别注意
- 🟡 第564行: [security_check] 令牌相关代码需要特别注意
- 🟡 第572行: [security_check] 令牌相关代码需要特别注意
- 🟡 第575行: [security_check] 令牌相关代码需要特别注意
- 🟡 第579行: [security_check] 令牌相关代码需要特别注意
- 🟡 第593行: [security_check] 令牌相关代码需要特别注意
- 🟡 第601行: [security_check] 令牌相关代码需要特别注意
- 🟡 第602行: [security_check] 令牌相关代码需要特别注意
- 🔴 第605行: [mypy] error
- 🟡 第610行: [security_check] 令牌相关代码需要特别注意
- 🟡 第614行: [security_check] 令牌相关代码需要特别注意
- 🟡 第618行: [security_check] 令牌相关代码需要特别注意
- 🟡 第619行: [security_check] 令牌相关代码需要特别注意
- 🟡 第634行: [security_check] 令牌相关代码需要特别注意
- 🟡 第643行: [security_check] 令牌相关代码需要特别注意
- 🔴 第649行: [mypy] error
- 🔴 第682行: [mypy] error
- 🔴 第699行: [mypy] error
- 🔴 第705行: [mypy] error
- 🔴 第705行: [mypy] error
- 🟡 第706行: [security_check] 令牌相关代码需要特别注意
- 🔴 第708行: [mypy] error
- 🔴 第715行: [mypy] error
- 🔴 第720行: [mypy] error
- 🔴 第744行: [mypy] error

### 📄 internal/service/metrics_service.py
- 🔵 第8行: [unused_import] 可能未使用的导入: Optional
- 🔴 第22行: [mypy] error
- 🟡 第29行: [security_check] 令牌相关代码需要特别注意
- 🟡 第30行: [security_check] 令牌相关代码需要特别注意
- 🔴 第35行: [mypy] error
- 🟡 第35行: [function_length] 函数 _init_metrics 过长 (80 行)
- 🟡 第50行: [security_check] 密码相关代码需要特别注意
- 🟡 第51行: [security_check] 密码相关代码需要特别注意
- 🟡 第52行: [security_check] 密码相关代码需要特别注意
- 🔴 第115行: [mypy] error
- 🟡 第115行: [security_check] 密码相关代码需要特别注意
- 🔴 第120行: [mypy] error
- 🔴 第125行: [mypy] error
- 🟡 第125行: [security_check] 密码相关代码需要特别注意
- 🟡 第128行: [security_check] 密码相关代码需要特别注意
- 🔴 第130行: [mypy] error
- 🔴 第135行: [mypy] error
- 🔴 第139行: [mypy] error
- 🔴 第143行: [mypy] error
- 🔴 第151行: [mypy] error
- 🟡 第154行: [security_check] 令牌相关代码需要特别注意
- 🟡 第155行: [security_check] 令牌相关代码需要特别注意
- 🟡 第156行: [security_check] 令牌相关代码需要特别注意
- 🔴 第164行: [mypy] error
- 🔴 第185行: [mypy] error
- 🔴 第199行: [mypy] error
- 🟡 第206行: [function_length] 函数 async get_health_status 过长 (53 行)
- 🔴 第220行: [mypy] error
- 🔴 第225行: [mypy] error
- 🔴 第237行: [mypy] error
- 🔴 第246行: [mypy] error
- 🔴 第251行: [mypy] error
- 🟡 第267行: [security_check] 令牌相关代码需要特别注意
- 🟡 第268行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 令牌相关代码需要特别注意
- 🟡 第272行: [security_check] 令牌相关代码需要特别注意
- 🟡 第274行: [security_check] 令牌相关代码需要特别注意
- 🟡 第287行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/service/mfa_service.py
- 🟡 第7行: [security_check] 密钥相关代码需要特别注意
- 🔵 第13行: [unused_import] 可能未使用的导入: timedelta
- 🟡 第19行: [security_check] 密钥相关代码需要特别注意
- 🔴 第26行: [mypy] error
- 🟡 第31行: [security_check] 密钥相关代码需要特别注意
- 🟡 第48行: [security_check] 密钥相关代码需要特别注意
- 🟡 第52行: [security_check] 密钥相关代码需要特别注意
- 🟡 第58行: [security_check] 密钥相关代码需要特别注意
- 🟡 第65行: [security_check] 密钥相关代码需要特别注意
- 🟡 第95行: [security_check] 密钥相关代码需要特别注意
- 🟡 第100行: [security_check] 密钥相关代码需要特别注意
- 🟡 第108行: [security_check] 密钥相关代码需要特别注意
- 🟡 第148行: [security_check] 密钥相关代码需要特别注意
- 🟡 第152行: [security_check] 密钥相关代码需要特别注意
- 🟡 第155行: [security_check] 密钥相关代码需要特别注意
- 🟡 第158行: [security_check] 密钥相关代码需要特别注意
- 🟡 第168行: [security_check] 密钥相关代码需要特别注意
- 🟡 第177行: [security_check] 密钥相关代码需要特别注意
- 🟡 第186行: [security_check] 密钥相关代码需要特别注意
- 🟡 第194行: [security_check] 密钥相关代码需要特别注意
- 🟡 第196行: [security_check] 密钥相关代码需要特别注意
- 🔴 第197行: [mypy] error
- 🟡 第197行: [security_check] 密钥相关代码需要特别注意
- 🟡 第201行: [security_check] 密钥相关代码需要特别注意
- 🟡 第203行: [security_check] 密钥相关代码需要特别注意
- 🟡 第205行: [security_check] 密钥相关代码需要特别注意
- 🟡 第206行: [security_check] 密钥相关代码需要特别注意
- 🟡 第207行: [security_check] 密钥相关代码需要特别注意
- 🟡 第208行: [security_check] 密钥相关代码需要特别注意
- 🟡 第211行: [security_check] 密钥相关代码需要特别注意
- 🟡 第215行: [security_check] 密钥相关代码需要特别注意
- 🟡 第221行: [security_check] 密钥相关代码需要特别注意
- 🟡 第246行: [security_check] 密钥相关代码需要特别注意
- 🟡 第248行: [security_check] 密钥相关代码需要特别注意
- 🔴 第249行: [mypy] error
- 🟡 第249行: [security_check] 密钥相关代码需要特别注意
- 🟡 第253行: [security_check] 密钥相关代码需要特别注意
- 🟡 第255行: [security_check] 密钥相关代码需要特别注意
- 🟡 第256行: [security_check] 密钥相关代码需要特别注意
- 🟡 第257行: [security_check] 密钥相关代码需要特别注意
- 🟡 第288行: [security_check] 密钥相关代码需要特别注意
- 🟡 第290行: [security_check] 密钥相关代码需要特别注意
- 🔴 第291行: [mypy] error
- 🟡 第291行: [security_check] 密钥相关代码需要特别注意
- 🔴 第296行: [mypy] error
- 🟡 第296行: [security_check] 密钥相关代码需要特别注意
- 🟡 第299行: [security_check] 密钥相关代码需要特别注意
- 🟡 第301行: [security_check] 密钥相关代码需要特别注意
- 🟡 第302行: [security_check] 密钥相关代码需要特别注意
- 🟡 第304行: [security_check] 密钥相关代码需要特别注意
- 🟡 第308行: [security_check] 密钥相关代码需要特别注意
- 🟡 第310行: [security_check] 密钥相关代码需要特别注意
- 🟡 第314行: [security_check] 密钥相关代码需要特别注意
- 🟡 第315行: [security_check] 密钥相关代码需要特别注意
- 🟡 第338行: [security_check] 密钥相关代码需要特别注意
- 🟡 第340行: [security_check] 密钥相关代码需要特别注意
- 🟡 第343行: [security_check] 密钥相关代码需要特别注意
- 🟡 第345行: [security_check] 密钥相关代码需要特别注意
- 🟡 第346行: [security_check] 密钥相关代码需要特别注意
- 🟡 第347行: [security_check] 密钥相关代码需要特别注意
- 🟡 第348行: [security_check] 密钥相关代码需要特别注意
- 🟡 第349行: [security_check] 密钥相关代码需要特别注意
- 🟡 第372行: [security_check] 密钥相关代码需要特别注意
- 🟡 第374行: [security_check] 密钥相关代码需要特别注意
- 🔴 第375行: [mypy] error
- 🟡 第375行: [security_check] 密钥相关代码需要特别注意
- 🔴 第376行: [mypy] error
- 🟡 第376行: [security_check] 密钥相关代码需要特别注意
- 🟡 第380行: [security_check] 密钥相关代码需要特别注意
- 🟡 第382行: [security_check] 密钥相关代码需要特别注意
- 🟡 第385行: [security_check] 密钥相关代码需要特别注意
- 🟡 第386行: [security_check] 密钥相关代码需要特别注意
- 🟡 第411行: [security_check] 密钥相关代码需要特别注意
- 🟡 第413行: [security_check] 密钥相关代码需要特别注意
- 🔴 第414行: [mypy] error
- 🟡 第414行: [security_check] 密钥相关代码需要特别注意

### 📄 internal/service/oauth_service.py
- 🟡 第1行: [file_length] 文件过长 (649 行)，建议拆分
- 🟡 第34行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 令牌相关代码需要特别注意
- 🟡 第44行: [security_check] 密钥相关代码需要特别注意
- 🟡 第46行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 密钥相关代码需要特别注意
- 🟡 第56行: [security_check] 令牌相关代码需要特别注意
- 🟡 第130行: [function_length] 函数 async exchange_code_for_token 过长 (63 行)
- 🟡 第130行: [security_check] 令牌相关代码需要特别注意
- 🟡 第150行: [security_check] 密钥相关代码需要特别注意
- 🟡 第164行: [security_check] 令牌相关代码需要特别注意
- 🟡 第165行: [security_check] 令牌相关代码需要特别注意
- 🟡 第167行: [security_check] 令牌相关代码需要特别注意
- 🟡 第173行: [security_check] 令牌相关代码需要特别注意
- 🔴 第182行: [mypy] error
- 🟡 第193行: [function_length] 函数 async get_user_profile 过长 (70 行)
- 🟡 第193行: [security_check] 令牌相关代码需要特别注意
- 🟡 第199行: [security_check] 令牌相关代码需要特别注意
- 🟡 第210行: [security_check] 令牌相关代码需要特别注意
- 🟡 第236行: [security_check] 令牌相关代码需要特别注意
- 🔴 第252行: [mypy] error
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第276行: [security_check] 令牌相关代码需要特别注意
- 🔴 第296行: [mypy] error
- 🔴 第310行: [mypy] error
- 🟡 第314行: [security_check] 令牌相关代码需要特别注意
- 🔴 第319行: [mypy] error
- 🟡 第321行: [security_check] 令牌相关代码需要特别注意
- 🔴 第333行: [mypy] error
- 🟡 第335行: [security_check] 令牌相关代码需要特别注意
- 🟡 第349行: [security_check] 令牌相关代码需要特别注意
- 🔴 第365行: [mypy] error
- 🔴 第366行: [mypy] error
- 🟡 第369行: [security_check] 令牌相关代码需要特别注意
- 🔴 第374行: [mypy] error
- 🔴 第386行: [mypy] error
- 🟡 第390行: [security_check] 令牌相关代码需要特别注意
- 🟡 第395行: [security_check] 令牌相关代码需要特别注意
- 🔴 第397行: [mypy] error
- 🟡 第397行: [security_check] 令牌相关代码需要特别注意
- 🟡 第399行: [security_check] 令牌相关代码需要特别注意
- 🟡 第404行: [security_check] 令牌相关代码需要特别注意
- 🟡 第410行: [security_check] 令牌相关代码需要特别注意
- 🔴 第423行: [mypy] error
- 🔴 第428行: [mypy] error
- 🔴 第432行: [mypy] error
- 🔴 第439行: [mypy] error
- 🟡 第439行: [security_check] 令牌相关代码需要特别注意
- 🔴 第450行: [mypy] error
- 🔴 第451行: [mypy] error
- 🟡 第451行: [security_check] 令牌相关代码需要特别注意
- 🟡 第454行: [security_check] 令牌相关代码需要特别注意
- 🟡 第455行: [security_check] 令牌相关代码需要特别注意
- 🔴 第458行: [mypy] error
- 🟡 第458行: [security_check] 令牌相关代码需要特别注意
- 🔴 第462行: [mypy] error
- 🟡 第462行: [security_check] 令牌相关代码需要特别注意
- 🔴 第463行: [mypy] error
- 🟡 第463行: [security_check] 令牌相关代码需要特别注意
- 🟡 第464行: [security_check] 令牌相关代码需要特别注意
- 🔴 第465行: [mypy] error
- 🟡 第465行: [security_check] 令牌相关代码需要特别注意
- 🔴 第492行: [mypy] error
- 🔴 第535行: [mypy] error
- 🔴 第543行: [mypy] error
- 🟡 第543行: [security_check] 密码相关代码需要特别注意
- 🔴 第544行: [mypy] error
- 🟡 第546行: [security_check] 密码相关代码需要特别注意
- 🔴 第550行: [mypy] error
- 🔴 第550行: [mypy] error
- 🟡 第605行: [security_check] 令牌相关代码需要特别注意
- 🟡 第606行: [security_check] 令牌相关代码需要特别注意
- 🟡 第607行: [security_check] 令牌相关代码需要特别注意
- 🟡 第617行: [security_check] 令牌相关代码需要特别注意
- 🟡 第624行: [security_check] 令牌相关代码需要特别注意

### 📄 internal/service/permission_service.py
- 🔵 第8行: [unused_import] 可能未使用的导入: Optional

### 📄 internal/service/role_service.py
- 🔵 第8行: [unused_import] 可能未使用的导入: Optional

### 📄 internal/service/sms_service.py
- 🔴 第18行: [mypy] error
- 🟡 第23行: [security_check] 令牌相关代码需要特别注意
- 🟡 第26行: [security_check] 令牌相关代码需要特别注意
- 🟡 第161行: [security_check] 密码相关代码需要特别注意
- 🔴 第235行: [mypy] error

### 📄 internal/service/social_auth_service.py
- 🟡 第10行: [security_check] 密钥相关代码需要特别注意
- 🔵 第11行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第13行: [unused_import] 可能未使用的导入: parse_qs
- 🔵 第16行: [unused_import] 可能未使用的导入: HTTPException
- 🔵 第17行: [unused_import] 可能未使用的导入: AsyncSession
- 🔵 第21行: [unused_import] 可能未使用的导入: OAuthConnection
- 🔵 第21行: [unused_import] 可能未使用的导入: OAuthProvider
- 🔴 第36行: [mypy] error
- 🟡 第55行: [security_check] 密钥相关代码需要特别注意
- 🟡 第57行: [security_check] 令牌相关代码需要特别注意
- 🟡 第63行: [security_check] 密钥相关代码需要特别注意
- 🟡 第65行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 密钥相关代码需要特别注意
- 🟡 第73行: [security_check] 令牌相关代码需要特别注意
- 🟡 第93行: [security_check] 密钥相关代码需要特别注意
- 🟡 第93行: [security_check] 令牌相关代码需要特别注意
- 🟡 第149行: [security_check] 令牌相关代码需要特别注意
- 🟡 第154行: [security_check] 令牌相关代码需要特别注意
- 🔴 第161行: [mypy] error
- 🟡 第161行: [security_check] 令牌相关代码需要特别注意
- 🟡 第165行: [security_check] 令牌相关代码需要特别注意
- 🔴 第172行: [mypy] error
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第178行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 密钥相关代码需要特别注意
- 🟡 第199行: [security_check] 密钥相关代码需要特别注意
- 🟡 第201行: [security_check] 密钥相关代码需要特别注意
- 🟡 第210行: [security_check] 令牌相关代码需要特别注意
- 🟡 第218行: [security_check] 令牌相关代码需要特别注意
- 🟡 第220行: [security_check] 令牌相关代码需要特别注意
- 🟡 第222行: [security_check] 令牌相关代码需要特别注意
- 🟡 第223行: [security_check] 令牌相关代码需要特别注意
- 🔴 第226行: [mypy] error
- 🟡 第226行: [security_check] 令牌相关代码需要特别注意
- 🟡 第231行: [security_check] 令牌相关代码需要特别注意
- 🟡 第235行: [security_check] 令牌相关代码需要特别注意
- 🟡 第239行: [security_check] 令牌相关代码需要特别注意
- 🔴 第295行: [mypy] error
- 🔴 第300行: [mypy] error
- 🔴 第300行: [mypy] error
- 🔴 第305行: [mypy] error
- 🔴 第307行: [mypy] error
- 🔴 第323行: [mypy] error
- 🔴 第323行: [mypy] error
- 🔴 第338行: [mypy] error
- 🟡 第342行: [security_check] 密钥相关代码需要特别注意
- 🟡 第342行: [security_check] 令牌相关代码需要特别注意
- 🔴 第347行: [mypy] error
- 🟡 第352行: [security_check] 令牌相关代码需要特别注意
- 🟡 第361行: [security_check] 令牌相关代码需要特别注意
- 🔴 第366行: [mypy] error
- 🔴 第371行: [mypy] error
- 🔴 第375行: [mypy] error
- 🔴 第383行: [mypy] error
- 🔴 第391行: [mypy] error
- 🟡 第392行: [security_check] 密码相关代码需要特别注意
- 🔴 第394行: [mypy] error
- 🔴 第400行: [mypy] error
- 🔴 第405行: [mypy] error
- 🔴 第424行: [mypy] error
- 🔴 第425行: [mypy] error
- 🔴 第426行: [mypy] error
- 🔴 第430行: [mypy] error
- 🔴 第434行: [mypy] error
- 🔴 第438行: [mypy] error
- 🔴 第441行: [mypy] error

### 📄 internal/service/startup.py
- 🔴 第13行: [mypy] error
- 🔴 第36行: [mypy] error

### 📄 internal/service/user_service.py
- 🟡 第17行: [security_check] 密码相关代码需要特别注意
- 🟡 第24行: [security_check] 密码相关代码需要特别注意
- 🟡 第26行: [security_check] 密码相关代码需要特别注意
- 🟡 第30行: [function_length] 函数 async create_user 过长 (63 行)
- 🔴 第46行: [mypy] error
- 🔴 第51行: [mypy] error
- 🔴 第56行: [mypy] error
- 🟡 第56行: [security_check] 密码相关代码需要特别注意
- 🟡 第64行: [security_check] 密码相关代码需要特别注意
- 🔴 第72行: [mypy] error
- 🔴 第103行: [mypy] error
- 🔴 第135行: [mypy] error
- 🔴 第135行: [mypy] error
- 🔴 第147行: [mypy] error
- 🔴 第147行: [mypy] error
- 🟡 第149行: [function_length] 函数 async update_user 过长 (71 行)
- 🔴 第166行: [mypy] error
- 🔴 第172行: [mypy] error
- 🔴 第178行: [mypy] error
- 🔴 第191行: [mypy] error
- 🔴 第193行: [mypy] error
- 🔴 第197行: [mypy] error
- 🔴 第200行: [mypy] error
- 🔴 第231行: [mypy] error
- 🔴 第231行: [mypy] error
- 🔴 第250行: [mypy] error
- 🔴 第291行: [mypy] error
- 🔴 第312行: [mypy] error
- 🔴 第332行: [mypy] error
- 🔴 第352行: [mypy] error
- 🔴 第370行: [mypy] error
- 🔴 第380行: [mypy] error
- 🔴 第381行: [mypy] error

### 📄 internal/startup.py
- 🔴 第14行: [mypy] error
- 🔴 第14行: [mypy] error
- 🔴 第17行: [mypy] error
- 🟡 第28行: [function_length] 函数 async lifespan 过长 (114 行)

### 📄 internal/testing/performance_test.py
- 🟡 第1行: [file_length] 文件过长 (800 行)，建议拆分
- 🔵 第11行: [unused_import] 可能未使用的导入: Callable
- 🔵 第13行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第21行: [unused_import] 可能未使用的导入: get_connection_manager
- 🔵 第22行: [unused_import] 可能未使用的导入: get_redis_cache
- 🔵 第23行: [unused_import] 可能未使用的导入: get_task_manager
- 🔴 第128行: [mypy] error
- 🔴 第219行: [mypy] error
- 🔴 第224行: [mypy] error
- 🔴 第239行: [mypy] error
- 🔴 第252行: [mypy] error
- 🔴 第273行: [mypy] error
- 🔴 第288行: [mypy] error
- 🔴 第298行: [mypy] error
- 🔴 第305行: [mypy] error
- 🔴 第325行: [mypy] error
- 🔴 第330行: [mypy] error
- 🔴 第350行: [mypy] error
- 🔴 第366行: [mypy] error
- 🔴 第406行: [mypy] error
- 🟡 第448行: [security_check] 密码相关代码需要特别注意
- 🔴 第453行: [mypy] error
- 🔴 第459行: [mypy] error
- 🔴 第483行: [mypy] error
- 🔴 第515行: [mypy] error
- 🔴 第521行: [mypy] error
- 🔴 第533行: [mypy] error
- 🔴 第616行: [mypy] error
- 🔴 第620行: [mypy] error
- 🟡 第643行: [function_length] 函数 get_default_auth_tests 过长 (71 行)
- 🟡 第659行: [security_check] 密码相关代码需要特别注意
- 🟡 第680行: [security_check] 令牌相关代码需要特别注意
- 🟡 第703行: [security_check] 密码相关代码需要特别注意

### 📄 internal/validators.py
- 🔵 第9行: [unused_import] 可能未使用的导入: List
- 🟡 第33行: [security_check] 密码相关代码需要特别注意
- 🟡 第93行: [security_check] 密码相关代码需要特别注意
- 🟡 第95行: [security_check] 密码相关代码需要特别注意
- 🟡 第101行: [security_check] 密码相关代码需要特别注意
- 🟡 第102行: [security_check] 密码相关代码需要特别注意
- 🟡 第104行: [security_check] 密码相关代码需要特别注意
- 🟡 第108行: [security_check] 密码相关代码需要特别注意
- 🟡 第111行: [security_check] 密码相关代码需要特别注意
- 🟡 第114行: [security_check] 密码相关代码需要特别注意
- 🟡 第117行: [security_check] 密码相关代码需要特别注意
- 🟡 第118行: [security_check] 密码相关代码需要特别注意
- 🟡 第121行: [security_check] 密码相关代码需要特别注意
- 🟡 第122行: [security_check] 密码相关代码需要特别注意
- 🟡 第123行: [security_check] 密码相关代码需要特别注意
- 🟡 第125行: [security_check] 密码相关代码需要特别注意
- 🟡 第131行: [security_check] 密码相关代码需要特别注意
- 🟡 第253行: [security_check] 密码相关代码需要特别注意
- 🔴 第258行: [mypy] error
- 🔴 第265行: [mypy] error
- 🟡 第271行: [security_check] 密码相关代码需要特别注意
- 🔴 第272行: [mypy] error
- 🟡 第272行: [security_check] 密码相关代码需要特别注意
- 🟡 第273行: [security_check] 密码相关代码需要特别注意
- 🔴 第279行: [mypy] error
- 🔴 第288行: [mypy] error
- 🔴 第306行: [mypy] error
- 🔴 第315行: [mypy] error
- 🔴 第324行: [mypy] error
- 🔴 第333行: [mypy] error
- 🟡 第346行: [security_check] 密码相关代码需要特别注意
- 🔴 第349行: [mypy] error
- 🟡 第356行: [security_check] 密码相关代码需要特别注意
- 🔴 第357行: [mypy] error
- 🟡 第357行: [security_check] 密码相关代码需要特别注意

### 📄 migrations/env.py
- 🟡 第25行: [security_check] 密钥相关代码需要特别注意
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意

### 📄 pkg/logging/logger.py
- 🔵 第10行: [unused_import] 可能未使用的导入: Optional

### 📄 scripts/backup.py
- 🟡 第227行: [function_length] 函数 main 过长 (68 行)

### 📄 scripts/cleanup_redundant_files.py
- 🔵 第12行: [unused_import] 可能未使用的导入: Set
- 🟡 第32行: [function_length] 函数 identify_redundant_files 过长 (83 行)
- 🟡 第170行: [function_length] 函数 generate_gitignore_suggestions 过长 (90 行)

### 📄 scripts/code_quality_analyzer.py
- 🟡 第1行: [file_length] 文件过长 (548 行)，建议拆分
- 🔵 第12行: [unused_import] 可能未使用的导入: Dict
- 🔵 第12行: [unused_import] 可能未使用的导入: Tuple
- 🔵 第12行: [unused_import] 可能未使用的导入: Optional
- 🟡 第52行: [function_length] 函数 run_flake8_analysis 过长 (57 行)
- 🟡 第156行: [function_length] 函数 analyze_code_complexity 过长 (70 行)
- 🟡 第232行: [security_check] 密码相关代码需要特别注意
- 🟡 第233行: [security_check] 密钥相关代码需要特别注意
- 🟡 第234行: [security_check] 令牌相关代码需要特别注意
- 🟡 第235行: [security_check] 使用eval()可能存在安全风险
- 🟡 第236行: [security_check] 使用exec()可能存在安全风险
- 🟡 第238行: [security_check] 使用pickle.loads可能存在反序列化风险
- 🟡 第271行: [function_length] 函数 analyze_imports 过长 (61 行)
- 🟡 第289行: [wildcard_import] 避免使用通配符导入 (import *)
- 🟡 第389行: [function_length] 函数 generate_report 过长 (84 行)

### 📄 scripts/init_data.py
- 🔵 第17行: [unused_import] 可能未使用的导入: get_async_engine
- 🟡 第22行: [security_check] 密码相关代码需要特别注意
- 🟡 第26行: [function_length] 函数 async create_default_permissions 过长 (56 行)
- 🟡 第107行: [function_length] 函数 async assign_permissions_to_roles 过长 (66 行)
- 🟡 第175行: [security_check] 密码相关代码需要特别注意
- 🟡 第182行: [security_check] 密码相关代码需要特别注意
- 🟡 第214行: [function_length] 函数 async init_database 过长 (56 行)

### 📄 scripts/run_tests.py
- 🟡 第56行: [security_check] 密码相关代码需要特别注意
- 🟡 第60行: [security_check] 密钥相关代码需要特别注意

### 📄 scripts/security_check.py
- 🟡 第1行: [file_length] 文件过长 (576 行)，建议拆分
- 🔵 第15行: [unused_import] 可能未使用的导入: Optional
- 🔵 第15行: [unused_import] 可能未使用的导入: Union
- 🟡 第393行: [function_length] 函数 check_security 过长 (116 行)
- 🟡 第509行: [function_length] 函数 main 过长 (66 行)

### 📄 test/conftest.py
- 🔵 第14行: [unused_import] 可能未使用的导入: Optional
- 🟡 第29行: [security_check] 密码相关代码需要特别注意
- 🟡 第36行: [security_check] 密钥相关代码需要特别注意
- 🟡 第45行: [security_check] 密码相关代码需要特别注意
- 🟡 第76行: [security_check] 密码相关代码需要特别注意
- 🟡 第82行: [security_check] 令牌相关代码需要特别注意
- 🟡 第95行: [function_length] 函数 async db_pool 过长 (144 行)
- 🟡 第98行: [security_check] 密码相关代码需要特别注意
- 🟡 第123行: [security_check] 密码相关代码需要特别注意
- 🟡 第132行: [security_check] 密钥相关代码需要特别注意
- 🟡 第267行: [security_check] 密码相关代码需要特别注意

### 📄 test/integration/test_auth_flow.py
- 🔵 第16行: [unused_import] 可能未使用的导入: CredentialsError
- 🔵 第16行: [unused_import] 可能未使用的导入: UserExistsError
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🟡 第98行: [security_check] 密码相关代码需要特别注意
- 🟡 第106行: [security_check] 令牌相关代码需要特别注意
- 🟡 第107行: [security_check] 令牌相关代码需要特别注意
- 🟡 第108行: [security_check] 令牌相关代码需要特别注意
- 🟡 第112行: [security_check] 令牌相关代码需要特别注意
- 🟡 第113行: [security_check] 令牌相关代码需要特别注意
- 🟡 第118行: [security_check] 密码相关代码需要特别注意
- 🟡 第126行: [security_check] 令牌相关代码需要特别注意
- 🟡 第130行: [security_check] 令牌相关代码需要特别注意
- 🟡 第133行: [security_check] 令牌相关代码需要特别注意
- 🟡 第136行: [security_check] 令牌相关代码需要特别注意
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第147行: [security_check] 令牌相关代码需要特别注意
- 🟡 第155行: [security_check] 令牌相关代码需要特别注意
- 🟡 第158行: [security_check] 令牌相关代码需要特别注意
- 🟡 第161行: [security_check] 令牌相关代码需要特别注意
- 🟡 第168行: [security_check] 令牌相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意
- 🟡 第170行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第185行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第190行: [security_check] 令牌相关代码需要特别注意
- 🟡 第192行: [security_check] 令牌相关代码需要特别注意
- 🟡 第201行: [security_check] 令牌相关代码需要特别注意
- 🟡 第213行: [security_check] 密码相关代码需要特别注意
- 🟡 第243行: [security_check] 密码相关代码需要特别注意
- 🟡 第251行: [security_check] 密码相关代码需要特别注意
- 🟡 第252行: [security_check] 密码相关代码需要特别注意
- 🟡 第259行: [security_check] 令牌相关代码需要特别注意
- 🟡 第260行: [security_check] 令牌相关代码需要特别注意
- 🟡 第261行: [security_check] 令牌相关代码需要特别注意
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第271行: [security_check] 密码相关代码需要特别注意
- 🟡 第272行: [security_check] 密码相关代码需要特别注意
- 🟡 第281行: [security_check] 令牌相关代码需要特别注意
- 🟡 第285行: [security_check] 令牌相关代码需要特别注意
- 🟡 第288行: [security_check] 令牌相关代码需要特别注意
- 🟡 第291行: [security_check] 令牌相关代码需要特别注意
- 🟡 第292行: [security_check] 令牌相关代码需要特别注意
- 🟡 第299行: [security_check] 令牌相关代码需要特别注意
- 🟡 第301行: [security_check] 令牌相关代码需要特别注意

### 📄 test/integration/test_load_performance.py
- 🔵 第13行: [unused_import] 可能未使用的导入: List
- 🔵 第13行: [unused_import] 可能未使用的导入: Dict
- 🔵 第13行: [unused_import] 可能未使用的导入: Any
- 🟡 第37行: [security_check] 密码相关代码需要特别注意
- 🟡 第58行: [security_check] 令牌相关代码需要特别注意
- 🟡 第68行: [security_check] 密码相关代码需要特别注意
- 🟡 第74行: [security_check] 令牌相关代码需要特别注意
- 🟡 第75行: [security_check] 令牌相关代码需要特别注意
- 🟡 第76行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第86行: [security_check] 令牌相关代码需要特别注意
- 🟡 第93行: [security_check] 密码相关代码需要特别注意
- 🟡 第166行: [security_check] 令牌相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意
- 🟡 第173行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [function_length] 函数 async test_sustained_load 过长 (51 行)
- 🟡 第252行: [security_check] 令牌相关代码需要特别注意
- 🟡 第263行: [security_check] 密码相关代码需要特别注意
- 🟡 第267行: [security_check] 令牌相关代码需要特别注意
- 🟡 第268行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 令牌相关代码需要特别注意
- 🟡 第275行: [security_check] 令牌相关代码需要特别注意

### 📄 test/integration/test_mfa.py
- 🔵 第10行: [unused_import] 可能未使用的导入: AsyncClient
- 🔵 第12行: [unused_import] 可能未使用的导入: app
- 🟡 第16行: [security_check] 令牌相关代码需要特别注意
- 🟡 第24行: [security_check] 令牌相关代码需要特别注意
- 🟡 第31行: [security_check] 密钥相关代码需要特别注意
- 🟡 第35行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 密钥相关代码需要特别注意
- 🟡 第41行: [security_check] 密钥相关代码需要特别注意
- 🟡 第45行: [security_check] 令牌相关代码需要特别注意
- 🟡 第48行: [security_check] 密钥相关代码需要特别注意
- 🟡 第48行: [security_check] 令牌相关代码需要特别注意
- 🟡 第51行: [security_check] 密钥相关代码需要特别注意
- 🟡 第60行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第95行: [security_check] 密码相关代码需要特别注意
- 🟡 第95行: [security_check] 密钥相关代码需要特别注意
- 🟡 第100行: [security_check] 密码相关代码需要特别注意
- 🟡 第108行: [security_check] 令牌相关代码需要特别注意
- 🟡 第110行: [security_check] 令牌相关代码需要特别注意
- 🟡 第113行: [security_check] 密钥相关代码需要特别注意
- 🟡 第118行: [security_check] 令牌相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🟡 第128行: [security_check] 令牌相关代码需要特别注意
- 🟡 第132行: [security_check] 令牌相关代码需要特别注意
- 🟡 第135行: [security_check] 令牌相关代码需要特别注意
- 🟡 第138行: [security_check] 令牌相关代码需要特别注意
- 🟡 第153行: [security_check] 令牌相关代码需要特别注意
- 🟡 第156行: [security_check] 令牌相关代码需要特别注意
- 🟡 第164行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第184行: [security_check] 密码相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第211行: [security_check] 密码相关代码需要特别注意
- 🟡 第215行: [security_check] 令牌相关代码需要特别注意
- 🟡 第221行: [security_check] 令牌相关代码需要特别注意
- 🟡 第224行: [security_check] 密钥相关代码需要特别注意
- 🟡 第226行: [security_check] 密码相关代码需要特别注意
- 🟡 第226行: [security_check] 密钥相关代码需要特别注意

### 📄 test/integration/test_role_management.py
- 🔵 第9行: [unused_import] 可能未使用的导入: AsyncClient
- 🔵 第11行: [unused_import] 可能未使用的导入: app
- 🔵 第12行: [unused_import] 可能未使用的导入: admin_user_data
- 🔵 第12行: [unused_import] 可能未使用的导入: test_user_data
- 🟡 第16行: [function_length] 函数 async test_role_hierarchy 过长 (85 行)
- 🟡 第16行: [security_check] 令牌相关代码需要特别注意
- 🟡 第40行: [security_check] 令牌相关代码需要特别注意
- 🟡 第65行: [security_check] 密码相关代码需要特别注意
- 🟡 第102行: [function_length] 函数 async test_dynamic_permission_assignment 过长 (65 行)
- 🟡 第102行: [security_check] 令牌相关代码需要特别注意
- 🟡 第111行: [security_check] 令牌相关代码需要特别注意
- 🟡 第168行: [function_length] 函数 async test_role_based_access_control 过长 (156 行)
- 🟡 第168行: [security_check] 令牌相关代码需要特别注意
- 🟡 第197行: [security_check] 令牌相关代码需要特别注意
- 🟡 第210行: [security_check] 密码相关代码需要特别注意
- 🟡 第217行: [security_check] 密码相关代码需要特别注意
- 🟡 第292行: [security_check] 密码相关代码需要特别注意
- 🟡 第296行: [security_check] 令牌相关代码需要特别注意
- 🟡 第300行: [security_check] 密码相关代码需要特别注意
- 🟡 第304行: [security_check] 令牌相关代码需要特别注意
- 🟡 第308行: [security_check] 令牌相关代码需要特别注意
- 🟡 第316行: [security_check] 令牌相关代码需要特别注意
- 🟡 第325行: [security_check] 令牌相关代码需要特别注意
- 🟡 第335行: [security_check] 令牌相关代码需要特别注意
- 🟡 第344行: [security_check] 密码相关代码需要特别注意
- 🟡 第351行: [security_check] 密码相关代码需要特别注意
- 🟡 第380行: [security_check] 密码相关代码需要特别注意
- 🟡 第383行: [security_check] 令牌相关代码需要特别注意
- 🟡 第387行: [security_check] 密码相关代码需要特别注意
- 🟡 第390行: [security_check] 令牌相关代码需要特别注意
- 🟡 第393行: [security_check] 令牌相关代码需要特别注意
- 🟡 第422行: [security_check] 令牌相关代码需要特别注意

### 📄 test/integration/test_role_permission.py
- 🔵 第8行: [unused_import] 可能未使用的导入: AsyncClient
- 🔵 第10行: [unused_import] 可能未使用的导入: app
- 🟡 第15行: [security_check] 令牌相关代码需要特别注意
- 🟡 第18行: [security_check] 令牌相关代码需要特别注意
- 🟡 第35行: [security_check] 令牌相关代码需要特别注意
- 🟡 第38行: [security_check] 令牌相关代码需要特别注意
- 🟡 第54行: [security_check] 令牌相关代码需要特别注意
- 🟡 第57行: [security_check] 令牌相关代码需要特别注意
- 🟡 第73行: [security_check] 令牌相关代码需要特别注意
- 🟡 第81行: [security_check] 令牌相关代码需要特别注意
- 🟡 第104行: [security_check] 令牌相关代码需要特别注意
- 🟡 第112行: [security_check] 令牌相关代码需要特别注意
- 🟡 第135行: [security_check] 令牌相关代码需要特别注意
- 🟡 第138行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 令牌相关代码需要特别注意
- 🟡 第170行: [security_check] 令牌相关代码需要特别注意
- 🟡 第173行: [security_check] 令牌相关代码需要特别注意
- 🟡 第178行: [security_check] 令牌相关代码需要特别注意
- 🟡 第198行: [security_check] 令牌相关代码需要特别注意
- 🟡 第206行: [security_check] 密码相关代码需要特别注意
- 🟡 第217行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 令牌相关代码需要特别注意
- 🟡 第241行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [security_check] 密码相关代码需要特别注意
- 🟡 第254行: [security_check] 令牌相关代码需要特别注意

### 📄 test/performance/test_auth_performance.py
- 🟡 第13行: [security_check] 令牌相关代码需要特别注意
- 🟡 第78行: [security_check] 密码相关代码需要特别注意
- 🟡 第86行: [security_check] 密码相关代码需要特别注意
- 🟡 第87行: [security_check] 密码相关代码需要特别注意
- 🟡 第88行: [security_check] 密码相关代码需要特别注意
- 🟡 第91行: [security_check] 密码相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🟡 第129行: [security_check] 令牌相关代码需要特别注意
- 🟡 第132行: [security_check] 令牌相关代码需要特别注意
- 🟡 第133行: [security_check] 令牌相关代码需要特别注意
- 🟡 第134行: [security_check] 令牌相关代码需要特别注意
- 🟡 第141行: [security_check] 令牌相关代码需要特别注意
- 🟡 第164行: [security_check] 令牌相关代码需要特别注意
- 🟡 第179行: [security_check] 令牌相关代码需要特别注意
- 🟡 第183行: [security_check] 令牌相关代码需要特别注意
- 🟡 第215行: [security_check] 令牌相关代码需要特别注意
- 🟡 第216行: [security_check] 令牌相关代码需要特别注意
- 🟡 第221行: [security_check] 令牌相关代码需要特别注意
- 🟡 第239行: [function_length] 函数 async test_stress_test 过长 (58 行)
- 🟡 第242行: [security_check] 密码相关代码需要特别注意
- 🟡 第250行: [security_check] 密码相关代码需要特别注意
- 🟡 第251行: [security_check] 密码相关代码需要特别注意
- 🟡 第252行: [security_check] 密码相关代码需要特别注意
- 🟡 第261行: [security_check] 密码相关代码需要特别注意

### 📄 test/unit/observability/test_telemetry.py
- 🔵 第7行: [unused_import] 可能未使用的导入: AsyncMock

### 📄 test/unit/repository/test_audit_repository.py
- 🔵 第7行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第10行: [unused_import] 可能未使用的导入: patch

### 📄 test/unit/repository/test_oauth_repository.py
- 🔵 第9行: [unused_import] 可能未使用的导入: patch
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第44行: [security_check] 令牌相关代码需要特别注意
- 🟡 第62行: [security_check] 令牌相关代码需要特别注意
- 🟡 第63行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第80行: [security_check] 令牌相关代码需要特别注意
- 🟡 第100行: [security_check] 令牌相关代码需要特别注意
- 🟡 第116行: [security_check] 令牌相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🟡 第137行: [security_check] 令牌相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意

### 📄 test/unit/repository/test_token_repository.py
- 🟡 第1行: [file_length] 文件过长 (799 行)，建议拆分
- 🔵 第11行: [unused_import] 可能未使用的导入: patch
- 🟡 第15行: [security_check] 令牌相关代码需要特别注意
- 🟡 第16行: [security_check] 令牌相关代码需要特别注意
- 🟡 第32行: [security_check] 令牌相关代码需要特别注意
- 🟡 第34行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第41行: [security_check] 令牌相关代码需要特别注意
- 🟡 第44行: [security_check] 令牌相关代码需要特别注意
- 🟡 第45行: [security_check] 令牌相关代码需要特别注意
- 🟡 第51行: [security_check] 令牌相关代码需要特别注意
- 🟡 第58行: [security_check] 令牌相关代码需要特别注意
- 🟡 第65行: [security_check] 令牌相关代码需要特别注意
- 🟡 第66行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 令牌相关代码需要特别注意
- 🟡 第73行: [security_check] 令牌相关代码需要特别注意
- 🟡 第74行: [security_check] 令牌相关代码需要特别注意
- 🟡 第79行: [security_check] 令牌相关代码需要特别注意
- 🟡 第86行: [security_check] 令牌相关代码需要特别注意
- 🟡 第95行: [security_check] 令牌相关代码需要特别注意
- 🟡 第98行: [security_check] 令牌相关代码需要特别注意
- 🟡 第99行: [security_check] 令牌相关代码需要特别注意
- 🟡 第104行: [security_check] 令牌相关代码需要特别注意
- 🟡 第111行: [security_check] 令牌相关代码需要特别注意
- 🟡 第120行: [security_check] 令牌相关代码需要特别注意
- 🟡 第123行: [security_check] 令牌相关代码需要特别注意
- 🟡 第124行: [security_check] 令牌相关代码需要特别注意
- 🟡 第130行: [security_check] 令牌相关代码需要特别注意
- 🟡 第133行: [security_check] 令牌相关代码需要特别注意
- 🟡 第136行: [security_check] 令牌相关代码需要特别注意
- 🟡 第137行: [security_check] 令牌相关代码需要特别注意
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第149行: [security_check] 令牌相关代码需要特别注意
- 🟡 第152行: [security_check] 令牌相关代码需要特别注意
- 🟡 第153行: [security_check] 令牌相关代码需要特别注意
- 🟡 第161行: [security_check] 令牌相关代码需要特别注意
- 🟡 第167行: [security_check] 令牌相关代码需要特别注意
- 🟡 第168行: [security_check] 令牌相关代码需要特别注意
- 🟡 第171行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第175行: [security_check] 令牌相关代码需要特别注意
- 🟡 第183行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第190行: [security_check] 令牌相关代码需要特别注意
- 🟡 第193行: [security_check] 令牌相关代码需要特别注意
- 🟡 第196行: [security_check] 令牌相关代码需要特别注意
- 🟡 第197行: [security_check] 令牌相关代码需要特别注意
- 🟡 第205行: [security_check] 令牌相关代码需要特别注意
- 🟡 第211行: [security_check] 令牌相关代码需要特别注意
- 🟡 第212行: [security_check] 令牌相关代码需要特别注意
- 🟡 第215行: [security_check] 令牌相关代码需要特别注意
- 🟡 第218行: [security_check] 令牌相关代码需要特别注意
- 🟡 第219行: [security_check] 令牌相关代码需要特别注意
- 🟡 第223行: [security_check] 令牌相关代码需要特别注意
- 🟡 第226行: [security_check] 令牌相关代码需要特别注意
- 🟡 第229行: [security_check] 令牌相关代码需要特别注意
- 🟡 第230行: [security_check] 令牌相关代码需要特别注意
- 🟡 第236行: [security_check] 令牌相关代码需要特别注意
- 🟡 第237行: [security_check] 令牌相关代码需要特别注意
- 🟡 第243行: [security_check] 令牌相关代码需要特别注意
- 🟡 第247行: [security_check] 令牌相关代码需要特别注意
- 🟡 第250行: [security_check] 令牌相关代码需要特别注意
- 🟡 第251行: [security_check] 令牌相关代码需要特别注意
- 🟡 第258行: [security_check] 令牌相关代码需要特别注意
- 🟡 第259行: [security_check] 令牌相关代码需要特别注意
- 🟡 第265行: [security_check] 令牌相关代码需要特别注意
- 🟡 第268行: [security_check] 令牌相关代码需要特别注意
- 🟡 第269行: [security_check] 令牌相关代码需要特别注意
- 🟡 第276行: [security_check] 令牌相关代码需要特别注意
- 🟡 第279行: [security_check] 令牌相关代码需要特别注意
- 🟡 第282行: [security_check] 令牌相关代码需要特别注意
- 🟡 第283行: [security_check] 令牌相关代码需要特别注意
- 🟡 第291行: [security_check] 令牌相关代码需要特别注意
- 🟡 第297行: [security_check] 令牌相关代码需要特别注意
- 🟡 第298行: [security_check] 令牌相关代码需要特别注意
- 🟡 第300行: [security_check] 令牌相关代码需要特别注意
- 🟡 第304行: [security_check] 令牌相关代码需要特别注意
- 🟡 第307行: [security_check] 令牌相关代码需要特别注意
- 🟡 第310行: [security_check] 令牌相关代码需要特别注意
- 🟡 第311行: [security_check] 令牌相关代码需要特别注意
- 🟡 第319行: [security_check] 令牌相关代码需要特别注意
- 🟡 第325行: [security_check] 令牌相关代码需要特别注意
- 🟡 第326行: [security_check] 令牌相关代码需要特别注意
- 🟡 第328行: [security_check] 令牌相关代码需要特别注意
- 🟡 第336行: [security_check] 令牌相关代码需要特别注意
- 🟡 第339行: [security_check] 令牌相关代码需要特别注意
- 🟡 第340行: [security_check] 令牌相关代码需要特别注意
- 🟡 第344行: [security_check] 令牌相关代码需要特别注意
- 🟡 第347行: [security_check] 令牌相关代码需要特别注意
- 🟡 第350行: [security_check] 令牌相关代码需要特别注意
- 🟡 第351行: [security_check] 令牌相关代码需要特别注意
- 🟡 第357行: [security_check] 令牌相关代码需要特别注意
- 🟡 第363行: [security_check] 令牌相关代码需要特别注意
- 🟡 第368行: [security_check] 令牌相关代码需要特别注意
- 🟡 第371行: [security_check] 令牌相关代码需要特别注意
- 🟡 第372行: [security_check] 令牌相关代码需要特别注意
- 🟡 第379行: [security_check] 令牌相关代码需要特别注意
- 🟡 第382行: [security_check] 令牌相关代码需要特别注意
- 🟡 第386行: [security_check] 令牌相关代码需要特别注意
- 🟡 第389行: [security_check] 令牌相关代码需要特别注意
- 🟡 第392行: [security_check] 令牌相关代码需要特别注意
- 🟡 第395行: [security_check] 令牌相关代码需要特别注意
- 🟡 第396行: [security_check] 令牌相关代码需要特别注意
- 🟡 第399行: [security_check] 令牌相关代码需要特别注意
- 🟡 第405行: [security_check] 令牌相关代码需要特别注意
- 🟡 第406行: [security_check] 令牌相关代码需要特别注意
- 🟡 第408行: [security_check] 令牌相关代码需要特别注意
- 🟡 第409行: [security_check] 令牌相关代码需要特别注意
- 🟡 第412行: [security_check] 令牌相关代码需要特别注意
- 🟡 第413行: [security_check] 令牌相关代码需要特别注意
- 🟡 第414行: [security_check] 令牌相关代码需要特别注意
- 🟡 第415行: [security_check] 令牌相关代码需要特别注意
- 🟡 第418行: [security_check] 令牌相关代码需要特别注意
- 🟡 第421行: [security_check] 令牌相关代码需要特别注意
- 🟡 第430行: [security_check] 令牌相关代码需要特别注意
- 🟡 第433行: [security_check] 令牌相关代码需要特别注意
- 🟡 第434行: [security_check] 令牌相关代码需要特别注意
- 🟡 第437行: [security_check] 令牌相关代码需要特别注意
- 🟡 第443行: [security_check] 令牌相关代码需要特别注意
- 🟡 第444行: [security_check] 令牌相关代码需要特别注意
- 🟡 第446行: [security_check] 令牌相关代码需要特别注意
- 🟡 第447行: [security_check] 令牌相关代码需要特别注意
- 🟡 第450行: [security_check] 令牌相关代码需要特别注意
- 🟡 第453行: [security_check] 令牌相关代码需要特别注意
- 🟡 第463行: [security_check] 令牌相关代码需要特别注意
- 🟡 第466行: [security_check] 令牌相关代码需要特别注意
- 🟡 第475行: [security_check] 令牌相关代码需要特别注意
- 🟡 第488行: [security_check] 令牌相关代码需要特别注意
- 🟡 第501行: [security_check] 令牌相关代码需要特别注意
- 🟡 第504行: [security_check] 令牌相关代码需要特别注意
- 🟡 第515行: [security_check] 令牌相关代码需要特别注意
- 🟡 第524行: [security_check] 令牌相关代码需要特别注意
- 🟡 第535行: [security_check] 令牌相关代码需要特别注意
- 🟡 第544行: [security_check] 令牌相关代码需要特别注意
- 🟡 第555行: [security_check] 令牌相关代码需要特别注意
- 🟡 第564行: [security_check] 令牌相关代码需要特别注意
- 🟡 第576行: [security_check] 令牌相关代码需要特别注意
- 🟡 第579行: [security_check] 令牌相关代码需要特别注意
- 🟡 第586行: [security_check] 令牌相关代码需要特别注意
- 🟡 第595行: [security_check] 令牌相关代码需要特别注意
- 🟡 第606行: [security_check] 令牌相关代码需要特别注意
- 🟡 第609行: [security_check] 令牌相关代码需要特别注意
- 🟡 第621行: [security_check] 令牌相关代码需要特别注意
- 🟡 第634行: [security_check] 令牌相关代码需要特别注意
- 🟡 第651行: [security_check] 令牌相关代码需要特别注意
- 🟡 第664行: [security_check] 令牌相关代码需要特别注意
- 🟡 第681行: [security_check] 令牌相关代码需要特别注意
- 🟡 第694行: [security_check] 令牌相关代码需要特别注意
- 🟡 第711行: [security_check] 令牌相关代码需要特别注意
- 🟡 第724行: [security_check] 令牌相关代码需要特别注意
- 🟡 第737行: [security_check] 令牌相关代码需要特别注意
- 🟡 第740行: [security_check] 令牌相关代码需要特别注意
- 🟡 第753行: [security_check] 令牌相关代码需要特别注意
- 🟡 第759行: [security_check] 令牌相关代码需要特别注意
- 🟡 第760行: [security_check] 令牌相关代码需要特别注意
- 🟡 第763行: [security_check] 令牌相关代码需要特别注意
- 🟡 第769行: [security_check] 令牌相关代码需要特别注意
- 🟡 第778行: [security_check] 令牌相关代码需要特别注意
- 🟡 第781行: [security_check] 令牌相关代码需要特别注意
- 🟡 第784行: [security_check] 令牌相关代码需要特别注意
- 🟡 第785行: [security_check] 令牌相关代码需要特别注意
- 🟡 第789行: [security_check] 令牌相关代码需要特别注意
- 🟡 第793行: [security_check] 令牌相关代码需要特别注意
- 🟡 第796行: [security_check] 令牌相关代码需要特别注意

### 📄 test/unit/repository/test_user_repository.py
- 🟡 第50行: [security_check] 密码相关代码需要特别注意
- 🟡 第61行: [security_check] 密码相关代码需要特别注意
- 🟡 第81行: [security_check] 密码相关代码需要特别注意
- 🟡 第89行: [security_check] 密码相关代码需要特别注意
- 🟡 第102行: [security_check] 密码相关代码需要特别注意
- 🟡 第110行: [security_check] 密码相关代码需要特别注意
- 🟡 第123行: [security_check] 密码相关代码需要特别注意
- 🟡 第130行: [security_check] 密码相关代码需要特别注意
- 🟡 第232行: [security_check] 密码相关代码需要特别注意
- 🟡 第238行: [security_check] 密码相关代码需要特别注意
- 🟡 第244行: [security_check] 密码相关代码需要特别注意
- 🟡 第253行: [security_check] 密码相关代码需要特别注意
- 🟡 第259行: [security_check] 密码相关代码需要特别注意
- 🟡 第266行: [security_check] 密码相关代码需要特别注意
- 🟡 第269行: [security_check] 密码相关代码需要特别注意
- 🟡 第275行: [security_check] 密码相关代码需要特别注意
- 🟡 第282行: [security_check] 密码相关代码需要特别注意
- 🟡 第292行: [security_check] 密钥相关代码需要特别注意
- 🟡 第298行: [security_check] 密钥相关代码需要特别注意

### 📄 test/unit/repository/test_user_repository_extended.py
- 🔵 第4行: [unused_import] 可能未使用的导入: MagicMock
- 🔵 第4行: [unused_import] 可能未使用的导入: patch
- 🔵 第8行: [unused_import] 可能未使用的导入: Role
- 🔵 第8行: [unused_import] 可能未使用的导入: Permission
- 🟡 第58行: [security_check] 密码相关代码需要特别注意
- 🟡 第73行: [security_check] 密钥相关代码需要特别注意

### 📄 test/unit/repository/test_user_repository_mock.py
- 🟡 第1行: [file_length] 文件过长 (520 行)，建议拆分
- 🔵 第4行: [unused_import] 可能未使用的导入: MagicMock
- 🔵 第4行: [unused_import] 可能未使用的导入: patch
- 🔵 第5行: [unused_import] 可能未使用的导入: datetime
- 🔵 第5行: [unused_import] 可能未使用的导入: timedelta
- 🔵 第5行: [unused_import] 可能未使用的导入: UTC
- 🔵 第10行: [unused_import] 可能未使用的导入: Role
- 🔵 第10行: [unused_import] 可能未使用的导入: Permission
- 🟡 第411行: [security_check] 密钥相关代码需要特别注意

### 📄 test/unit/security/test_jwt.py
- 🔵 第8行: [unused_import] 可能未使用的导入: MagicMock
- 🟡 第24行: [security_check] 密钥相关代码需要特别注意
- 🟡 第26行: [security_check] 令牌相关代码需要特别注意
- 🟡 第27行: [security_check] 令牌相关代码需要特别注意
- 🟡 第32行: [security_check] 密钥相关代码需要特别注意
- 🟡 第34行: [security_check] 令牌相关代码需要特别注意
- 🟡 第35行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 令牌相关代码需要特别注意
- 🟡 第40行: [security_check] 令牌相关代码需要特别注意
- 🟡 第43行: [security_check] 密钥相关代码需要特别注意
- 🟡 第43行: [security_check] 令牌相关代码需要特别注意
- 🟡 第51行: [security_check] 令牌相关代码需要特别注意
- 🟡 第55行: [security_check] 令牌相关代码需要特别注意
- 🟡 第58行: [security_check] 密钥相关代码需要特别注意
- 🟡 第58行: [security_check] 令牌相关代码需要特别注意
- 🟡 第65行: [security_check] 令牌相关代码需要特别注意
- 🟡 第69行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 密钥相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第77行: [security_check] 令牌相关代码需要特别注意
- 🟡 第80行: [security_check] 令牌相关代码需要特别注意
- 🟡 第83行: [security_check] 密钥相关代码需要特别注意
- 🟡 第83行: [security_check] 令牌相关代码需要特别注意
- 🟡 第91行: [security_check] 令牌相关代码需要特别注意
- 🟡 第94行: [security_check] 令牌相关代码需要特别注意
- 🟡 第96行: [security_check] 令牌相关代码需要特别注意
- 🟡 第101行: [security_check] 令牌相关代码需要特别注意
- 🟡 第106行: [security_check] 令牌相关代码需要特别注意
- 🟡 第109行: [security_check] 令牌相关代码需要特别注意
- 🟡 第111行: [security_check] 令牌相关代码需要特别注意
- 🟡 第114行: [security_check] 令牌相关代码需要特别注意
- 🟡 第117行: [security_check] 令牌相关代码需要特别注意
- 🟡 第119行: [security_check] 密钥相关代码需要特别注意
- 🟡 第120行: [security_check] 令牌相关代码需要特别注意
- 🟡 第121行: [security_check] 令牌相关代码需要特别注意
- 🟡 第124行: [security_check] 令牌相关代码需要特别注意
- 🟡 第127行: [security_check] 令牌相关代码需要特别注意
- 🟡 第129行: [security_check] 令牌相关代码需要特别注意
- 🟡 第132行: [security_check] 令牌相关代码需要特别注意
- 🟡 第134行: [security_check] 令牌相关代码需要特别注意
- 🟡 第137行: [security_check] 令牌相关代码需要特别注意
- 🟡 第139行: [security_check] 令牌相关代码需要特别注意
- 🟡 第142行: [security_check] 密钥相关代码需要特别注意
- 🟡 第142行: [security_check] 令牌相关代码需要特别注意
- 🟡 第146行: [security_check] 令牌相关代码需要特别注意
- 🟡 第149行: [security_check] 令牌相关代码需要特别注意
- 🟡 第152行: [security_check] 令牌相关代码需要特别注意
- 🟡 第154行: [security_check] 令牌相关代码需要特别注意
- 🟡 第157行: [security_check] 令牌相关代码需要特别注意
- 🟡 第159行: [security_check] 令牌相关代码需要特别注意
- 🟡 第170行: [security_check] 密钥相关代码需要特别注意
- 🟡 第171行: [security_check] 令牌相关代码需要特别注意
- 🟡 第172行: [security_check] 令牌相关代码需要特别注意
- 🟡 第174行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第179行: [security_check] 令牌相关代码需要特别注意
- 🟡 第182行: [security_check] 密钥相关代码需要特别注意
- 🟡 第182行: [security_check] 令牌相关代码需要特别注意
- 🟡 第185行: [security_check] 令牌相关代码需要特别注意
- 🟡 第187行: [security_check] 令牌相关代码需要特别注意
- 🟡 第190行: [security_check] 令牌相关代码需要特别注意
- 🟡 第193行: [security_check] 密钥相关代码需要特别注意
- 🟡 第193行: [security_check] 令牌相关代码需要特别注意
- 🟡 第197行: [security_check] 令牌相关代码需要特别注意
- 🟡 第199行: [security_check] 令牌相关代码需要特别注意
- 🟡 第202行: [security_check] 令牌相关代码需要特别注意
- 🟡 第204行: [security_check] 令牌相关代码需要特别注意
- 🟡 第207行: [security_check] 令牌相关代码需要特别注意
- 🟡 第209行: [security_check] 令牌相关代码需要特别注意
- 🟡 第216行: [security_check] 令牌相关代码需要特别注意
- 🟡 第221行: [security_check] 密钥相关代码需要特别注意
- 🟡 第221行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 密钥相关代码需要特别注意
- 🟡 第228行: [security_check] 令牌相关代码需要特别注意

### 📄 test/unit/security/test_jwt_manager.py
- 🟡 第27行: [security_check] 密钥相关代码需要特别注意
- 🟡 第114行: [security_check] 密钥相关代码需要特别注意
- 🟡 第120行: [security_check] 密钥相关代码需要特别注意
- 🟡 第137行: [security_check] 密钥相关代码需要特别注意
- 🟡 第143行: [security_check] 密钥相关代码需要特别注意

### 📄 test/unit/security/test_mfa.py
- 🟡 第15行: [security_check] 密钥相关代码需要特别注意
- 🟡 第28行: [security_check] 密钥相关代码需要特别注意
- 🟡 第31行: [security_check] 密钥相关代码需要特别注意
- 🟡 第34行: [security_check] 密钥相关代码需要特别注意
- 🟡 第35行: [security_check] 密钥相关代码需要特别注意
- 🟡 第36行: [security_check] 密钥相关代码需要特别注意
- 🟡 第39行: [security_check] 密钥相关代码需要特别注意
- 🟡 第44行: [security_check] 密钥相关代码需要特别注意
- 🟡 第49行: [security_check] 密钥相关代码需要特别注意
- 🟡 第66行: [security_check] 密钥相关代码需要特别注意
- 🟡 第69行: [security_check] 密钥相关代码需要特别注意
- 🟡 第75行: [security_check] 密钥相关代码需要特别注意
- 🟡 第79行: [security_check] 密钥相关代码需要特别注意
- 🟡 第109行: [security_check] 密钥相关代码需要特别注意
- 🟡 第125行: [security_check] 密钥相关代码需要特别注意
- 🟡 第140行: [security_check] 密钥相关代码需要特别注意
- 🟡 第161行: [security_check] 密钥相关代码需要特别注意
- 🟡 第164行: [security_check] 密钥相关代码需要特别注意
- 🟡 第168行: [security_check] 密钥相关代码需要特别注意
- 🟡 第175行: [security_check] 密钥相关代码需要特别注意
- 🟡 第181行: [security_check] 密钥相关代码需要特别注意
- 🟡 第187行: [security_check] 密钥相关代码需要特别注意
- 🟡 第192行: [security_check] 密钥相关代码需要特别注意

### 📄 test/unit/security/test_password.py
- 🟡 第9行: [security_check] 密码相关代码需要特别注意
- 🟡 第10行: [security_check] 密码相关代码需要特别注意
- 🟡 第11行: [security_check] 密码相关代码需要特别注意
- 🟡 第12行: [security_check] 密码相关代码需要特别注意
- 🟡 第13行: [security_check] 密码相关代码需要特别注意
- 🟡 第14行: [security_check] 密码相关代码需要特别注意
- 🟡 第16行: [security_check] 密码相关代码需要特别注意
- 🟡 第19行: [security_check] 密码相关代码需要特别注意
- 🟡 第22行: [security_check] 密码相关代码需要特别注意
- 🟡 第25行: [security_check] 密码相关代码需要特别注意
- 🟡 第26行: [security_check] 密码相关代码需要特别注意
- 🟡 第29行: [security_check] 密码相关代码需要特别注意
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🟡 第38行: [security_check] 密码相关代码需要特别注意
- 🟡 第42行: [security_check] 密码相关代码需要特别注意
- 🟡 第45行: [security_check] 密码相关代码需要特别注意
- 🟡 第46行: [security_check] 密码相关代码需要特别注意
- 🟡 第47行: [security_check] 密码相关代码需要特别注意
- 🟡 第49行: [function_length] 函数 test_password_policy_validation 过长 (64 行)
- 🟡 第49行: [security_check] 密码相关代码需要特别注意
- 🟡 第61行: [security_check] 密码相关代码需要特别注意
- 🟡 第62行: [security_check] 密码相关代码需要特别注意
- 🟡 第67行: [security_check] 密码相关代码需要特别注意
- 🟡 第68行: [security_check] 密码相关代码需要特别注意
- 🟡 第73行: [security_check] 密码相关代码需要特别注意
- 🟡 第74行: [security_check] 密码相关代码需要特别注意
- 🟡 第79行: [security_check] 密码相关代码需要特别注意
- 🟡 第80行: [security_check] 密码相关代码需要特别注意
- 🟡 第85行: [security_check] 密码相关代码需要特别注意
- 🟡 第86行: [security_check] 密码相关代码需要特别注意
- 🟡 第91行: [security_check] 密码相关代码需要特别注意
- 🟡 第92行: [security_check] 密码相关代码需要特别注意
- 🟡 第98行: [security_check] 密码相关代码需要特别注意
- 🟡 第103行: [security_check] 密码相关代码需要特别注意
- 🟡 第105行: [security_check] 密码相关代码需要特别注意
- 🟡 第109行: [security_check] 密码相关代码需要特别注意
- 🟡 第110行: [security_check] 密码相关代码需要特别注意
- 🟡 第113行: [security_check] 密码相关代码需要特别注意
- 🟡 第125行: [security_check] 密码相关代码需要特别注意
- 🟡 第126行: [security_check] 密码相关代码需要特别注意
- 🟡 第129行: [security_check] 密码相关代码需要特别注意
- 🟡 第130行: [security_check] 密码相关代码需要特别注意
- 🟡 第131行: [security_check] 密码相关代码需要特别注意
- 🟡 第137行: [security_check] 密码相关代码需要特别注意
- 🟡 第139行: [security_check] 密码相关代码需要特别注意
- 🟡 第142行: [security_check] 密码相关代码需要特别注意
- 🟡 第143行: [security_check] 密码相关代码需要特别注意
- 🟡 第146行: [security_check] 密码相关代码需要特别注意
- 🟡 第147行: [security_check] 密码相关代码需要特别注意
- 🟡 第148行: [security_check] 密码相关代码需要特别注意
- 🟡 第149行: [security_check] 密码相关代码需要特别注意
- 🟡 第152行: [security_check] 密码相关代码需要特别注意
- 🟡 第153行: [security_check] 密码相关代码需要特别注意
- 🟡 第156行: [security_check] 密码相关代码需要特别注意
- 🟡 第158行: [security_check] 密码相关代码需要特别注意

### 📄 test/unit/service/test_auth_service.py
- 🟡 第1行: [file_length] 文件过长 (875 行)，建议拆分
- 🟡 第23行: [security_check] 令牌相关代码需要特别注意
- 🟡 第25行: [security_check] 令牌相关代码需要特别注意
- 🟡 第28行: [security_check] 密码相关代码需要特别注意
- 🟡 第29行: [security_check] 令牌相关代码需要特别注意
- 🟡 第36行: [security_check] 密码相关代码需要特别注意
- 🟡 第37行: [security_check] 密码相关代码需要特别注意
- 🟡 第54行: [security_check] 密码相关代码需要特别注意
- 🟡 第59行: [security_check] 密钥相关代码需要特别注意
- 🟡 第65行: [security_check] 令牌相关代码需要特别注意
- 🟡 第67行: [security_check] 令牌相关代码需要特别注意
- 🟡 第68行: [security_check] 令牌相关代码需要特别注意
- 🟡 第69行: [security_check] 令牌相关代码需要特别注意
- 🟡 第70行: [security_check] 令牌相关代码需要特别注意
- 🟡 第71行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第73行: [security_check] 令牌相关代码需要特别注意
- 🟡 第74行: [security_check] 令牌相关代码需要特别注意
- 🟡 第78行: [security_check] 令牌相关代码需要特别注意
- 🟡 第81行: [security_check] 令牌相关代码需要特别注意
- 🟡 第88行: [security_check] 密码相关代码需要特别注意
- 🟡 第93行: [security_check] 令牌相关代码需要特别注意
- 🟡 第94行: [security_check] 令牌相关代码需要特别注意
- 🟡 第95行: [security_check] 令牌相关代码需要特别注意
- 🟡 第96行: [security_check] 令牌相关代码需要特别注意
- 🟡 第97行: [security_check] 令牌相关代码需要特别注意
- 🟡 第100行: [security_check] 令牌相关代码需要特别注意
- 🟡 第101行: [security_check] 令牌相关代码需要特别注意
- 🟡 第103行: [security_check] 令牌相关代码需要特别注意
- 🟡 第115行: [security_check] 令牌相关代码需要特别注意
- 🟡 第120行: [security_check] 密码相关代码需要特别注意
- 🟡 第124行: [security_check] 密码相关代码需要特别注意
- 🟡 第132行: [security_check] 密码相关代码需要特别注意
- 🟡 第136行: [security_check] 密码相关代码需要特别注意
- 🟡 第139行: [security_check] 密码相关代码需要特别注意
- 🟡 第147行: [security_check] 密码相关代码需要特别注意
- 🟡 第151行: [security_check] 密码相关代码需要特别注意
- 🟡 第154行: [security_check] 密码相关代码需要特别注意
- 🟡 第159行: [security_check] 密码相关代码需要特别注意
- 🟡 第162行: [security_check] 密码相关代码需要特别注意
- 🟡 第165行: [security_check] 密码相关代码需要特别注意
- 🟡 第166行: [security_check] 密码相关代码需要特别注意
- 🟡 第169行: [security_check] 令牌相关代码需要特别注意
- 🟡 第173行: [security_check] 令牌相关代码需要特别注意
- 🟡 第176行: [security_check] 令牌相关代码需要特别注意
- 🟡 第179行: [security_check] 令牌相关代码需要特别注意
- 🟡 第180行: [security_check] 令牌相关代码需要特别注意
- 🟡 第183行: [security_check] 密钥相关代码需要特别注意
- 🟡 第183行: [security_check] 令牌相关代码需要特别注意
- 🟡 第189行: [security_check] 令牌相关代码需要特别注意
- 🟡 第193行: [security_check] 令牌相关代码需要特别注意
- 🟡 第196行: [security_check] 密钥相关代码需要特别注意
- 🟡 第196行: [security_check] 令牌相关代码需要特别注意
- 🟡 第204行: [security_check] 令牌相关代码需要特别注意
- 🟡 第206行: [security_check] 令牌相关代码需要特别注意
- 🟡 第209行: [security_check] 令牌相关代码需要特别注意
- 🟡 第213行: [security_check] 令牌相关代码需要特别注意
- 🟡 第217行: [security_check] 令牌相关代码需要特别注意
- 🟡 第218行: [security_check] 令牌相关代码需要特别注意
- 🟡 第222行: [security_check] 令牌相关代码需要特别注意
- 🟡 第224行: [security_check] 令牌相关代码需要特别注意
- 🟡 第227行: [security_check] 令牌相关代码需要特别注意
- 🟡 第228行: [security_check] 令牌相关代码需要特别注意
- 🟡 第229行: [security_check] 令牌相关代码需要特别注意
- 🟡 第230行: [security_check] 令牌相关代码需要特别注意
- 🟡 第231行: [security_check] 令牌相关代码需要特别注意
- 🟡 第234行: [security_check] 密钥相关代码需要特别注意
- 🟡 第234行: [security_check] 令牌相关代码需要特别注意
- 🟡 第239行: [security_check] 令牌相关代码需要特别注意
- 🟡 第242行: [security_check] 令牌相关代码需要特别注意
- 🟡 第246行: [security_check] 令牌相关代码需要特别注意
- 🟡 第249行: [security_check] 令牌相关代码需要特别注意
- 🟡 第260行: [security_check] 令牌相关代码需要特别注意
- 🟡 第263行: [security_check] 令牌相关代码需要特别注意
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 密钥相关代码需要特别注意
- 🟡 第270行: [security_check] 令牌相关代码需要特别注意
- 🟡 第273行: [security_check] 令牌相关代码需要特别注意
- 🟡 第283行: [security_check] 密码相关代码需要特别注意
- 🟡 第284行: [security_check] 密码相关代码需要特别注意
- 🟡 第295行: [security_check] 密码相关代码需要特别注意
- 🟡 第298行: [security_check] 密码相关代码需要特别注意
- 🟡 第299行: [security_check] 密码相关代码需要特别注意
- 🟡 第317行: [security_check] 密码相关代码需要特别注意
- 🟡 第318行: [security_check] 密码相关代码需要特别注意
- 🟡 第333行: [security_check] 密码相关代码需要特别注意
- 🟡 第349行: [security_check] 密码相关代码需要特别注意
- 🟡 第350行: [security_check] 密码相关代码需要特别注意
- 🟡 第363行: [security_check] 密钥相关代码需要特别注意
- 🟡 第369行: [security_check] 密钥相关代码需要特别注意
- 🟡 第378行: [security_check] 密钥相关代码需要特别注意
- 🟡 第387行: [security_check] 密钥相关代码需要特别注意
- 🟡 第398行: [security_check] 密钥相关代码需要特别注意
- 🟡 第407行: [security_check] 密钥相关代码需要特别注意
- 🟡 第435行: [security_check] 密钥相关代码需要特别注意
- 🟡 第447行: [security_check] 密钥相关代码需要特别注意
- 🟡 第462行: [security_check] 密码相关代码需要特别注意
- 🟡 第466行: [security_check] 密码相关代码需要特别注意
- 🟡 第468行: [security_check] 令牌相关代码需要特别注意
- 🟡 第469行: [security_check] 令牌相关代码需要特别注意
- 🟡 第471行: [security_check] 密码相关代码需要特别注意
- 🟡 第480行: [security_check] 令牌相关代码需要特别注意
- 🟡 第482行: [security_check] 密码相关代码需要特别注意
- 🟡 第484行: [security_check] 令牌相关代码需要特别注意
- 🟡 第485行: [security_check] 令牌相关代码需要特别注意
- 🟡 第486行: [security_check] 令牌相关代码需要特别注意
- 🟡 第492行: [security_check] 密码相关代码需要特别注意
- 🟡 第497行: [security_check] 密码相关代码需要特别注意
- 🟡 第506行: [security_check] 密码相关代码需要特别注意
- 🟡 第509行: [security_check] 令牌相关代码需要特别注意
- 🟡 第511行: [security_check] 密码相关代码需要特别注意
- 🟡 第514行: [security_check] 密钥相关代码需要特别注意
- 🟡 第514行: [security_check] 令牌相关代码需要特别注意
- 🟡 第517行: [security_check] 密码相关代码需要特别注意
- 🟡 第518行: [security_check] 密码相关代码需要特别注意
- 🟡 第518行: [security_check] 令牌相关代码需要特别注意
- 🟡 第524行: [security_check] 密码相关代码需要特别注意
- 🟡 第525行: [security_check] 密码相关代码需要特别注意
- 🟡 第529行: [security_check] 令牌相关代码需要特别注意
- 🟡 第532行: [security_check] 密码相关代码需要特别注意
- 🟡 第532行: [security_check] 令牌相关代码需要特别注意
- 🟡 第535行: [security_check] 密码相关代码需要特别注意
- 🟡 第535行: [security_check] 令牌相关代码需要特别注意
- 🟡 第538行: [security_check] 密码相关代码需要特别注意
- 🟡 第538行: [security_check] 令牌相关代码需要特别注意
- 🟡 第541行: [security_check] 令牌相关代码需要特别注意
- 🟡 第543行: [security_check] 密码相关代码需要特别注意
- 🟡 第543行: [security_check] 令牌相关代码需要特别注意
- 🟡 第546行: [security_check] 密钥相关代码需要特别注意
- 🟡 第546行: [security_check] 令牌相关代码需要特别注意
- 🟡 第549行: [security_check] 密码相关代码需要特别注意
- 🟡 第549行: [security_check] 令牌相关代码需要特别注意
- 🟡 第564行: [security_check] 令牌相关代码需要特别注意
- 🟡 第602行: [security_check] 密码相关代码需要特别注意
- 🟡 第610行: [security_check] 令牌相关代码需要特别注意
- 🟡 第611行: [security_check] 令牌相关代码需要特别注意
- 🟡 第627行: [security_check] 密码相关代码需要特别注意
- 🟡 第635行: [security_check] 密码相关代码需要特别注意
- 🟡 第636行: [security_check] 密码相关代码需要特别注意
- 🟡 第637行: [security_check] 密码相关代码需要特别注意
- 🟡 第640行: [security_check] 密码相关代码需要特别注意
- 🟡 第647行: [security_check] 密码相关代码需要特别注意
- 🟡 第650行: [security_check] 密码相关代码需要特别注意
- 🟡 第658行: [security_check] 密码相关代码需要特别注意
- 🟡 第659行: [security_check] 密码相关代码需要特别注意
- 🟡 第660行: [security_check] 密码相关代码需要特别注意
- 🟡 第663行: [security_check] 密码相关代码需要特别注意
- 🟡 第664行: [security_check] 密码相关代码需要特别注意
- 🟡 第678行: [security_check] 密码相关代码需要特别注意
- 🟡 第694行: [security_check] 密码相关代码需要特别注意
- 🟡 第697行: [security_check] 令牌相关代码需要特别注意
- 🟡 第699行: [security_check] 令牌相关代码需要特别注意
- 🟡 第700行: [security_check] 令牌相关代码需要特别注意
- 🟡 第702行: [security_check] 令牌相关代码需要特别注意
- 🟡 第704行: [security_check] 令牌相关代码需要特别注意
- 🟡 第705行: [security_check] 令牌相关代码需要特别注意
- 🟡 第706行: [security_check] 令牌相关代码需要特别注意
- 🟡 第711行: [security_check] 令牌相关代码需要特别注意
- 🟡 第714行: [security_check] 令牌相关代码需要特别注意
- 🟡 第719行: [security_check] 令牌相关代码需要特别注意
- 🟡 第721行: [security_check] 令牌相关代码需要特别注意
- 🟡 第724行: [security_check] 令牌相关代码需要特别注意
- 🟡 第732行: [security_check] 令牌相关代码需要特别注意
- 🟡 第733行: [security_check] 令牌相关代码需要特别注意
- 🟡 第736行: [security_check] 令牌相关代码需要特别注意
- 🟡 第739行: [security_check] 令牌相关代码需要特别注意
- 🟡 第751行: [security_check] 令牌相关代码需要特别注意
- 🟡 第752行: [security_check] 令牌相关代码需要特别注意
- 🟡 第753行: [security_check] 令牌相关代码需要特别注意
- 🟡 第757行: [security_check] 令牌相关代码需要特别注意
- 🟡 第760行: [security_check] 令牌相关代码需要特别注意
- 🟡 第765行: [security_check] 令牌相关代码需要特别注意
- 🟡 第768行: [security_check] 令牌相关代码需要特别注意
- 🟡 第772行: [security_check] 令牌相关代码需要特别注意
- 🟡 第773行: [security_check] 令牌相关代码需要特别注意
- 🟡 第776行: [security_check] 令牌相关代码需要特别注意
- 🟡 第779行: [security_check] 令牌相关代码需要特别注意
- 🟡 第783行: [security_check] 令牌相关代码需要特别注意
- 🟡 第784行: [security_check] 令牌相关代码需要特别注意
- 🟡 第787行: [security_check] 令牌相关代码需要特别注意
- 🟡 第798行: [security_check] 令牌相关代码需要特别注意
- 🟡 第799行: [security_check] 令牌相关代码需要特别注意
- 🟡 第802行: [security_check] 令牌相关代码需要特别注意
- 🟡 第814行: [security_check] 令牌相关代码需要特别注意
- 🟡 第821行: [security_check] 令牌相关代码需要特别注意
- 🟡 第824行: [security_check] 令牌相关代码需要特别注意
- 🟡 第828行: [security_check] 令牌相关代码需要特别注意
- 🟡 第829行: [security_check] 令牌相关代码需要特别注意
- 🟡 第832行: [security_check] 令牌相关代码需要特别注意
- 🟡 第845行: [security_check] 令牌相关代码需要特别注意
- 🟡 第861行: [security_check] 密码相关代码需要特别注意
- 🟡 第864行: [security_check] 令牌相关代码需要特别注意
- 🟡 第871行: [security_check] 令牌相关代码需要特别注意
- 🟡 第872行: [security_check] 令牌相关代码需要特别注意
- 🟡 第874行: [security_check] 令牌相关代码需要特别注意
- 🟡 第875行: [security_check] 令牌相关代码需要特别注意

### 📄 test/unit/service/test_oauth_service.py
- 🟡 第1行: [file_length] 文件过长 (741 行)，建议拆分
- 🟡 第23行: [security_check] 令牌相关代码需要特别注意
- 🟡 第24行: [security_check] 令牌相关代码需要特别注意
- 🟡 第37行: [security_check] 密钥相关代码需要特别注意
- 🟡 第41行: [security_check] 令牌相关代码需要特别注意
- 🟡 第42行: [security_check] 令牌相关代码需要特别注意
- 🟡 第72行: [security_check] 令牌相关代码需要特别注意
- 🟡 第73行: [security_check] 令牌相关代码需要特别注意
- 🟡 第92行: [security_check] 令牌相关代码需要特别注意
- 🟡 第116行: [security_check] 令牌相关代码需要特别注意
- 🟡 第117行: [security_check] 令牌相关代码需要特别注意
- 🟡 第119行: [security_check] 令牌相关代码需要特别注意
- 🟡 第124行: [security_check] 令牌相关代码需要特别注意
- 🟡 第168行: [security_check] 令牌相关代码需要特别注意
- 🟡 第179行: [security_check] 令牌相关代码需要特别注意
- 🟡 第234行: [security_check] 令牌相关代码需要特别注意
- 🟡 第239行: [security_check] 令牌相关代码需要特别注意
- 🟡 第240行: [security_check] 令牌相关代码需要特别注意
- 🟡 第242行: [security_check] 令牌相关代码需要特别注意
- 🟡 第252行: [security_check] 令牌相关代码需要特别注意
- 🟡 第257行: [security_check] 令牌相关代码需要特别注意
- 🟡 第258行: [security_check] 令牌相关代码需要特别注意
- 🟡 第260行: [security_check] 令牌相关代码需要特别注意
- 🟡 第262行: [security_check] 令牌相关代码需要特别注意
- 🟡 第266行: [security_check] 令牌相关代码需要特别注意
- 🟡 第267行: [security_check] 令牌相关代码需要特别注意
- 🟡 第268行: [security_check] 令牌相关代码需要特别注意
- 🟡 第270行: [security_check] 令牌相关代码需要特别注意
- 🟡 第272行: [security_check] 令牌相关代码需要特别注意
- 🟡 第275行: [security_check] 令牌相关代码需要特别注意
- 🟡 第289行: [security_check] 令牌相关代码需要特别注意
- 🟡 第290行: [security_check] 令牌相关代码需要特别注意
- 🟡 第293行: [security_check] 令牌相关代码需要特别注意
- 🟡 第335行: [security_check] 令牌相关代码需要特别注意
- 🟡 第348行: [security_check] 令牌相关代码需要特别注意
- 🟡 第355行: [security_check] 令牌相关代码需要特别注意
- 🟡 第372行: [security_check] 令牌相关代码需要特别注意
- 🟡 第373行: [security_check] 令牌相关代码需要特别注意
- 🟡 第380行: [security_check] 令牌相关代码需要特别注意
- 🟡 第388行: [security_check] 令牌相关代码需要特别注意
- 🟡 第408行: [security_check] 令牌相关代码需要特别注意
- 🟡 第409行: [security_check] 令牌相关代码需要特别注意
- 🟡 第414行: [security_check] 令牌相关代码需要特别注意
- 🟡 第421行: [security_check] 令牌相关代码需要特别注意
- 🟡 第441行: [security_check] 令牌相关代码需要特别注意
- 🟡 第442行: [security_check] 令牌相关代码需要特别注意
- 🟡 第448行: [security_check] 令牌相关代码需要特别注意
- 🟡 第457行: [security_check] 令牌相关代码需要特别注意
- 🟡 第462行: [security_check] 令牌相关代码需要特别注意
- 🟡 第531行: [security_check] 令牌相关代码需要特别注意
- 🟡 第532行: [security_check] 令牌相关代码需要特别注意
- 🟡 第565行: [security_check] 令牌相关代码需要特别注意
- 🟡 第566行: [security_check] 令牌相关代码需要特别注意
- 🟡 第595行: [security_check] 令牌相关代码需要特别注意
- 🟡 第596行: [security_check] 令牌相关代码需要特别注意
- 🟡 第612行: [security_check] 令牌相关代码需要特别注意
- 🟡 第613行: [security_check] 令牌相关代码需要特别注意
- 🟡 第629行: [security_check] 令牌相关代码需要特别注意
- 🟡 第630行: [security_check] 令牌相关代码需要特别注意

### 📄 test/unit/service/test_user_service.py
- 🔵 第9行: [unused_import] 可能未使用的导入: patch
- 🟡 第14行: [security_check] 密码相关代码需要特别注意
- 🔵 第16行: [unused_import] 可能未使用的导入: UserResponse
- 🟡 第33行: [security_check] 密码相关代码需要特别注意
- 🟡 第35行: [security_check] 密码相关代码需要特别注意
- 🟡 第36行: [security_check] 密码相关代码需要特别注意
- 🟡 第37行: [security_check] 密码相关代码需要特别注意
- 🟡 第45行: [security_check] 令牌相关代码需要特别注意
- 🟡 第46行: [security_check] 令牌相关代码需要特别注意
- 🟡 第51行: [security_check] 密码相关代码需要特别注意
- 🟡 第55行: [security_check] 密码相关代码需要特别注意
- 🟡 第67行: [security_check] 密码相关代码需要特别注意
- 🟡 第98行: [security_check] 密码相关代码需要特别注意
- 🟡 第125行: [security_check] 密码相关代码需要特别注意
- 🟡 第148行: [security_check] 密码相关代码需要特别注意
- 🟡 第162行: [security_check] 密码相关代码需要特别注意
- 🟡 第168行: [security_check] 密码相关代码需要特别注意
- 🟡 第176行: [security_check] 密码相关代码需要特别注意
- 🟡 第186行: [security_check] 密码相关代码需要特别注意
- 🟡 第192行: [security_check] 密码相关代码需要特别注意
- 🟡 第196行: [security_check] 密码相关代码需要特别注意
- 🟡 第200行: [security_check] 密码相关代码需要特别注意
- 🟡 第204行: [security_check] 密码相关代码需要特别注意
- 🟡 第216行: [security_check] 密码相关代码需要特别注意
- 🟡 第231行: [security_check] 密码相关代码需要特别注意
- 🟡 第237行: [security_check] 密码相关代码需要特别注意
- 🟡 第245行: [security_check] 密码相关代码需要特别注意
- 🟡 第288行: [security_check] 令牌相关代码需要特别注意
- 🟡 第289行: [security_check] 令牌相关代码需要特别注意
- 🟡 第292行: [security_check] 密码相关代码需要特别注意
- 🟡 第292行: [security_check] 令牌相关代码需要特别注意
- 🟡 第295行: [security_check] 令牌相关代码需要特别注意
- 🟡 第296行: [security_check] 令牌相关代码需要特别注意
- 🟡 第297行: [security_check] 令牌相关代码需要特别注意
- 🟡 第300行: [security_check] 密码相关代码需要特别注意
- 🟡 第301行: [security_check] 令牌相关代码需要特别注意
- 🟡 第302行: [security_check] 令牌相关代码需要特别注意

### 📄 verify_completion.py
- 🔵 第10行: [unused_import] 可能未使用的导入: Path
- 🟡 第42行: [function_length] 函数 main 过长 (187 行)
- 🟡 第122行: [security_check] 密钥相关代码需要特别注意

## 🛠️ 修复建议

### 高优先级修复
- internal/model/i18n.py:551 - error
- internal/model/i18n.py:572 - error
- internal/security/password.py:38 - error
- internal/security/password.py:66 - error
- internal/repository/user_repository.py:10 - error
- internal/security/jwt.py:10 - error
- internal/security/jwt.py:135 - error
- internal/security/jwt.py:183 - error
- internal/security/jwt.py:189 - error
- internal/security/jwt.py:207 - error

### 代码质量改进建议
1. 修复所有 Flake8 代码风格问题
2. 添加类型注解，修复 MyPy 类型检查问题
3. 重构过长的函数和文件
4. 移除未使用的导入
5. 审查安全相关代码

## 🏆 代码质量评分: D (需要改进)
- 每千行代码问题数: 83.1