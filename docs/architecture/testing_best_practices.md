# 索克生活自动化测试规范与最佳实践

## 1. 测试分层
- **单元测试**：各模块/函数的最小粒度测试，Mock外部依赖。
- **集成测试**：模块间、服务间交互测试，覆盖健康数据流、AI推理链路、Agent协作等关键业务流。
- **端到端测试（E2E）**：模拟真实用户操作，覆盖前后端、微服务、Agent全链路。

---

## 2. 专项测试要求
- **健康数据专项**：模拟健康数据采集、处理、存储、回流全流程，验证数据一致性与异常处理。
- **AI推理专项**：Mock/集成AI推理服务，覆盖推理输入、输出、异常、性能等场景。
- **多Agent协作专项**：模拟多Agent任务分配、状态同步、冲突仲裁等全流程。

---

## 3. 覆盖率管理
- 配置Jest（前端）、pytest/coverage（后端）等工具，设定覆盖率阈值（建议80%以上）。
- 持续集成（CI）中强制检查覆盖率，未达标拒绝合并。
- 自动生成并归档`TEST_COVERAGE_REPORT.md`。

---

## 4. CI/CD集成建议
- PR流程自动运行单元、集成、E2E测试。
- 自动生成测试覆盖率报告，推送到指定目录或平台。
- 关键分支（如main/release）强制通过所有测试与覆盖率检查。

---

## 5. 目录与用例规范
- 前端：`src/__tests__/`，按模块分子目录，专项测试如`ai_inference/`、`health_data/`。
- 后端：各服务`tests/`下分`unit/`、`integration/`、专项测试子目录。
- 用例命名清晰，描述覆盖场景与预期。

---

## 6. 持续优化
- 定期补充新业务、新链路的专项测试。
- 结合可观测性体系，自动采集测试运行日志与指标。
- 推动测试左移，开发早期即介入自动化测试设计。 