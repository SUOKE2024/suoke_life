"""
generate_user_docs - 索克生活项目模块
"""

from pathlib import Path
import logging
import os

#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
索克生活 - 用户文档自动生成器
"""


logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
logger = logging.getLogger(__name__)

class UserDocGenerator:
    """用户文档生成器"""

    def __init__(self, project_root: str):
        self.project_root = Path(project_root)
        self.docs_dir = self.project_root / "docs" / "user"
        self.docs_dir.mkdir(parents=True, exist_ok=True)

    def generate_all_docs(self) -> bool:
        """生成所有用户文档"""
        logger.info("🚀 开始生成用户文档...")

        try:
            self.generate_user_guide()
            self.generate_agent_guide()
            self.generate_diagnosis_guide()
            self.generate_faq()

            logger.info("🎉 用户文档生成完成！")
            return True

        except Exception as e:
            logger.error(f"❌ 用户文档生成失败: {e}")
            return False

    def generate_user_guide(self):
        """生成用户使用指南"""
        content = """# 索克生活用户指南

## 欢迎使用索克生活

索克生活是一个由AI智能体驱动的现代化健康管理平台，将中医"辨证论治未病"的理念与现代预防医学技术相结合，为您提供个性化的全生命周期健康管理服务。

## 快速开始

### 1. 注册账户
1. 下载索克生活APP
2. 点击"注册"按钮
3. 输入手机号码获取验证码
4. 设置密码并完善个人信息
5. 完成健康档案初始化

### 2. 首次使用
1. **健康评估**: 完成基础健康问卷
2. **智能体介绍**: 了解四位AI健康助手
3. **功能导览**: 熟悉主要功能模块
4. **个性化设置**: 配置健康目标和提醒

## 主要功能

### 🏠 首页
- **健康概览**: 查看今日健康状态
- **智能推荐**: AI个性化健康建议
- **快速诊断**: 一键启动健康检测
- **消息中心**: 查看健康提醒和通知

### 👤 个人中心
- **健康档案**: 管理个人健康信息
- **诊断历史**: 查看历史诊断记录
- **健康报告**: 生成专业健康报告
- **设置中心**: 个性化配置选项

### 🔍 智能诊断
- **望诊**: 面部和舌象分析
- **闻诊**: 语音和呼吸检测
- **问诊**: 症状智能询问
- **切诊**: 脉象分析指导
- **综合诊断**: AI辨证论治

### 🤖 AI智能体
- **小艾**: 健康助手，24小时在线咨询
- **小克**: 数据分析师，健康趋势分析
- **老克**: 中医专家，传统医学指导
- **索儿**: 生活顾问，健康行为引导

### 📊 健康数据
- **生理指标**: 血压、心率、体重等
- **运动数据**: 步数、卡路里、运动时长
- **睡眠分析**: 睡眠质量和模式分析
- **营养记录**: 饮食摄入和营养分析

## 使用技巧

### 获得更准确的诊断
1. **环境准备**: 选择光线充足、安静的环境
2. **设备要求**: 确保摄像头和麦克风正常工作
3. **状态调整**: 保持放松，按照指导操作
4. **信息完整**: 如实填写症状和病史信息

### 与AI智能体互动
1. **清晰表达**: 用简洁明确的语言描述问题
2. **详细描述**: 提供充分的症状和背景信息
3. **及时反馈**: 对AI建议给予反馈，帮助优化
4. **持续对话**: 建立长期的健康管理关系

### 数据管理
1. **定期更新**: 及时记录健康数据变化
2. **数据同步**: 连接可穿戴设备自动同步
3. **隐私保护**: 了解数据使用和隐私政策
4. **备份导出**: 定期备份重要健康数据

## 注意事项

### ⚠️ 重要提醒
- 本平台提供的建议仅供参考，不能替代专业医疗诊断
- 如有严重症状或紧急情况，请立即就医
- 定期进行专业体检，配合平台使用效果更佳
- 保护个人隐私，不要分享账户信息

### 🔒 隐私安全
- 所有健康数据采用端到端加密
- 支持区块链技术保障数据不可篡改
- 严格遵循数据保护法规
- 用户完全控制数据使用权限

## 常见问题

### Q: 如何提高诊断准确性？
A: 
1. 确保良好的拍摄环境和设备状态
2. 按照系统指导完成各项检测
3. 提供详细准确的症状描述
4. 定期更新个人健康档案

### Q: AI智能体的建议可靠吗？
A: 
1. 基于大量医学数据和临床经验训练
2. 结合个人健康档案提供个性化建议
3. 持续学习和优化，准确性不断提升
4. 建议配合专业医疗意见使用

### Q: 如何保护我的健康数据？
A: 
1. 采用银行级加密技术保护数据
2. 支持本地存储，减少数据传输
3. 用户完全控制数据访问权限
4. 定期安全审计和漏洞修复

## 联系我们

- **客服热线**: 400-800-8888
- **在线客服**: APP内智能客服
- **邮箱支持**: support@suoke.life
- **官方网站**: https://www.suoke.life
- **微信公众号**: 索克生活

## 版本更新

### v1.0.0 (2025-06-06)
- 🎉 正式版发布
- ✨ 四大AI智能体上线
- 🔧 完整诊断流程
- 📱 移动端APP发布

---

*感谢您选择索克生活，让我们一起开启智慧健康新生活！*
"""

        with open(self.docs_dir / "user-guide.md", 'w', encoding='utf-8') as f:
            f.write(content)

        logger.info("✅ 用户使用指南生成完成")

    def generate_agent_guide(self):
        """生成智能体使用指南"""
        content = """# AI智能体使用指南

## 智能体概述

索克生活配备四位专业AI智能体，每位都有独特的专长和个性，为您提供全方位的健康管理服务。

## 🌟 小艾 - 健康助手

### 角色定位
- **身份**: 首席健康助手 & 首页聊天频道版主
- **专长**: 健康咨询、症状分析、用户引导
- **性格**: 温暖亲切、耐心细致、专业可靠

### 主要功能
1. **24小时在线咨询**
- 即时回答健康问题
- 症状初步分析
- 就医建议指导

2. **健康知识科普**
- 疾病预防知识
- 健康生活方式
- 医学常识解答

3. **用户引导服务**
- 新用户功能介绍
- 操作步骤指导
- 问题解决帮助

### 使用技巧
```
用户: "我最近总是感觉疲劳，是什么原因？"
小艾: "疲劳可能有多种原因，让我帮您分析一下。请问：
1. 疲劳持续多长时间了？
2. 是否伴有其他症状？
3. 最近睡眠质量如何？
4. 工作压力是否较大？
基于您的回答，我可以提供更准确的建议。"
```

## 📊 小克 - 数据分析师

### 角色定位
- **身份**: 健康数据分析师 & 个人健康档案管理员
- **专长**: 数据分析、趋势预测、健康评估
- **性格**: 理性严谨、逻辑清晰、数据驱动

### 主要功能
1. **健康数据分析**
- 生理指标趋势分析
- 异常数据识别
- 健康风险评估

2. **个性化报告**
- 周期性健康报告
- 数据可视化展示
- 改善建议制定

3. **档案管理**
- 健康档案维护
- 历史数据追踪
- 家族病史分析

### 使用技巧
```
用户: "帮我分析一下最近的血压数据"
小克: "根据您过去30天的血压数据分析：
📈 收缩压平均值: 128mmHg (正常高值)
📉 舒张压平均值: 82mmHg (正常)
⚠️ 发现3次血压偏高记录，建议：
1. 减少钠盐摄入
2. 增加有氧运动
3. 监测频率提高到每日2次
详细报告已生成，请查看健康档案。"
```

## 🏥 老克 - 中医专家

### 角色定位
- **身份**: 中医专家 & 辨证论治决策支持
- **专长**: 中医诊断、辨证论治、养生调理
- **性格**: 博学深沉、经验丰富、传统智慧

### 主要功能
1. **中医诊断**
- 望闻问切综合分析
- 体质辨识
- 证候判断

2. **辨证论治**
- 个性化治疗方案
- 中药调理建议
- 针灸推拿指导

3. **养生指导**
- 四季养生
- 饮食调理
- 运动养生

### 使用技巧
```
用户: "我经常失眠，中医怎么看？"
老克: "从中医角度分析您的失眠：
🔍 根据您的舌象和脉象，初步判断为心肾不交证
📋 主要表现：心烦失眠、腰膝酸软、五心烦热
🌿 调理建议：
1. 中药方剂：黄连阿胶汤加减
2. 食疗：百合莲子汤、酸枣仁粥
3. 穴位按摩：神门、三阴交、涌泉
4. 作息调理：子时前入睡，午时小憩
建议配合现代医学检查，综合调理效果更佳。"
```

## 🌱 索儿 - 生活顾问

### 角色定位
- **身份**: 生活方式顾问 & 健康行为引导师
- **专长**: 生活方式、行为改变、习惯养成
- **性格**: 活泼开朗、积极向上、富有创意

### 主要功能
1. **生活方式指导**
- 健康习惯培养
- 生活节奏调整
- 压力管理技巧

2. **行为改变支持**
- 目标设定与追踪
- 动机激励
- 习惯养成计划

3. **全方位生活建议**
- 饮食营养搭配
- 运动健身计划
- 心理健康维护

### 使用技巧
```
用户: "我想养成早起的习惯，但总是坚持不了"
索儿: "早起确实需要循序渐进！让我为您制定一个21天早起计划：
🌅 第1-7天：每天提前15分钟起床
⏰ 第8-14天：每天提前30分钟起床
🎯 第15-21天：达到目标起床时间

💡 成功秘诀：
1. 晚上提前30分钟睡觉
2. 设置渐进式闹钟
3. 起床后立即开灯
4. 准备喜欢的早餐作为奖励
5. 记录每日完成情况

我会每天提醒您，并根据执行情况调整计划。加油！💪"
```

## 智能体协作

### 多智能体联合诊断
当您的问题涉及多个领域时，四位智能体会协作为您提供综合建议：

```
场景：用户咨询"最近血压高，还经常头晕"

小艾: 初步接收问题，了解基本症状
↓
小克: 分析血压数据，识别异常模式
↓
老克: 从中医角度分析，判断证候类型
↓
索儿: 制定生活方式调整方案
↓
综合建议: 现代医学+传统中医+生活指导
```

### 智能体切换
您可以随时切换对话的智能体：
- 输入 `@小艾` 切换到小艾
- 输入 `@小克` 切换到小克  
- 输入 `@老克` 切换到老克
- 输入 `@索儿` 切换到索儿

## 最佳实践

### 1. 建立长期关系
- 定期与智能体交流，建立健康档案
- 及时反馈建议效果，帮助AI学习
- 保持开放态度，接受个性化建议

### 2. 充分利用专长
- 健康咨询找小艾
- 数据分析找小克
- 中医调理找老克
- 生活改善找索儿

### 3. 多角度咨询
- 同一问题可咨询多位智能体
- 对比不同角度的建议
- 选择最适合的解决方案

## 注意事项

### ⚠️ 使用限制
- AI建议仅供参考，不能替代医疗诊断
- 紧急情况请立即就医
- 定期进行专业体检
- 重大决策需咨询专业医生

### 🔄 持续优化
- 智能体会根据使用反馈持续学习
- 定期更新知识库和算法
- 个性化程度随使用时间提升
- 欢迎提供改进建议

---

*四位AI智能体期待与您一起，开启个性化健康管理之旅！*
"""

        with open(self.docs_dir / "agent-guide.md", 'w', encoding='utf-8') as f:
            f.write(content)

        logger.info("✅ 智能体使用指南生成完成")

    def generate_diagnosis_guide(self):
        """生成诊断功能指南"""
        content = """# 智能诊断功能指南

## 诊断概述

索克生活采用中医"望闻问切"四诊合参的传统诊断方法，结合现代AI技术，为您提供全面的健康评估服务。

## 🔍 望诊 - 面部与舌象分析

### 功能介绍
通过AI图像识别技术，分析面部气色和舌象特征，判断身体健康状况。

### 操作步骤
1. **环境准备**
- 选择光线充足的环境
- 避免强光直射和阴影
- 保持手机稳定

2. **面部拍摄**
- 正面面对摄像头
- 表情自然，不要化妆
- 按照框线对准面部
- 点击拍摄按钮

3. **舌象拍摄**
- 自然伸出舌头
- 舌尖向下，舌体平展
- 对准舌头中央拍摄
- 确保舌体完整清晰

### 分析内容
- **面色分析**: 红润度、光泽度、色泽变化
- **五官观察**: 眼神、唇色、鼻翼等
- **舌质分析**: 舌色、舌形、舌态
- **舌苔观察**: 苔色、苔质、分布

### 结果解读
```
示例报告：
📸 面部分析：
- 面色：微黄，光泽度一般
- 眼神：略显疲惫
- 唇色：偏淡
- 综合：提示脾胃功能偏弱

👅 舌象分析：
- 舌质：淡红，边有齿痕
- 舌苔：白腻，中厚
- 综合：脾虚湿盛证候
```

## 👂 闻诊 - 语音与呼吸检测

### 功能介绍
通过语音识别和呼吸音分析，评估呼吸系统和整体健康状态。

### 操作步骤
1. **环境准备**
- 选择安静环境
- 确保麦克风正常
- 避免外界噪音干扰

2. **语音录制**
- 按住录音按钮
- 清晰朗读指定文本
- 保持正常语速
- 录制时长30秒

3. **呼吸检测**
- 深呼吸3次
- 正常呼吸30秒
- 保持手机靠近口鼻
- 避免说话和移动

### 分析内容
- **语音特征**: 音调、音质、语速
- **呼吸模式**: 频率、深度、节律
- **异常音**: 喘息、咳嗽、杂音
- **整体评估**: 肺功能、气血状态

## 💬 问诊 - 症状智能询问

### 功能介绍
通过智能对话系统，系统性收集症状信息，进行专业的医学问诊。

### 问诊流程
1. **主诉收集**
- 描述主要不适症状
- 说明持续时间
- 评估严重程度

2. **现病史询问**
- 症状发展过程
- 诱发和缓解因素
- 伴随症状
- 治疗经历

3. **既往史了解**
- 既往疾病史
- 手术史
- 过敏史
- 用药史

4. **系统回顾**
- 各系统症状筛查
- 生活习惯了解
- 家族病史询问

### 问诊技巧
```
❌ 不好的描述：
"我不舒服"

✅ 好的描述：
"我从3天前开始头痛，主要在太阳穴部位，
疼痛程度中等，持续性钝痛，
早上起床时较重，活动后稍有缓解，
伴有轻微恶心，无发热。"
```

## ✋ 切诊 - 脉象分析指导

### 功能介绍
通过传感器技术和AI算法，指导用户进行脉象自测，分析脉象特征。

### 操作步骤
1. **准备工作**
- 保持安静状态5分钟
- 手臂自然放置
- 手心向上

2. **脉象检测**
- 将手指放在指定位置
- 轻压桡动脉
- 保持1分钟不动
- 感受脉搏跳动

3. **数据记录**
- 系统自动记录脉率
- 分析脉律规整性
- 评估脉力强弱
- 判断脉象类型

### 脉象分类
- **正常脉**: 节律规整，力度适中
- **数脉**: 脉率>90次/分，主热证
- **迟脉**: 脉率<60次/分，主寒证
- **滑脉**: 脉来流利，主痰湿
- **弦脉**: 脉体紧张，主肝郁

## 🧮 综合诊断 - AI辨证论治

### 诊断流程
1. **数据整合**
- 收集四诊信息
- 整理症状数据
- 分析检测结果

2. **模式识别**
- AI算法分析
- 证候模式匹配
- 疾病风险评估

3. **辨证论治**
- 确定证候类型
- 制定治疗原则
- 提供调理建议

### 诊断报告
```
🏥 综合诊断报告

📋 基本信息：
- 姓名：张三
- 年龄：35岁
- 性别：男
- 体质：偏虚质

🔍 四诊结果：
- 望诊：面色微黄，舌淡苔白
- 闻诊：语音低沉，呼吸平稳
- 问诊：乏力，食欲不振，大便溏
- 切诊：脉象沉细，力度偏弱

🎯 辨证结果：
- 主要证候：脾气虚证
- 次要证候：湿邪内停
- 病位：脾胃
- 病性：虚证

💊 调理建议：
- 治法：健脾益气，化湿和胃
- 方药：参苓白术散加减
- 食疗：山药薏米粥
- 运动：八段锦，太极拳
- 起居：规律作息，避免过劳
```

## 诊断准确性

### 影响因素
1. **环境条件**
- 光线充足度
- 噪音干扰
- 设备稳定性

2. **操作规范**
- 按照指导操作
- 保持状态稳定
- 信息描述准确

3. **个体差异**
- 年龄因素
- 体质特点
- 疾病状态

### 提高准确性
1. **标准化操作**
- 严格按照指导进行
- 多次测量取平均值
- 定期校准设备

2. **完整信息**
- 详细描述症状
- 提供既往病史
- 及时更新档案

3. **专业配合**
- 结合专业检查
- 定期体检对比
- 医生指导使用

## 注意事项

### ⚠️ 重要提醒
- 诊断结果仅供参考，不能替代医疗诊断
- 严重症状请立即就医
- 定期进行专业体检
- 慢性病患者需医生指导

### 🔄 持续改进
- 根据反馈优化算法
- 定期更新诊断模型
- 增加新的检测功能
- 提高诊断准确性

---

*通过科学的诊断方法，让健康管理更加精准有效！*
"""

        with open(self.docs_dir / "diagnosis-guide.md", 'w', encoding='utf-8') as f:
            f.write(content)

        logger.info("✅ 诊断功能指南生成完成")

    def generate_faq(self):
        """生成常见问题FAQ"""
        content = """# 常见问题 FAQ

## 🚀 快速入门

### Q1: 如何开始使用索克生活？
**A**: 
1. 下载并安装索克生活APP
2. 注册账户并完善个人信息
3. 完成初始健康评估
4. 开始与AI智能体互动

### Q2: 需要什么设备才能使用？
**A**: 
- **手机**: iOS 12.0+ 或 Android 8.0+
- **摄像头**: 用于望诊拍摄
- **麦克风**: 用于闻诊录音
- **网络**: 稳定的网络连接

### Q3: 是否支持离线使用？
**A**: 
- 基础功能支持离线使用
- AI诊断需要网络连接
- 数据会在联网时自动同步

## 🤖 AI智能体

### Q4: 四位智能体有什么区别？
**A**: 
- **小艾**: 健康助手，负责日常咨询和用户引导
- **小克**: 数据分析师，专注健康数据分析
- **老克**: 中医专家，提供传统医学指导
- **索儿**: 生活顾问，指导健康生活方式

### Q5: 如何选择合适的智能体咨询？
**A**: 
- 一般健康问题 → 小艾
- 数据分析需求 → 小克
- 中医调理咨询 → 老克
- 生活方式改善 → 索儿
- 复杂问题可咨询多位智能体

### Q6: AI的建议可靠吗？
**A**: 
- 基于大量医学数据训练
- 结合个人健康档案个性化
- 持续学习和优化
- 建议仅供参考，重大问题需就医

## 🔍 诊断功能

### Q7: 诊断结果准确吗？
**A**: 
- 准确率随技术不断提升
- 受环境和操作影响
- 建议多次测量对比
- 严重症状需专业诊断

### Q8: 为什么有时诊断结果不一致？
**A**: 
可能原因：
- 拍摄环境不同
- 身体状态变化
- 操作方式差异
- 建议标准化操作

### Q9: 诊断需要多长时间？
**A**: 
- 望诊：2-3分钟
- 闻诊：3-5分钟
- 问诊：5-10分钟
- 切诊：1-2分钟
- 综合分析：1-2分钟

## 📊 数据管理

### Q10: 我的健康数据安全吗？
**A**: 
- 采用银行级加密技术
- 支持本地存储
- 用户完全控制访问权限
- 严格遵循隐私保护法规

### Q11: 如何导出我的健康数据？
**A**: 
1. 进入个人中心
2. 选择"数据管理"
3. 点击"导出数据"
4. 选择导出格式和时间范围
5. 确认导出

### Q12: 可以删除我的数据吗？
**A**: 
- 支持删除个人数据
- 可选择性删除部分数据
- 删除后无法恢复
- 建议导出备份后再删除

## 💰 费用相关

### Q13: 使用索克生活需要付费吗？
**A**: 
- 基础功能免费使用
- 高级功能需要订阅
- 提供多种套餐选择
- 支持试用期体验

### Q14: 如何取消订阅？
**A**: 
1. 进入个人中心
2. 选择"订阅管理"
3. 点击"取消订阅"
4. 确认取消操作

### Q15: 退款政策是什么？
**A**: 
- 7天无理由退款
- 未使用服务可申请退款
- 特殊情况可联系客服
- 退款将原路返回

## 🔧 技术支持

### Q16: APP闪退怎么办？
**A**: 
1. 重启APP
2. 清理缓存
3. 更新到最新版本
4. 重启手机
5. 联系技术支持

### Q17: 无法拍摄照片怎么办？
**A**: 
1. 检查摄像头权限
2. 清理摄像头镜头
3. 重启APP
4. 检查存储空间
5. 更新APP版本

### Q18: 语音录制失败怎么办？
**A**: 
1. 检查麦克风权限
2. 确保环境安静
3. 重新录制
4. 检查网络连接
5. 联系技术支持

## 🏥 医疗相关

### Q19: 索克生活能替代医生吗？
**A**: 
- **不能替代专业医疗诊断**
- 仅提供健康管理建议
- 严重症状需立即就医
- 建议配合专业医疗使用

### Q20: 什么情况下需要立即就医？
**A**: 
- 胸痛、呼吸困难
- 严重头痛、意识模糊
- 高热不退
- 剧烈腹痛
- 外伤出血
- 其他紧急症状

### Q21: 如何与医生分享诊断结果？
**A**: 
1. 生成健康报告
2. 导出PDF格式
3. 打印或发送给医生
4. 在就诊时出示
5. 配合专业检查

## 🌐 其他问题

### Q22: 支持哪些语言？
**A**: 
- 中文（简体/繁体）
- 英文
- 更多语言持续添加中

### Q23: 如何联系客服？
**A**: 
- APP内智能客服
- 客服热线：400-800-8888
- 邮箱：support@suoke.life
- 微信公众号：索克生活

### Q24: 如何提供反馈建议？
**A**: 
1. APP内反馈功能
2. 应用商店评价
3. 官方邮箱
4. 用户社区
5. 客服渠道

### Q25: 有用户社区吗？
**A**: 
- 微信用户群
- 官方论坛
- 健康话题讨论
- 经验分享交流
- 专家在线答疑

## 📱 版本更新

### Q26: 如何获取最新版本？
**A**: 
- 应用商店自动更新
- 手动检查更新
- 官网下载最新版
- 关注更新通知

### Q27: 更新后数据会丢失吗？
**A**: 
- 数据会自动保留
- 建议更新前备份
- 云端同步保护
- 如有问题联系客服

---

## 📞 联系我们

如果您的问题没有在FAQ中找到答案，请通过以下方式联系我们：

- **智能客服**: APP内24小时在线
- **客服热线**: 400-800-8888 (9:00-21:00)
- **邮箱支持**: support@suoke.life
- **官方网站**: https://www.suoke.life
- **微信公众号**: 索克生活

我们致力于为您提供最好的健康管理体验！
"""

        with open(self.docs_dir / "faq.md", 'w', encoding='utf-8') as f:
            f.write(content)

        logger.info("✅ 常见问题FAQ生成完成")

def main():
    """主函数"""
    project_root = os.getcwd()

    logger.info("🚀 启动用户文档生成器")

    generator = UserDocGenerator(project_root)

    try:
        success = generator.generate_all_docs()

        if success:
            logger.info("🎉 用户文档生成完成！")
            logger.info(f"📁 文档目录: {generator.docs_dir}")
            return 0
        else:
            logger.warning("⚠️ 用户文档生成失败")
            return 1

    except Exception as e:
        logger.error(f"❌ 用户文档生成失败: {e}")
        return 1

if __name__ == "__main__":
    exit(main()) 