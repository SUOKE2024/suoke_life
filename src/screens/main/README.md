# 聊天频道主屏幕 (HomeScreen)

## 概述

HomeScreen 是索克生活APP的聊天频道主屏幕，参考微信联系人列表的设计，为用户提供与四大智能体、名医专家、健康伙伴、健康服务商和系统服务的统一聊天入口。

## 功能特性

### 🤖 四大智能体
- **小艾**: 健康管理·AI助手
- **小克**: 中医诊断·辨证论治  
- **老克**: 中医养生·经验传承
- **索儿**: 生活指导·习惯养成

### 👨‍⚕️ 名医专家
- 中医内科、针灸科、中药调理等专业医师
- VIP医生标识
- 医生认证徽章
- 在线状态显示

### 👥 健康伙伴
- 健康交流群组
- 用户间健康经验分享
- 健康打卡互动

### 🏪 健康服务
- 索克健康商城
- 中医养生馆
- 线下体验服务

### ⚙️ 系统服务
- 健康报告生成
- 预约提醒管理
- 智能通知服务

## 核心功能

### 1. 智能搜索
```typescript
// 支持按姓名和专业搜索
const searchContacts = (text: string) => {
  const filtered = allContacts.filter(contact =>
    contact.name.toLowerCase().includes(text.toLowerCase()) ||
    contact.specialty?.toLowerCase().includes(text.toLowerCase())
  );
};
```

### 2. 分组管理
- 可折叠/展开的联系人分组
- 分组联系人数量显示
- 直观的分组图标标识

### 3. 状态指示
- **在线**: 绿色圆点
- **忙碌**: 橙色圆点  
- **离开**: 灰色圆点
- **离线**: 浅灰色圆点

### 4. 消息提醒
- 未读消息数量徽章
- 最后消息内容预览
- 消息时间显示

### 5. 特殊标识
- ✓ 认证徽章（智能体、医生）
- VIP 会员标识
- 专业领域标签

## 界面设计

### 布局结构
```
┌─────────────────────────────────┐
│ 🔍 搜索联系人、专业、服务...      │
├─────────────────────────────────┤
│ 🤖 四大智能体 (4)          ▼    │
│   🤖 小艾  健康管理·AI助手  ✓    │
│   🤖 小克  中医诊断·辨证论治 ✓ ①  │
│   🤖 老克  中医养生·经验传承 ✓    │
│   🤖 索儿  生活指导·习惯养成 ✓ ②  │
├─────────────────────────────────┤
│ 👨‍⚕️ 名医专家 (3)          ▼    │
│   👨‍⚕️ 张明华 中医内科·主任医师 VIP│
│   👨‍⚕️ 李慧敏 针灸科·副主任医师   │
│   👨‍⚕️ 王德仁 中药调理·主治医师   │
└─────────────────────────────────┘
```

### 颜色规范
- **主色调**: 索克绿 (#35bb78)
- **在线状态**: 成功绿 (#34C759)
- **忙碌状态**: 警告橙 (#FF9500)
- **错误状态**: 错误红 (#FF3B30)
- **VIP标识**: 警告橙背景

## 交互行为

### 1. 搜索交互
- 实时搜索过滤
- 搜索结果高亮显示
- 清除搜索按钮
- 空搜索结果提示

### 2. 分组交互
- 点击分组标题折叠/展开
- 折叠图标旋转动画
- 分组状态持久化

### 3. 联系人交互
- 点击联系人进入聊天界面
- 长按显示更多操作（待实现）
- 滑动操作（待实现）

### 4. 下拉刷新
- 支持下拉刷新联系人列表
- 刷新动画和状态提示
- 网络错误处理

## 数据结构

### Contact 接口
```typescript
interface Contact {
  id: string;                    // 唯一标识
  name: string;                  // 联系人姓名
  avatar?: string;               // 头像URL
  type: ContactType;             // 联系人类型
  status: ContactStatus;         // 在线状态
  lastMessage?: string;          // 最后消息
  lastMessageTime?: string;      // 消息时间
  unreadCount?: number;          // 未读数量
  specialty?: string;            // 专业领域
  verified?: boolean;            // 是否认证
  vip?: boolean;                // 是否VIP
}
```

### ContactGroup 接口
```typescript
interface ContactGroup {
  id: string;                    // 分组ID
  title: string;                 // 分组标题
  icon: string;                  // 分组图标
  contacts: Contact[];           // 联系人列表
  collapsed?: boolean;           // 是否折叠
}
```

## 性能优化

### 1. 渲染优化
- 使用 `useCallback` 优化事件处理函数
- 使用 `useMemo` 缓存计算结果
- 避免不必要的重新渲染

### 2. 搜索优化
- 防抖搜索输入
- 搜索结果缓存
- 大数据集虚拟化（待实现）

### 3. 内存管理
- 及时清理事件监听器
- 图片懒加载（待实现）
- 组件卸载时清理状态

## 无障碍支持

### 1. 屏幕阅读器
- 所有交互元素都有适当的标签
- 状态变化的语音提示
- 导航结构清晰

### 2. 键盘导航
- 支持Tab键导航
- 焦点状态明显
- 快捷键支持（待实现）

### 3. 视觉辅助
- 高对比度模式支持
- 字体大小自适应
- 颜色不是唯一的信息传达方式

## 测试覆盖

### 1. 单元测试
- 组件渲染测试
- 搜索功能测试
- 分组折叠测试
- 联系人交互测试

### 2. 集成测试
- 导航集成测试
- 状态管理测试
- 网络请求测试

### 3. E2E测试
- 完整用户流程测试
- 跨平台兼容性测试
- 性能基准测试

## 未来规划

### 1. 功能增强
- [ ] 联系人分组自定义
- [ ] 消息置顶功能
- [ ] 联系人备注编辑
- [ ] 群组聊天支持

### 2. 体验优化
- [ ] 滑动操作手势
- [ ] 长按菜单选项
- [ ] 拖拽排序功能
- [ ] 主题切换支持

### 3. 智能化
- [ ] 智能联系人推荐
- [ ] 基于使用频率的排序
- [ ] 智能分组建议
- [ ] 个性化界面布局

## 技术栈

- **框架**: React Native 0.79
- **导航**: React Navigation 6
- **状态管理**: React Hooks
- **样式**: StyleSheet + 主题系统
- **测试**: Jest + React Native Testing Library
- **类型检查**: TypeScript

## 相关文件

- `src/screens/main/HomeScreen.tsx` - 主组件
- `src/screens/main/__tests__/HomeScreen.test.tsx` - 测试文件
- `src/constants/theme.ts` - 主题配置
- `src/components/ui/` - UI组件库
- `src/navigation/MainNavigator.tsx` - 导航配置

## 贡献指南

1. 遵循项目的代码规范和设计系统
2. 添加适当的测试覆盖
3. 更新相关文档
4. 考虑无障碍性和性能影响
5. 保持与索克生活品牌风格一致 