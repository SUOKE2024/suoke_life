# 索克生活 - Suoke屏幕模块

## 概述

Suoke屏幕模块是索克生活APP的核心聊天频道界面，为用户提供与四大智能体、名医专家、健康伙伴、健康服务商和系统服务的统一聊天入口。

## 功能特性

### 🤖 四大智能体
- **小艾**: 健康管理·AI助手 - 提供个性化健康数据分析和建议
- **小克**: 中医诊断·辨证论治 - 专业中医症状分析和体质辨识
- **老克**: 中医养生·经验传承 - 传统中医养生智慧和现代应用
- **索儿**: 生活指导·习惯养成 - 健康生活方式指导和习惯培养

### 👨‍⚕️ 名医专家
- **张仲景**: 中医内科·经方大师 - 经典方剂应用专家
- **华佗**: 针灸科·外科圣手 - 针灸治疗和外科手术专家
- 支持VIP医生标识和认证徽章
- 实时在线状态显示

### 👥 健康伙伴
- 健康交流群组 - 用户间健康经验分享
- 养生爱好者社区 - 养生知识交流平台
- 健康打卡互动 - 共同监督健康习惯

### 🏪 健康服务
- **索克健康商城** - 中药材和健康产品销售
- **中医养生馆** - 线下推拿按摩等体验服务
- 服务商认证和品质保证

### ⚙️ 系统服务
- **健康报告** - 智能数据分析和月度健康报告生成
- **预约提醒** - 智能预约管理和提醒服务
- 系统通知和服务状态更新

## 核心功能

### 1. 智能搜索
```typescript
// 支持按联系人姓名和专业领域搜索
const filteredContacts = useMemo(() => {
  if (!searchText.trim()) return [];
  
  const allContacts = contactGroups.flatMap(group => group.contacts);
  return allContacts.filter(contact =>
    contact.name.toLowerCase().includes(searchText.toLowerCase()) ||
    contact.specialty?.toLowerCase().includes(searchText.toLowerCase())
  );
}, [searchText, contactGroups]);
```

### 2. 分组管理
- 可折叠/展开的联系人分组
- 分组联系人数量显示
- 直观的分组图标标识
- 分组状态持久化

### 3. 状态指示系统
- **在线** (🟢): 绿色圆点 - 可立即响应
- **忙碌** (🟠): 橙色圆点 - 可能延迟响应
- **离开** (⚪): 灰色圆点 - 暂时离开
- **离线** (⚫): 浅灰色圆点 - 不在线

### 4. 消息提醒
- 未读消息数量徽章 (红色圆形标识)
- 最后消息内容预览
- 消息时间显示 (相对时间格式)

### 5. 特殊标识
- ✓ **认证徽章**: 智能体和医生的官方认证标识
- **VIP标识**: 高级医生服务标识
- **专业标签**: 显示专业领域和特长

## 界面设计

### 布局结构
```
┌─────────────────────────────────────┐
│ 🔍 搜索联系人或专业领域              │
├─────────────────────────────────────┤
│ 🤖 四大智能体 (4)              ▼   │
│   🟢 小艾  健康管理·AI助手      ✓ ② │
│   🟢 小克  中医诊断·辨证论治    ✓ ① │
│   🟠 老克  中医养生·经验传承    ✓   │
│   🟢 索儿  生活指导·习惯养成    ✓   │
├─────────────────────────────────────┤
│ 👨‍⚕️ 名医专家 (2)              ▼   │
│   🟢 张仲景 中医内科·经方大师 VIP ✓ │
│   ⚪ 华佗   针灸科·外科圣手   VIP ✓ │
├─────────────────────────────────────┤
│ 👥 健康伙伴 (2)                ▶   │
│ 🏪 健康服务 (2)                ▶   │
│ ⚙️ 系统服务 (2)                ▶   │
└─────────────────────────────────────┘
```

### 设计规范
- **主色调**: 索克绿 (#35bb78)
- **字体**: System字体，支持多种字重
- **间距**: 8px基础间距系统
- **圆角**: 8-12px圆角设计
- **阴影**: 轻微阴影增强层次感

## 交互行为

### 1. 搜索交互
- **实时搜索**: 输入即时过滤结果
- **搜索范围**: 联系人姓名 + 专业领域
- **清除功能**: 一键清除搜索内容
- **空结果提示**: 友好的无结果状态

### 2. 分组交互
- **点击折叠**: 点击分组标题切换展开/折叠
- **动画效果**: 折叠图标旋转动画
- **状态记忆**: 分组状态在会话中保持

### 3. 联系人交互
- **点击聊天**: 点击联系人进入聊天界面
- **状态显示**: 实时在线状态指示
- **信息预览**: 最后消息和时间显示

### 4. 下拉刷新
- **刷新机制**: 支持下拉刷新联系人列表
- **加载状态**: 刷新动画和状态提示
- **错误处理**: 网络错误友好提示

## 数据结构

### Contact 接口
```typescript
interface Contact {
  id: string;                    // 唯一标识符
  name: string;                  // 联系人姓名
  avatar?: string;               // 头像URL (可选)
  type: ContactType;             // 联系人类型
  status: ContactStatus;         // 在线状态
  lastMessage?: string;          // 最后消息内容
  lastMessageTime?: string;      // 消息时间
  unreadCount?: number;          // 未读消息数量
  isVip?: boolean;              // VIP标识
  isVerified?: boolean;         // 认证标识
  specialty?: string;           // 专业领域
}
```

### ContactGroup 接口
```typescript
interface ContactGroup {
  id: string;                    // 分组唯一标识
  title: string;                 // 分组显示标题
  icon: string;                  // 分组图标 (emoji)
  contacts: Contact[];           // 联系人列表
  collapsed: boolean;            // 折叠状态
}
```

### 联系人类型
```typescript
type ContactType = 'agent' | 'doctor' | 'user' | 'supplier' | 'service';
type ContactStatus = 'online' | 'offline' | 'busy' | 'away';
```

## 性能优化

### 1. 渲染优化
- **useCallback**: 优化事件处理函数，避免不必要的重新渲染
- **useMemo**: 缓存搜索结果和计算值
- **React.memo**: 组件级别的渲染优化

### 2. 搜索优化
- **实时过滤**: 基于内存的快速搜索
- **搜索缓存**: 搜索结果缓存机制
- **防抖处理**: 避免频繁搜索请求

### 3. 状态管理
- **本地状态**: 使用useState管理组件状态
- **状态持久化**: 分组折叠状态保持
- **内存管理**: 及时清理不必要的状态

## 技术实现

### 1. 组件架构
```typescript
HomeScreen
├── SearchBar (搜索栏)
├── ContactGroups (分组列表)
│   ├── GroupHeader (分组标题)
│   └── ContactList (联系人列表)
│       └── ContactItem (联系人项)
│           ├── Avatar (头像)
│           ├── ContactInfo (信息)
│           └── StatusIndicator (状态)
└── EmptyState (空状态)
```

### 2. 样式系统
- **StyleSheet**: React Native原生样式系统
- **主题集成**: 使用统一的设计token
- **响应式设计**: 适配不同屏幕尺寸

### 3. 状态管理
- **React Hooks**: useState, useEffect, useCallback, useMemo
- **本地状态**: 组件内部状态管理
- **数据流**: 单向数据流设计

## 测试策略

### 1. 单元测试
- 组件渲染测试
- 搜索功能测试
- 分组折叠测试
- 联系人交互测试

### 2. 集成测试
- 导航集成测试
- 状态管理测试
- 用户交互流程测试

### 3. 性能测试
- 渲染性能测试
- 内存使用监控
- 交互响应时间测试

## 无障碍支持

### 1. 屏幕阅读器
- 所有交互元素都有适当的accessibility标签
- 状态变化的语音提示
- 清晰的导航结构

### 2. 视觉辅助
- 高对比度模式支持
- 字体大小自适应
- 颜色不是唯一的信息传达方式

## 未来规划

### 1. 功能增强
- [ ] 联系人分组自定义
- [ ] 消息置顶功能
- [ ] 联系人备注编辑
- [ ] 群组聊天支持
- [ ] 语音消息预览

### 2. 体验优化
- [ ] 滑动操作手势
- [ ] 长按菜单选项
- [ ] 拖拽排序功能
- [ ] 主题切换支持
- [ ] 动画效果增强

### 3. 智能化
- [ ] 智能联系人推荐
- [ ] 基于使用频率的排序
- [ ] 智能分组建议
- [ ] 个性化界面布局
- [ ] AI驱动的搜索优化

## 相关文件

- `src/screens/suoke/HomeScreen.tsx` - 主组件实现
- `src/screens/suoke/__tests__/HomeScreen.test.tsx` - 测试文件
- `src/screens/suoke/index.ts` - 模块导出
- `src/constants/theme.ts` - 主题配置
- `src/navigation/MainNavigator.tsx` - 导航配置

## 开发指南

### 1. 本地开发
```bash
# 启动开发服务器
npx react-native start

# 运行iOS模拟器
npx react-native run-ios

# 运行Android模拟器
npx react-native run-android
```

### 2. 测试运行
```bash
# 运行单元测试
npm test src/screens/suoke/__tests__/HomeScreen.test.tsx

# 运行所有测试
npm test

# 测试覆盖率
npm run test:coverage
```

### 3. 代码规范
- 遵循项目的ESLint和Prettier配置
- 使用TypeScript进行类型检查
- 添加适当的注释和文档
- 保持组件的单一职责原则

## 贡献指南

1. **代码规范**: 遵循项目的代码规范和设计系统
2. **测试覆盖**: 为新功能添加适当的测试
3. **文档更新**: 更新相关文档和注释
4. **性能考虑**: 考虑性能影响和优化机会
5. **无障碍性**: 确保新功能支持无障碍访问
6. **品牌一致**: 保持与索克生活品牌风格一致

---

**索克生活** - 将中医智慧数字化，融入现代生活场景 🌿 