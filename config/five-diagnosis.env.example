# 索克生活 - 五诊服务环境变量配置
# 复制此文件为 .env 并填入实际值

# 基础配置
NODE_ENV=development
SERVICE_NAME=suoke-five-diagnosis
SERVICE_VERSION=1.0.0

# 网关配置
GATEWAY_HOST=localhost
GATEWAY_PORT=8000
GATEWAY_TIMEOUT=30

# 数据库配置
# PostgreSQL 主数据库
DB_HOST=localhost
DB_PORT=5432
DB_NAME=suoke_five_diagnosis
DB_USER=suoke_user
DB_PASSWORD=your_db_password_here
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30

# Redis 缓存数据库
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=your_redis_password_here
REDIS_TTL=3600

# InfluxDB 时序数据库
INFLUX_HOST=localhost
INFLUX_PORT=8086
INFLUX_DB=suoke_metrics
INFLUX_USER=suoke_metrics
INFLUX_PASSWORD=your_influx_password_here

# 安全配置
# JWT密钥 (请使用强密码)
JWT_SECRET_KEY=your_jwt_secret_key_here_please_use_strong_password
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# API密钥
API_KEY_HEADER=X-API-Key
API_RATE_LIMIT=1000

# 传统四诊服务端口
LOOKING_SERVICE_PORT=8004
LISTENING_SERVICE_PORT=8005
INQUIRY_SERVICE_PORT=8006
PALPATION_SERVICE_PORT=8007

# 新增算诊服务端口
CALCULATION_SERVICE_PORT=8008

# AI模型配置
MODEL_PATH=./models
ONNX_PROVIDERS=CPUExecutionProvider
FACE_MODEL_PATH=face_analysis_v2.onnx
TONGUE_MODEL_PATH=tongue_analysis_v2.onnx
VOICE_MODEL_PATH=voice_analysis_v2.onnx
PULSE_MODEL_PATH=pulse_analysis_v1.onnx

# 文件存储配置
STORAGE_PROVIDER=local
STORAGE_LOCAL_PATH=./storage
MAX_FILE_SIZE=50MB
MAX_IMAGE_SIZE=10MB
MAX_AUDIO_DURATION=300

# 第三方服务API密钥
# 天气服务 (OpenWeatherMap)
WEATHER_API_KEY=your_weather_api_key_here
WEATHER_API_PROVIDER=openweathermap

# 地图服务 (高德地图)
AMAP_API_KEY=your_amap_api_key_here

# 消息队列配置
MQ_PROVIDER=rabbitmq
MQ_HOST=localhost
MQ_PORT=5672
MQ_USER=suoke_mq
MQ_PASSWORD=your_mq_password_here

# 监控配置
# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
PROMETHEUS_METRICS_PATH=/metrics

# 日志配置
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=./logs/five-diagnosis.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=5

# 健康检查配置
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# 性能监控配置
PERFORMANCE_MONITORING_ENABLED=true
RESPONSE_TIME_THRESHOLD=5000
MEMORY_THRESHOLD=1GB
CPU_THRESHOLD=80

# 业务规则配置
# 诊断流程
DIAGNOSIS_MAX_DURATION=3600
DIAGNOSIS_AUTO_SAVE_INTERVAL=300

# 数据质量阈值
MIN_IMAGE_QUALITY=0.8
MIN_AUDIO_QUALITY=0.7
REQUIRED_FIELDS_COMPLETION=0.9

# 分析规则
CONFIDENCE_THRESHOLD=0.75
CONSENSUS_REQUIREMENT=0.8
EXPERT_REVIEW_THRESHOLD=0.6

# 算诊特定配置
# 子午流注分析
ZIWU_LIUZHU_ENABLED=true
ZIWU_MERIDIAN_COUNT=12
ZIWU_TIME_PERIODS=24
ZIWU_ANALYSIS_DEPTH=detailed

# 八字体质分析
CONSTITUTION_ENABLED=true
CONSTITUTION_TYPES=9
CONSTITUTION_GENETIC_FACTORS=true
CONSTITUTION_ENVIRONMENTAL_FACTORS=true

# 八卦配属分析
BAGUA_ENABLED=true
BAGUA_TRIGRAMS=8
BAGUA_HEALTH_MAPPING=true
BAGUA_ORGAN_CORRESPONDENCE=true
BAGUA_SEASONAL_ANALYSIS=true

# 五运六气分析
WUYUN_LIUQI_ENABLED=true
WUYUN_YEARLY_ANALYSIS=true
WUYUN_SEASONAL_ANALYSIS=true
WUYUN_CLIMATE_FACTORS=true

# CORS配置
CORS_ALLOW_ORIGINS=http://localhost:3000,http://localhost:8081
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE
CORS_ALLOW_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# 开发环境特定配置
DEBUG=true
HOT_RELOAD=true
MOCK_SERVICES=false
TEST_DATA=true

# 生产环境特定配置 (当 NODE_ENV=production 时使用)
# DEBUG=false
# HOT_RELOAD=false
# MOCK_SERVICES=false
# TEST_DATA=false
# SSL_ENABLED=true

# 测试环境特定配置 (当 NODE_ENV=test 时使用)
# TEST_DATABASE=suoke_five_diagnosis_test
# MOCK_AI_MODELS=true
# TEST_TIMEOUT=30
# COVERAGE_THRESHOLD=80

# 备份和恢复配置
BACKUP_ENABLED=true
BACKUP_INTERVAL=daily
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_PATH=./backups

# 缓存配置
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=3600
CACHE_MAX_MEMORY=512MB

# 限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST_SIZE=20

# 算诊算法配置
# 时间计算精度
TIME_CALCULATION_PRECISION=minute
TIMEZONE_SUPPORT=true
LUNAR_CALENDAR_SUPPORT=true

# 地理位置配置
LOCATION_PRECISION=city
COORDINATE_SYSTEM=WGS84
TIMEZONE_AUTO_DETECTION=true

# 推荐系统配置
RECOMMENDATION_ENABLED=true
RECOMMENDATION_ALGORITHM=collaborative_filtering
RECOMMENDATION_MAX_ITEMS=10

# 通知配置
NOTIFICATION_ENABLED=true
EMAIL_NOTIFICATION=true
SMS_NOTIFICATION=false
PUSH_NOTIFICATION=true

# 邮件服务配置 (如果启用邮件通知)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your_email@example.com
SMTP_PASSWORD=your_email_password
SMTP_TLS=true

# 短信服务配置 (如果启用短信通知)
SMS_PROVIDER=aliyun
SMS_ACCESS_KEY=your_sms_access_key
SMS_SECRET_KEY=your_sms_secret_key

# 推送服务配置 (如果启用推送通知)
PUSH_PROVIDER=firebase
PUSH_SERVER_KEY=your_push_server_key

# 数据同步配置
DATA_SYNC_ENABLED=true
DATA_SYNC_INTERVAL=300
DATA_SYNC_BATCH_SIZE=100

# 审计日志配置
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_RETENTION_DAYS=90

# 性能优化配置
ENABLE_GZIP=true
ENABLE_CACHING=true
ENABLE_CDN=false
CDN_URL=https://cdn.example.com

# 多语言支持配置
I18N_ENABLED=true
DEFAULT_LANGUAGE=zh-CN
SUPPORTED_LANGUAGES=zh-CN,en-US,zh-TW

# 实验性功能配置
EXPERIMENTAL_FEATURES_ENABLED=false
BETA_FEATURES_ENABLED=false

# 调试和开发工具配置
ENABLE_SWAGGER=true
ENABLE_GRAPHQL_PLAYGROUND=true
ENABLE_PROFILER=false
ENABLE_DEBUGGER=false 